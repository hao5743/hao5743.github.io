<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Make more time">
<meta property="og:type" content="website">
<meta property="og:title" content="易天行">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="易天行">
<meta property="og:description" content="Make more time">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="易天行">
<meta name="twitter:description" content="Make more time">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>易天行</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">易天行</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">积累点滴，汇聚江河</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/30/2018-08-30/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/30/2018-08-30/" itemprop="url">ps -ef 和 ps aux</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-30T00:00:00+08:00">
                2018-08-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>linux中<code>ps -ef</code> 和 <code>ps aux</code>都支持用来查看进程快照，下面总结了他们的显示格式区别和各列的含义。(<code>ps -aux</code>已废弃，不要再用了)<br>推荐使用<code>ps -ef</code></p>
</blockquote>
<h3 id="ps-ef-标准的格式显示进程（System-V风格）"><a href="#ps-ef-标准的格式显示进程（System-V风格）" class="headerlink" title="ps -ef 标准的格式显示进程（System Ｖ风格）"></a>ps -ef 标准的格式显示进程（System Ｖ风格）</h3><table>
<thead>
<tr>
<th>UID</th>
<th>PID</th>
<th>PPID</th>
<th>C</th>
<th>STIME</th>
<th>TTY</th>
<th>TIME</th>
<th>CMD</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户</td>
<td>进程id</td>
<td>父进程id</td>
<td>cpu百分比</td>
<td>启动时间</td>
<td>所在终端</td>
<td>占用cpu时间</td>
<td>命令参数</td>
</tr>
<tr>
<td>root</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>06:50</td>
<td>?</td>
<td>00:00:10</td>
<td>/sbin/init</td>
</tr>
<tr>
<td>root</td>
<td>40</td>
<td>1</td>
<td>0</td>
<td>12:33</td>
<td>pts/0</td>
<td>00:00:03</td>
<td>/java/</td>
</tr>
</tbody>
</table>
<p>其中各列的内容意思如下</p>
<ul>
<li>UID    //用户ID、但输出的是用户名 </li>
<li>PID    //进程的ID </li>
<li>PPID    //父进程ID </li>
<li>C      //进程占用CPU的百分比 </li>
<li>STIME  //进程启动时间</li>
<li>TTY    //该进程在那个终端上运行，若与终端无关，则显示? 若为pts/0等，则表示由网络连接主机进程。 </li>
<li>TIME  //进程使用cpu的时间</li>
<li>CMD    //命令的名称和参数</li>
</ul>
<h3 id="ps-aux-BSD的格式来显示"><a href="#ps-aux-BSD的格式来显示" class="headerlink" title="ps aux BSD的格式来显示"></a>ps aux BSD的格式来显示</h3><table>
<thead>
<tr>
<th>USER</th>
<th>PID</th>
<th>%CPU</th>
<th>%MEM</th>
<th>VSZ</th>
<th>RSS</th>
<th>TTY</th>
<th>STAT</th>
<th>START</th>
<th>TIME</th>
<th>COMMAND</th>
</tr>
</thead>
<tbody>
<tr>
<td>root</td>
<td>1</td>
<td>0.0</td>
<td>1.2</td>
<td>19221</td>
<td>2989</td>
<td>?</td>
<td>S</td>
<td>12:20</td>
<td>00:09</td>
<td>/sbin/init</td>
</tr>
</tbody>
</table>
<p>同ps -ef 不同的有列有</p>
<ul>
<li>USER      //用户名 </li>
<li>%CPU      //进程占用的CPU百分比 </li>
<li>%MEM      //占用内存的百分比 </li>
<li>VSZ      //该进程使用的虚拟內存量（KB） </li>
<li>RSS      //该进程占用的固定內存量（KB）（驻留中页的数量） </li>
<li>STAT      //进程的状态 </li>
<li>START    //该进程被触发启动时间 </li>
<li>TIME      //该进程实际使用CPU运行的时间</li>
</ul>
<p>其中STAT状态位常见的状态字符有</p>
<ul>
<li>D      //无法中断的休眠状态（通常 IO 的进程）； </li>
<li>R      //正在运行可中在队列中可过行的； </li>
<li>S      //处于休眠状态； </li>
<li>T      //停止或被追踪； </li>
<li>W      //进入内存交换 （从内核2.6开始无效）； </li>
<li>X      //死掉的进程 （基本很少见）； </li>
<li>Z      //僵尸进程； </li>
<li>&lt;      //优先级高的进程 </li>
<li>N      //优先级较低的进程 </li>
<li>L      //有些页被锁进内存； </li>
<li>s      //进程的领导者（在它之下有子进程）； </li>
<li>l      //多线程，克隆线程（使用 CLONE_THREAD, 类似 NPTL pthreads）； </li>
<li><ul>
<li>//位于后台的进程组；</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/23/2018-08-23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/23/2018-08-23/" itemprop="url">linux查看内存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-23T00:00:00+08:00">
                2018-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="linux查看内存"><a href="#linux查看内存" class="headerlink" title="linux查看内存"></a>linux查看内存</h1><h2 id="1-top"><a href="#1-top" class="headerlink" title="1.top"></a>1.top</h2><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><ul>
<li>进程的CPU使用率排序：运行top命令后，键入大写P</li>
<li>内存使用率排序：运行top命令后，键入大写M</li>
</ul>
<p>各列的说明</p>
<ul>
<li>PID：进程的ID</li>
<li>USER：进程所有者</li>
<li>PR：进程的优先级别，越小越优先被执行</li>
<li>NInice：值</li>
<li>VIRT：进程占用的虚拟内存</li>
<li>RES：进程占用的物理内存</li>
<li>SHR：进程使用的共享内存</li>
<li>S：进程的状态。S表示休眠，R表示正在运行，Z表示僵死状态，N表示该进程优先值为负数</li>
<li>%CPU：进程占用CPU的使用率</li>
<li>%MEM：进程使用的物理内存和总内存的百分比</li>
<li>TIME+：该进程启动后占用的总的CPU时间，即占用CPU使用时间的累加值。</li>
<li>COMMAND：进程启动命令名称</li>
</ul>
<h2 id="2-free"><a href="#2-free" class="headerlink" title="2.free"></a>2.free</h2><ul>
<li>total:总计物理内存的大小。</li>
<li>used:已使用多大。</li>
<li>free:可用有多少。</li>
<li>Shared:多个进程共享的内存总额。</li>
<li><p>Buffers/cached:磁盘缓存的大小。</p>
</li>
<li><p>区别：第二行(mem)的used/free与第三行(-/+ buffers/cache) used/free的区别。 这两个的区别在于使用的角度来看，第一行是从OS的角度来看，因为对于OS，buffers/cached 都是属于被使用，所以他的可用内存是434884KB,已用内存是3489800KB,</p>
</li>
<li>第三行所指的是从应用程序角度来看，对于应用程序来说，buffers/cached 是等于可用的，因为buffer/cached是为了提高文件读取的性能，当应用程序需在用到内存的时候，buffer/cached会很快地被回收。</li>
<li><strong>所以从应用程序的角度来说，可用内存 = 系统Free Memory + buffers + cached</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">usage: free [-b|-k|-m|-g] [-l] [-o] [-t] [-s delay] [-c count] [-V]</span><br><span class="line">  -b,-k,-m,-g show output <span class="keyword">in</span> bytes, KB, MB, or GB</span><br><span class="line">  -l show detailed low and high memory statistics</span><br><span class="line">  -o use old format (no -/+buffers/cache line)</span><br><span class="line">  -t display total <span class="keyword">for</span> RAM + swap</span><br><span class="line">  -s update every [delay] seconds</span><br><span class="line">  -c update [count] <span class="built_in">times</span></span><br><span class="line">  -V display version information and <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/22/2018-08-17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/22/2018-08-17/" itemprop="url">Hello</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-22T00:00:00+08:00">
                2018-08-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Hello"><a href="#Hello" class="headerlink" title="Hello"></a>Hello</h1><h2 id="ConcurrentLinkedDeque"><a href="#ConcurrentLinkedDeque" class="headerlink" title="ConcurrentLinkedDeque"></a>ConcurrentLinkedDeque</h2><p>Java7中引入的非阻塞并发列表</p>
<h2 id="AtomicInteger"><a href="#AtomicInteger" class="headerlink" title="AtomicInteger"></a>AtomicInteger</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">//正常</span><br><span class="line">public class Sample1 &#123;</span><br><span class="line">    private static Integer count = 0;</span><br><span class="line">    synchronized public static void increment() &#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//AtomicInteger</span><br><span class="line">public class Sample2 &#123;</span><br><span class="line">    private static AtomicInteger count = new AtomicInteger(0);</span><br><span class="line">    public static void increment() &#123;</span><br><span class="line">        count.getAndIncrement();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">以上两段代码，在使用Integer的时候，必须加上synchronized保证不会出现并发线程同时访问的情况，而在AtomicInteger中却不用加上synchronized，在这里AtomicInteger是提供原子操作的，下面就对这进行相应的介绍。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/22/2018-08-12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/22/2018-08-12/" itemprop="url">Node.js Event Loop，Timers定时器和process.nextTick()</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-22T00:00:00+08:00">
                2018-08-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是事件循环？"><a href="#什么是事件循环？" class="headerlink" title="什么是事件循环？"></a>什么是事件循环？</h2><p>事件循环是Node.js中实现非阻塞IO的机制，它通过及时的转发操作请求给系统内核来实现，尽管JavaScript是单线程的。<br>目前大部分的系统内核都是多线程的，可以后台同时处理多个操作请求。当某个请求处理完毕后，内核会通知node把对应的回调函数加入poll事件队列等待执行。我们稍后具体阐述这个流程。</p>
<h2 id="事件循环解释"><a href="#事件循环解释" class="headerlink" title="事件循环解释"></a>事件循环解释</h2><p>Node.js启动时会</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/22/2018-08-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/22/2018-08-22/" itemprop="url">线程安全容器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-22T00:00:00+08:00">
                2018-08-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="HashMap线程安全"><a href="#HashMap线程安全" class="headerlink" title="HashMap线程安全"></a>HashMap线程安全</h3><h4 id="ConcurrentHashMap"><a href="#ConcurrentHashMap" class="headerlink" title="ConcurrentHashMap"></a>ConcurrentHashMap</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//使用ConcurrentHashMap</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, LinkedHashSet&lt;String&gt;&gt; peerAssignHistoryMap = <span class="keyword">new</span> ConcurrentHashMap&lt;String, LinkedHashSet&lt;String&gt;&gt;();</span><br></pre></td></tr></table></figure>
<p>支持获取的完全并发和更新的所期望可调整并发的哈希表。此类遵守与 Hashtable 相同的功能规范，并且包括对应于 Hashtable 的每个方法的方法版本。不过，尽管所有操作都是线程安全的，但获取操作不 必锁定，并且不 支持以某种防止所有访问的方式锁定整个表。此类可以通过程序完全与 Hashtable 进行互操作，这取决于其线程安全，而与其同步细节无关。</p>
<p>获取操作（包括 get）通常不会受阻塞，因此，可能与更新操作交迭（包括 put 和 remove）。获取会影响最近完成的 更新操作的结果。对于一些聚合操作，比如 putAll 和 clear，并发获取可能只影响某些条目的插入和移除。类似地，在创建迭代器/枚举时或自此之后，Iterators 和 Enumerations 返回在某一时间点上影响哈希表状态的元素。它们不会 抛出 ConcurrentModificationException。不过，迭代器被设计成每次仅由一个线程使用。</p>
<p>这允许通过可选的 concurrencyLevel 构造方法参数（默认值为 16）来引导更新操作之间的并发，该参数用作内部调整大小的一个提示。表是在内部进行分区的，试图允许指示无争用并发更新的数量。因为哈希表中的位置基本上是随意的，所以实际的并发将各不相同。理想情况下，应该选择一个尽可能多地容纳并发修改该表的线程的值。使用一个比所需要的值高很多的值可能会浪费空间和时间，而使用一个显然低很多的值可能导致线程争用。对数量级估计过高或估计过低通常都会带来非常显著的影响。当仅有一个线程将执行修改操作，而其他所有线程都只是执行读取操作时，才认为某个值是合适的。此外，重新调整此类或其他任何种类哈希表的大小都是一个相对较慢的操作，因此，在可能的时候，提供构造方法中期望表大小的估计值是一个好主意。</p>
<p>此类及其视图和迭代器实现了 Map 和 Iterator 接口的所有可选 方法。</p>
<p>此类与 Hashtable 相似，但与 HashMap 不同，它不 允许将 null 用作键或值。</p>
<p>get与containsKey两个方法几乎完全一致：他们都没有使用锁，而是通过Unsafe对象的getObjectVolatile()方法提供的原子读语义，来获得Segment以及对应的链表，然后对链表遍历判断是否存在key相同的节点以及获得该节点的value。但由于遍历过程中其他线程可能对链表结构做了调整，因此get和containsKey返回的可能是过时的数据，这一点是ConcurrentHashMap在弱一致性上的体现。如果要求强一致性，那么必须使用Collections.synchronizedMap()方法。</p>
<h5 id="putIfAbsent"><a href="#putIfAbsent" class="headerlink" title="putIfAbsent"></a>putIfAbsent</h5><p>public V putIfAbsent(K key,<br>                     V value)<br>如果指定键已经不再与某个值相关联，则将它与给定值关联。这等价于：<br>   if (!map.containsKey(key))<br>      return map.put(key, value);<br>  else<br>       return map.get(key);<br>除了原子地执行此操作之外。<br>指定者：<br>接口 ConcurrentMap<k,v> 中的 putIfAbsent<br>参数：<br>key - 与指定值相关联的键<br>value - 与指定键相关联的值<br>返回：<br>以前与指定键相关联的值，如果该键没有映射关系，则返回 null<br>抛出：<br>NullPointerException - 如果指定键或值为 null</k,v></p>
<h4 id="Collections-synchronizedMap"><a href="#Collections-synchronizedMap" class="headerlink" title="Collections.synchronizedMap"></a>Collections.synchronizedMap</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//使用Collections.synchronizedMap</span></span><br><span class="line"> Map m = Collections.synchronizedMap(<span class="keyword">new</span> HashMap());</span><br></pre></td></tr></table></figure>
<p>返回由指定映射支持的同步（线程安全的）映射。为了保证按顺序访问，必须通过返回的映射完成 所有对底层实现映射的访问。<br>在返回映射的任意 collection 视图上进行迭代时，用户必须手工在返回的映射上进行同步：</p>
<p>  Map m = Collections.synchronizedMap(new HashMap());<br>      …<br>  Set s = m.keySet();  // Needn’t be in synchronized block<br>      …<br>  synchronized(m) {  // Synchronizing on m, not s!<br>      Iterator i = s.iterator(); // Must be in synchronized block<br>      while (i.hasNext())<br>          foo(i.next());<br>  }</p>
<p>不遵从此建议将导致无法确定的行为。</p>
<h4 id="HashTable"><a href="#HashTable" class="headerlink" title="HashTable"></a>HashTable</h4><h3 id="Set线程安全"><a href="#Set线程安全" class="headerlink" title="Set线程安全"></a>Set线程安全</h3><h4 id="Collections-synchronizedSet"><a href="#Collections-synchronizedSet" class="headerlink" title="Collections.synchronizedSet"></a>Collections.synchronizedSet</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">返回指定 set 支持的同步（线程安全的）set。为了保证按顺序访问，必须通过返回的 set 完成对 所有底层实现 set 的访问。</span><br><span class="line">在返回的 set 上进行迭代时，用户必须手工在返回的 set 上进行同步：</span><br><span class="line"></span><br><span class="line">  Set s = Collections.synchronizedSet(<span class="keyword">new</span> HashSet());</span><br><span class="line">      ...</span><br><span class="line">  <span class="keyword">synchronized</span>(s) &#123;</span><br><span class="line">      Iterator i = s.iterator(); <span class="comment">// Must be in the synchronized block</span></span><br><span class="line">      <span class="keyword">while</span> (i.hasNext())</span><br><span class="line">          foo(i.next());</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">不遵从此建议将导致无法确定的行为。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/26/2018-07-26/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/26/2018-07-26/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-26T00:55:12+08:00">
                2018-07-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="node退出进程时关闭mongo连接"><a href="#node退出进程时关闭mongo连接" class="headerlink" title="node退出进程时关闭mongo连接"></a>node退出进程时关闭mongo连接</h1><p>Shouldn’t we be closing the mongo connection somehow? It seems to be increasing with use in the mongod window</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">var</span> gracefulShutdown;</span><br><span class="line"><span class="keyword">var</span> dbURI = <span class="string">'mongodb://localhost/mean-todo'</span>;</span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span>) &#123;</span><br><span class="line">    dbURI = process.env.MONGOLAB_URI;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mongoose.connect(dbURI);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CONNECTION EVENTS</span></span><br><span class="line">mongoose.connection.on(<span class="string">'connected'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Mongoose connected to '</span> + dbURI);</span><br><span class="line">&#125;);</span><br><span class="line">mongoose.connection.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Mongoose connection error: '</span> + err);</span><br><span class="line">&#125;);</span><br><span class="line">mongoose.connection.on(<span class="string">'disconnected'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Mongoose disconnected'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CAPTURE APP TERMINATION / RESTART EVENTS</span></span><br><span class="line"><span class="comment">// To be called when process is restarted or terminated</span></span><br><span class="line">gracefulShutdown = <span class="function"><span class="keyword">function</span>(<span class="params">msg, callback</span>) </span>&#123;</span><br><span class="line">    mongoose.connection.close(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Mongoose disconnected through '</span> + msg);</span><br><span class="line">        callback();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// For nodemon restarts</span></span><br><span class="line">process.once(<span class="string">'SIGUSR2'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gracefulShutdown(<span class="string">'nodemon restart'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        process.kill(process.pid, <span class="string">'SIGUSR2'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// For app termination</span></span><br><span class="line">process.on(<span class="string">'SIGINT'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gracefulShutdown(<span class="string">'app termination'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        process.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// For Heroku app termination</span></span><br><span class="line">process.on(<span class="string">'SIGTERM'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gracefulShutdown(<span class="string">'Heroku app termination'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        process.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/13/2018-07-11-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/13/2018-07-11-3/" itemprop="url">SVN简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-13T00:00:00+08:00">
                2018-07-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SVN简介"><a href="#SVN简介" class="headerlink" title="SVN简介"></a>SVN简介</h1><h3 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h3><p>SVN是Subversion的简称，是一个开放源代码的版本控制系统，和git（分布式版本控制）比它采用了<strong>集中式版本控制</strong>，相较于RCS、CVS，它采用了分支管理系统，它的设计目标就是取代CVS。它管理者很多数据，这些数据放置在一个中央资料档案库(repository) 中。 这个档案库很像一个普通的文件服务器, 不过它会记住每一次文件的变动。 这样你就可以把档案恢复到旧的版本, 或是浏览文件的变动历史。</p>
<h3 id="几个概念"><a href="#几个概念" class="headerlink" title="几个概念"></a>几个概念</h3><ul>
<li><strong>repository</strong>（源代码库）:源代码统一存放的地方</li>
<li><strong>Checkout</strong>（提取）:当你手上没有源代码的时候，你需要从repository checkout一份</li>
<li><strong>Commit</strong>（提交）:当你已经修改了代码，你就需要Commit到repository</li>
<li><strong>Update</strong> (更新):当你已经Checkout了一份源代码， Update一下你就可以和Repository上的源代码同步，你手上的代码就会有最新的变更</li>
<li><strong>Merge</strong> (合并): 当你有多个分支时，一般需要从trunk合并到分支，或分支合并到主干</li>
<li><strong>Trunk</strong> （主分支）: 主分支</li>
<li><strong>Branches</strong> (分支): 分支，开发一般需要新建一个branch，最后将代码合并到Trunk</li>
</ul>
<h3 id="与git比较"><a href="#与git比较" class="headerlink" title="与git比较"></a>与git比较</h3><p>git也是一个开源的分布式版本控制系统，是目前世界上最先进的分布式版本控制系统。相比较git有以下优势：</p>
<ul>
<li>git是分布式的,svn是集中式的。(最核心)</li>
<li>git是每个历史版本都存储完整的文件,便于恢复,svn是存储差异文件,历史版本不可恢复。(核心)</li>
<li>git可离线完成大部分操作,svn则不能</li>
<li>git分支和合并更强大</li>
<li>git有着更强的撤销修改和修改历史版本的能力</li>
<li>git速度更快,效率更高。</li>
</ul>
<p><strong>唯一弱点</strong>，Git 没有严格的权限管理控制，一般通过系统设置文件读写权限的方式来做权限控制。不过git的发展伴随着开源的发展，与github是亲兄弟。</p>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p>创建分支</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">svn cp -m <span class="string">"my new branch"</span> http://svn_server/xxx_repository/trunk http://svn_server/xxx_repository/branches/br_feature001</span><br></pre></td></tr></table></figure>
<p>删除分支或tags</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">svn rm http://svn_server/xxx_repository/branches/br_feature001</span><br><span class="line"></span><br><span class="line">svn rm http://svn_server/xxx_repository/tags/release-1.0</span><br></pre></td></tr></table></figure>
<p>checkout 到工作目录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">svn co http://svn_server/xxx_repository/branches/br_feature001</span><br></pre></td></tr></table></figure>
<p>从主干合并到分支（主干更新后，想要拉取到我的分支）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">cd</span> br_feature001</span><br><span class="line"></span><br><span class="line">svn merge http://svn_server/xxx_repository/trunk</span><br></pre></td></tr></table></figure>
<p>合并分支到主干（分支开发完毕后，需要合并到分支）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">cd</span> trunk</span><br><span class="line"></span><br><span class="line">svn merge --reintegrate http://svn_server/xxx_repository/branches/br_feature001</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/12/2018-07-11-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/12/2018-07-11-2/" itemprop="url">mongo原子性和事务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T00:00:00+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>关于mongodb原子性和事务的说明，大部分翻译自官方文档<code>(https://docs.mongodb.com/manual/tutorial)</code></p>
</blockquote>
<h1 id="原子性和事务"><a href="#原子性和事务" class="headerlink" title="原子性和事务"></a>原子性和事务</h1><p>在MongoDb中，写操作在<code>文档级别</code>是原子性的，即使该文档包含多个嵌入的子文档。</p>
<p>当一次写操作修改多个文档时，对每个文档的更新时原子性的，但整个写入操作不是原子性的，而且中间可能会插入多个其他操作。</p>
<h2 id="模拟事务"><a href="#模拟事务" class="headerlink" title="模拟事务"></a>模拟事务</h2><p>因为一个文档可以包含多个子文档，所以文档级别的原子性可以满足大部分的应用场景。如果你想把多个操作作为一个事务来处理，你可以实现一个<code>two-phase commit</code>。</p>
<p>然而，<code>two-phase commit</code>仅仅可以提供类事务语义。使用它可以保证数据的一致性，但是在<code>two-phase commit</code>或回滚进行时可能会返回中间数据。关于two-phase commit的更多信息，请看这里<a href="https://docs.mongodb.com/manual/tutorial/perform-two-phase-commits/" target="_blank" rel="noopener"> Perform Two Phase Commits</a></p>
<h2 id="并发控制-Concurrency-Control"><a href="#并发控制-Concurrency-Control" class="headerlink" title="并发控制  Concurrency Control"></a>并发控制  Concurrency Control</h2><p>并发控制可以保证多个应用运行时的一致性，避免导致数据不一致或数据冲突问题。</p>
<p>方法一是在一个有唯一数据值的字段上创建一个唯一索引<a href="https://docs.mongodb.com/manual/core/index-unique/#index-type-unique" target="_blank" rel="noopener">unique index</a>。这样可以防止插入或更新产生重复数据。在多个字段上创建唯一索引，来保证这多个字段组合值的唯一性。示例操作请看，<a href="https://docs.mongodb.com/manual/reference/method/db.collection.update/#update-with-unique-indexes" target="_blank" rel="noopener">update() and Unique Index</a>, <a href="https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/#upsert-and-unique-index" target="_blank" rel="noopener">findAndModify() and Unique Index</a>。</p>
<p>方法二是，在查询条件上对指定字段的当前值进行判断。在写操作中，<code>two-phase commit</code>模式提供了一个变量，其中的查询条件包含了应用标识<a href="https://docs.mongodb.com/manual/tutorial/perform-two-phase-commits/#phase-commits-concurrency" target="_blank" rel="noopener">application identifier</a>和写操作中数据的预期状态。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/12/2018-07-11-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/12/2018-07-11-1/" itemprop="url">nginx入门使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T00:00:00+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文综合介绍了Nginx的概念、特性、配置文件说明、常用命令等。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Nginx是一个<strong>轻量级、高性能的HTTP和反向代理服务器</strong>，也是一个IMAP/POP3/SMTP服务器。它是由c语言开发，由俄罗斯人<code>伊戈尔·赛索耶夫</code>开发的，第一个公开版本发布于2004年10月4日。因它的稳定性、丰富的功能集、示例配置文件和低系统资源的消耗而闻名。其特点是<strong>占有内存少，并发能力强</strong>，事实上nginx是并发能力最好的web服务器，中国大陆使用nginx网站用户有：百度、京东、新浪、网易、腾讯、淘宝等。</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul>
<li><p>作为 Web 服务器：相比 Apache，Nginx 使用更少的资源，支持更多的并发连接，这点使 Nginx 尤其受到虚拟主机提供商的欢迎，能够支持高达 50,000 个并发连接数的响应。</p>
</li>
<li><p>作为反向代理和负载均衡服务器：Nginx 既可以在内部直接支持 Rails 和 PHP，也可以支持作为 HTTP代理服务器 对外进行服务。</p>
</li>
<li><p>作为邮件代理服务器: Nginx 同时也是一个非常优秀的邮件代理服务器（最早开发这个产品的目的之一也是作为邮件代理服务器）。</p>
</li>
<li><p>Nginx 安装非常简单，配置文件非常简洁，Bugs非常少，资源占用低: Nginx 启动特别容易，并且几乎可以做到7*24不间断运行，即使运行数个月也不需要重新启动。</p>
</li>
</ul>
<h2 id="安装步骤（Mac）"><a href="#安装步骤（Mac）" class="headerlink" title="安装步骤（Mac）"></a>安装步骤（Mac）</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew search nginx   <span class="comment"># 检查是否存在</span></span><br><span class="line">brew info nginx     <span class="comment"># 查看要安装的信息</span></span><br><span class="line">brew install nginx  <span class="comment"># 默认port 8080，访问：localhost:8080</span></span><br></pre></td></tr></table></figure>
<ul>
<li>默认的配置文件目录：<code>/usr/local/etc/nginx/nginx.conf</code></li>
<li>默认安装目录：<code>/usr/local/Cellar/nginx/1.13.9</code>，里面会有以nginx版本号命名的文件夹，这里就是安装的根目录。进入<code>1.13.9/bin</code>可以看到nginx的可执行文件。</li>
<li>在<code>1.13.9</code>目录下，还有一个名字为html的快捷方式文件夹，它指向的是<code>/usr/local/var/www</code>目录，该目录下包含<code>50x.html</code>和<code>index.html</code>文件，是nginx服务器默认的显示页面。当它不存在时，访问出现<code>403错误</code>。</li>
<li>使用<code>nginx</code>命令后台启动服务器</li>
</ul>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nginx            <span class="comment">#打开 nginx</span></span><br><span class="line">nginx -s reload  <span class="comment">#重新加载配置</span></span><br><span class="line">nginx -s reopen  <span class="comment">#重启nginx</span></span><br><span class="line">nginx -s stop    <span class="comment">#停止nginx</span></span><br><span class="line">nginx -s quit    <span class="comment">#退出nginx</span></span><br><span class="line">nginx -t         <span class="comment">#测试配置是否有语法错误</span></span><br></pre></td></tr></table></figure>
<h2 id="配置文件示例"><a href="#配置文件示例" class="headerlink" title="配置文件示例"></a>配置文件示例</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#运行用户</span></span><br><span class="line">user nobody;</span><br><span class="line"><span class="comment">#启动进程,通常设置成和cpu的数量相等</span></span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line"><span class="comment">#全局错误日志及PID文件</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#工作模式及连接数上限</span></span><br><span class="line">events &#123;</span><br><span class="line">    <span class="comment">#epoll是多路复用IO(I/O Multiplexing)中的一种方式,</span></span><br><span class="line">    <span class="comment">#仅用于linux2.6以上内核,可以大大提高nginx的性能</span></span><br><span class="line">    use   epoll; </span><br><span class="line"></span><br><span class="line">    <span class="comment">#单个后台worker process进程的最大并发链接数    </span></span><br><span class="line">    worker_connections  1024;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 并发总数是 worker_processes 和 worker_connections 的乘积</span></span><br><span class="line">    <span class="comment"># 即 max_clients = worker_processes * worker_connections</span></span><br><span class="line">    <span class="comment"># 在设置了反向代理的情况下，max_clients = worker_processes * worker_connections / 4  为什么</span></span><br><span class="line">    <span class="comment"># 为什么上面反向代理要除以4，应该说是一个经验值</span></span><br><span class="line">    <span class="comment"># 根据以上条件，正常情况下的Nginx Server可以应付的最大连接数为：4 * 8000 = 32000</span></span><br><span class="line">    <span class="comment"># worker_connections 值的设置跟物理内存大小有关</span></span><br><span class="line">    <span class="comment"># 因为并发受IO约束，max_clients的值须小于系统可以打开的最大文件数</span></span><br><span class="line">    <span class="comment"># 而系统可以打开的最大文件数和内存大小成正比，一般1GB内存的机器上可以打开的文件数大约是10万左右</span></span><br><span class="line">    <span class="comment"># 我们来看看360M内存的VPS可以打开的文件句柄数是多少：</span></span><br><span class="line">    <span class="comment"># $ cat /proc/sys/fs/file-max</span></span><br><span class="line">    <span class="comment"># 输出 34336</span></span><br><span class="line">    <span class="comment"># 32000 &lt; 34336，即并发连接总数小于系统可以打开的文件句柄总数，这样就在操作系统可以承受的范围之内</span></span><br><span class="line">    <span class="comment"># 所以，worker_connections 的值需根据 worker_processes 进程数目和系统可以打开的最大文件总数进行适当地进行设置</span></span><br><span class="line">    <span class="comment"># 使得并发总数小于操作系统可以打开的最大文件数目</span></span><br><span class="line">    <span class="comment"># 其实质也就是根据主机的物理CPU和内存进行配置</span></span><br><span class="line">    <span class="comment"># 当然，理论上的并发总数可能会和实际有所偏差，因为主机还有其他的工作进程需要消耗系统资源。</span></span><br><span class="line">    <span class="comment"># ulimit -SHn 65535</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    <span class="comment">#设定mime类型,类型由mime.type文件定义</span></span><br><span class="line">    include    mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    <span class="comment">#设定日志格式</span></span><br><span class="line">    log_format  main  <span class="string">'$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;</span><br><span class="line"></span><br><span class="line">    access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#sendfile 指令指定 nginx 是否调用 sendfile 函数（zero copy 方式）来输出文件，</span></span><br><span class="line">    <span class="comment">#对于普通应用，必须设为 on,</span></span><br><span class="line">    <span class="comment">#如果用来进行下载等应用磁盘IO重负载应用，可设置为 off，</span></span><br><span class="line">    <span class="comment">#以平衡磁盘与网络I/O处理速度，降低系统的uptime.</span></span><br><span class="line">    sendfile     on;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#连接超时时间</span></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    tcp_nodelay     on;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#开启gzip压缩</span></span><br><span class="line">    gzip  on;</span><br><span class="line">    gzip_disable <span class="string">"MSIE [1-6]."</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#设定请求缓冲</span></span><br><span class="line">    client_header_buffer_size    128k;</span><br><span class="line">    large_client_header_buffers  4 128k;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#设定虚拟主机配置</span></span><br><span class="line">    server &#123;</span><br><span class="line">        <span class="comment">#侦听80端口</span></span><br><span class="line">        listen    80;</span><br><span class="line">        <span class="comment">#定义使用 www.nginx.cn访问</span></span><br><span class="line">        server_name  www.nginx.cn;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#定义服务器的默认网站根目录位置</span></span><br><span class="line">        root html;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#设定本虚拟主机的访问日志</span></span><br><span class="line">        access_log  logs/nginx.access.log  main;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#默认请求</span></span><br><span class="line">        location / &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#定义首页索引文件的名称</span></span><br><span class="line">            index index.php index.html index.htm;   </span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义错误提示页面</span></span><br><span class="line">        error_page   500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#静态文件，nginx自己处理</span></span><br><span class="line">        location ~ ^/(images|javascript|js|css|flash|media|static)/ &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#过期30天，静态文件不怎么更新，过期可以设大一点，</span></span><br><span class="line">            <span class="comment">#如果频繁更新，则可以设置得小一点。</span></span><br><span class="line">            expires 30d;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#PHP 脚本请求全部转发到 FastCGI处理. 使用FastCGI默认配置.</span></span><br><span class="line">        location ~ .php$ &#123;</span><br><span class="line">            fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">            fastcgi_index index.php;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">            include fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#禁止访问 .htxxx 文件</span></span><br><span class="line">            location ~ /.ht &#123;</span><br><span class="line">            deny all;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/11/2018-07-11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/11/2018-07-11/" itemprop="url">node.js错误类型总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-11T00:00:00+08:00">
                2018-07-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本文大致介绍了node.js中四种常见的错误类型，列举了常见的标准错误，比如<code>SyntaxError``ReferenceError</code>等等，然后列举了自定义error和assertError的实例及错误的捕获和处理的几种方式。</p>
</blockquote>
<p>四种错误类型：</p>
<h2 id="1-标准错误"><a href="#1-标准错误" class="headerlink" title="1.标准错误"></a>1.标准错误</h2><p>这些错误在开发中都很常见，错误类型的有</p>
<ul>
<li><code>SyntaxError</code> js语法错误</li>
<li><code>ReferenceError</code> 使用未定义变量时抛出</li>
<li><code>RangeError</code> 当一个值不在指定范围内时抛出</li>
<li><code>TypeError</code> 传递错误的参数类型时抛出</li>
<li><code>EvalError</code> 调用<code>eval()</code>失败时抛出</li>
<li><code>URIError</code> 当一个全局的URI函数被错误使用时抛出</li>
</ul>
<h2 id="2-自定义错误"><a href="#2-自定义错误" class="headerlink" title="2.自定义错误"></a>2.自定义错误</h2><p>使用Error构造函数抛出错误信息：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var a = 1;</span><br><span class="line">if(a&lt;2)&#123;</span><br><span class="line">  throw Error(&quot;less than 2&quot;);</span><br><span class="line">&#125;</span><br><span class="line">console.log(&apos;last&apos;)  //这里不会在执行</span><br><span class="line"></span><br><span class="line">/Users/shaoc/svn/npmtest/src/tableheader/b.js:4</span><br><span class="line">  throw Error(&quot;less than 2&quot;);</span><br><span class="line">  ^</span><br><span class="line"></span><br><span class="line">Error: less than 2</span><br><span class="line">    at Error (native)</span><br><span class="line">    at Object.&lt;anonymous&gt; (/Users/shaoc/svn/npmtest/src/tableheader/b.js:4:9)</span><br><span class="line">    at Module._compile (module.js:570:32)</span><br><span class="line">    at Object.Module._extensions..js (module.js:579:10)</span><br><span class="line">    at Module.load (module.js:487:32)</span><br><span class="line">    at tryModuleLoad (module.js:446:12)</span><br><span class="line">    at Function.Module._load (module.js:438:3)</span><br><span class="line">    at Module.runMain (module.js:604:10)</span><br><span class="line">    at run (bootstrap_node.js:394:7)</span><br><span class="line">    at startup (bootstrap_node.js:149:9)</span><br></pre></td></tr></table></figure>
<h2 id="3-断言错误"><a href="#3-断言错误" class="headerlink" title="3.断言错误"></a>3.断言错误</h2><p>当代码违反业务逻辑时，由<code>assert</code>模块触发 </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">"assert"</span>)</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">assert(a &gt; <span class="number">10</span>, <span class="string">"a不能小于10"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'last'</span>)</span><br><span class="line">assert.js:<span class="number">85</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> assert.AssertionError(&#123;</span><br><span class="line">  ^</span><br><span class="line">AssertionError: a不能小于<span class="number">10</span></span><br><span class="line">    at <span class="built_in">Object</span>.&lt;anonymous&gt; (<span class="regexp">/Users/</span>shaoc/svn/npmtest/src/tableheader/b.js:<span class="number">5</span>:<span class="number">1</span>)</span><br><span class="line">    at Module._compile (<span class="built_in">module</span>.js:<span class="number">570</span>:<span class="number">32</span>)</span><br><span class="line">    at <span class="built_in">Object</span>.Module._extensions..js (<span class="built_in">module</span>.js:<span class="number">579</span>:<span class="number">10</span>)</span><br><span class="line">    at Module.load (<span class="built_in">module</span>.js:<span class="number">487</span>:<span class="number">32</span>)</span><br><span class="line">    at tryModuleLoad (<span class="built_in">module</span>.js:<span class="number">446</span>:<span class="number">12</span>)</span><br><span class="line">    at <span class="built_in">Function</span>.Module._load (<span class="built_in">module</span>.js:<span class="number">438</span>:<span class="number">3</span>)</span><br><span class="line">    at Module.runMain (<span class="built_in">module</span>.js:<span class="number">604</span>:<span class="number">10</span>)</span><br><span class="line">    at run (bootstrap_node.js:<span class="number">394</span>:<span class="number">7</span>)</span><br><span class="line">    at startup (bootstrap_node.js:<span class="number">149</span>:<span class="number">9</span>)</span><br><span class="line">    at bootstrap_node.js:<span class="number">509</span>:<span class="number">3</span></span><br></pre></td></tr></table></figure>
<h2 id="4-系统错误"><a href="#4-系统错误" class="headerlink" title="4.系统错误"></a>4.系统错误</h2><p>系统错误是对JavaScript错误Error对象的一个扩展，它们表示程序能够处理的操作错误，这些错误信息都是在系统级别生成的。系统错误实例中除Error实例中的属性外，还包括以下几个属性：</p>
<p>1、error.syscall - 一个表示失败的系统调用信息的字符串<br>2、error.errno - 一个整数的错误码<br>3、error.code - 表示错误字符串，通常是大写字母E开头</p>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><ul>
<li>node可以使用try catch 捕获异常，但是没有办法捕获到异步调用中发生的异常</li>
<li>使用错误优先的回调函数，function(err, data) //优先处理错误信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const fs = require(&apos;fs&apos;);</span><br><span class="line">fs.readFile(&apos;一个不存在的文件&apos;, (err, data) =&gt; &#123;</span><br><span class="line"> if (err) &#123;</span><br><span class="line">  console.error(&apos;读取文件错误&apos;, err);</span><br><span class="line">  return;</span><br><span class="line"> &#125;</span><br><span class="line"> // 其它处理</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>使用事件机制捕获异常</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const net = require(&apos;net&apos;);</span><br><span class="line">const connection = net.connect(&apos;localhost&apos;);</span><br><span class="line"> </span><br><span class="line">// 为stream添加一个 &apos;error&apos; 事件处理器:</span><br><span class="line">connection.on(&apos;error&apos;, (err) =&gt; &#123;</span><br><span class="line"> // 如果连接被服务器重置或连接不到指定的服务器</span><br><span class="line"> // 或其它连接错误时，错误会被传递到这里</span><br><span class="line"> console.error(err);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">connection.pipe(process.stdout);</span><br><span class="line"></span><br><span class="line">//全局</span><br><span class="line">process.on(&apos;uncaughtException&apos;, function (err) &#123;</span><br><span class="line">  log.app.error(&quot;Caught exception:-----&gt;&quot;, err);</span><br><span class="line">  process.exit(8);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>使用domain</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/15/2018-05-15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/15/2018-05-15/" itemprop="url">node.js中的module.exports和exports</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-15T00:00:00+08:00">
                2018-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前对<code>exports</code>和<code>module.exports</code>一直存在疑惑，知道<code>exports</code>使用不当可能会导致问题，所以一直使用<code>module.exports</code>, 理解没有深入。通过阅读官方文档，对它们的区别、联系和使用注意事项做一个总结。</p>
<h2 id="翻译自官方文档"><a href="#翻译自官方文档" class="headerlink" title="翻译自官方文档"></a>翻译自官方文档</h2><p><a href="https://nodejs.org/docs/latest/api/modules.html#modules_module_exports" target="_blank" rel="noopener">官方文档</a><br>在node每个模块中，都有一个<code>module</code>变量保存着对当前模块的引用。为了方便，<code>module.exports</code>也可以通过<code>exports</code>全局模块来访问。<code>module</code>不是全局的，对每一个模块来说，它都是一个本地变量。</p>
<h3 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a>module.exports</h3><p><code>module.exports</code>对象，是由模块系统创建的。当你想在其他类中引用一个模块时，可以用它来实现，通过将你要导出的对象赋值给<code>module.exports</code>。千万注意，本地的<code>exports</code>对象仅仅在初始的时候保存着对<code>module.exports</code>的引用，有些时候可能不会得到你想要的结果。<br>举个例子来说，创建一个a.js的模块：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"><span class="comment">// Do some work, and after some time emit</span></span><br><span class="line"><span class="comment">// the 'ready' event from the module itself.</span></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">module</span>.exports.emit(<span class="string">'ready'</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p>然后在另一个模块，我们可以引入它：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="built_in">require</span>(<span class="string">'./a'</span>);</span><br><span class="line">a.on(<span class="string">'ready'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'module "a" is ready'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>请注意，对<code>module.exports</code>的复制必须是立即执行的，不可以在任何回调中进行导出。比如，下面这样无效：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">module</span>.exports = &#123; <span class="attr">a</span>: <span class="string">'hello'</span> &#125;;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="exports-shortcut"><a href="#exports-shortcut" class="headerlink" title="exports shortcut"></a>exports shortcut</h3><p><code>exports</code>变量仅在模块的文件作用域内有效，在初始时，它保存着对<code>module.exports</code>的应用。所以有些时候，<code>module.exports.f = ...</code>可以简写为<code>exports.f = ....</code>。但是，千万注意，在对它进行重新赋值之后，它将不再绑定到<code>module.exports</code>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports.hello = <span class="literal">true</span>; <span class="comment">// Exported from require of module</span></span><br><span class="line">exports = &#123; <span class="attr">hello</span>: <span class="literal">false</span> &#125;;  <span class="comment">// Not exported, only available in the module</span></span><br></pre></td></tr></table></figure>
<p><strong>当对<code>module.exports</code>重新赋值为新对象的时候，最好把<code>exports</code>也重新赋值</strong>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = exports = <span class="function"><span class="keyword">function</span> <span class="title">Constructor</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... etc.</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="require实现"><a href="#require实现" class="headerlink" title="require实现"></a>require实现</h3><p>为了更好的解释这一点，下面是<code>require()</code>方法的简要实现，它和实际的实现基本原理相同：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">require</span>(<span class="params"><span class="regexp">/* ... */</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">module</span> = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line">  (<span class="function">(<span class="params"><span class="built_in">module</span>, exports</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Module code here. In this example, define a function.</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">someFunc</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    exports = someFunc;</span><br><span class="line">    <span class="comment">// At this point, exports is no longer a shortcut to module.exports, and</span></span><br><span class="line">    <span class="comment">// this module will still export an empty default object.</span></span><br><span class="line">    <span class="built_in">module</span>.exports = someFunc;</span><br><span class="line">    <span class="comment">// At this point, the module will now export someFunc, instead of the</span></span><br><span class="line">    <span class="comment">// default object.</span></span><br><span class="line">  &#125;)(<span class="built_in">module</span>, <span class="built_in">module</span>.exports);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>在一个模块内，<code>exports</code>仅仅是对<code>module.exports</code>的引用</li>
<li>在未对<code>exports</code>重新赋值前，可以使用<code>exports.myfun=function(){}</code>的形式导出，但请不要使用<code>exports = { }</code> 的形式</li>
<li>整对象导出时，尽量使用<code>module.exports=exports= function Constructor(){ }</code>的形式，避免出现漏洞</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/14/2018-05-14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/14/2018-05-14/" itemprop="url">node.js异步框架thenjs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-14T00:00:00+08:00">
                2018-05-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>项目中存在大量的es5回调的代码，而且生产环境对原生Promise、awati/async 支持不够好，所以使用then.js作为异步解决方案，避免回调地狱的问题，也能兼容老代码。本文简要介绍了then.js异步框架的特点、安装和基本用法。</p>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p>一个解决js异步回调问题的方案，它可以将“回调地狱”处理成并列的then链，方便代码的阅读和维护。<br><a href="https://www.npmjs.com/package/thenjs" target="_blank" rel="noopener">官网地址</a></p>
<h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul>
<li><p>可以像标准的 Promise 那样，把N多异步回调函数写成一个长长的 then 链，并且比 Promise 更简洁自然。因为如果使用标准 Promise 的 then 链，其中的异步函数都必须转换成 Promise，Thenjs 则无需转换，像使用 callback 一样执行异步函数即可。</p>
</li>
<li><p>强大的 Error 机制，可以捕捉任何同步或异步的异常错误，甚至是位于异步函数中的语法错误。并且捕捉的错误任君处置。</p>
</li>
<li><p>开启debug模式，可以把每一个then链运行结果输出到debug函数（未定义debug函数则用 console.log），方便调试。</p>
</li>
</ul>
<h2 id="安装-amp-使用"><a href="#安装-amp-使用" class="headerlink" title="安装&amp;使用"></a>安装&amp;使用</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install thenjs --save</span><br><span class="line">var Thenjs = require(&quot;thenjs&quot;);</span><br></pre></td></tr></table></figure>
<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs(<span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123;</span><br><span class="line">  cont(<span class="literal">null</span>, result);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123;</span><br><span class="line">  cont(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error!'</span>), <span class="number">123</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.fin(<span class="function"><span class="keyword">function</span> (<span class="params">cont, error, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(error, result);</span><br><span class="line">  cont();</span><br><span class="line">&#125;)</span><br><span class="line">.each([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="function"><span class="keyword">function</span> (<span class="params">cont, value</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//do sth with value</span></span><br><span class="line">  cont(<span class="literal">null</span>);  <span class="comment">// 并行执行队列任务，把队列 list 中的每一个值输入到 task 中运行</span></span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">  cont();</span><br><span class="line">&#125;)</span><br><span class="line">.series([ <span class="comment">// 串行执行队列任务</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; task(<span class="number">88</span>, cont); &#125;, <span class="comment">// 队列第一个是异步任务</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; cont(<span class="literal">null</span>, <span class="number">99</span>); &#125; <span class="comment">// 第二个是同步任务</span></span><br><span class="line">])</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">  cont(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error!!'</span>));</span><br><span class="line">&#125;)</span><br><span class="line">.fail(<span class="function"><span class="keyword">function</span> (<span class="params">cont, error</span>) </span>&#123; <span class="comment">// 通常应该在链的最后放置一个 `fail` 方法收集异常</span></span><br><span class="line">  <span class="built_in">console</span>.log(error);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'DEMO END!'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="两种方式定义"><a href="#两种方式定义" class="headerlink" title="两种方式定义"></a>两种方式定义</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs().then(<span class="function"><span class="keyword">function</span>(<span class="params">cont</span>) </span>&#123; </span><br><span class="line">    cont(<span class="literal">null</span>); </span><br><span class="line">&#125;);</span><br><span class="line">Thenjs(<span class="function"><span class="keyword">function</span>(<span class="params">cont, result</span>) </span>&#123; </span><br><span class="line">    cont(result); </span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-each-array-iterator"><a href="#Thenjs-each-array-iterator" class="headerlink" title="Thenjs.each(array, iterator)"></a>Thenjs.each(array, iterator)</h3><p>将 array 中的值应用于 iterator 函数（同步或异步），并行执行。返回一个新的 Thenjs 对象。<br>返回结果result是一个数组，包含每个cont返回的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs.each([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="function"><span class="keyword">function</span> (<span class="params">cont, value</span>) </span>&#123;</span><br><span class="line">  task(value * <span class="number">2</span>, cont);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-eachSeries-array-iterator"><a href="#Thenjs-eachSeries-array-iterator" class="headerlink" title="Thenjs.eachSeries(array, iterator)"></a>Thenjs.eachSeries(array, iterator)</h3><p>同上，串行执行</p>
<h3 id="Thenjs-parallel-tasksArray"><a href="#Thenjs-parallel-tasksArray" class="headerlink" title="Thenjs.parallel(tasksArray)"></a>Thenjs.parallel(tasksArray)</h3><p>tasksArray 是一个函数（同步或异步）数组，<strong>并行执行</strong>。返回一个新的 Thenjs 对象。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs.parallel([</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; task(<span class="number">88</span>, cont); &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; cont(<span class="literal">null</span>, <span class="number">99</span>); &#125;</span><br><span class="line">])</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;  <span class="comment">//result 是返回结果的数组</span></span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-series-tasksArray"><a href="#Thenjs-series-tasksArray" class="headerlink" title="Thenjs.series(tasksArray)"></a>Thenjs.series(tasksArray)</h3><p>同上，接受函数数组参数，<strong>串行执行</strong></p>
<h3 id="Thenjs-parallelLimit-tasksArray-limit"><a href="#Thenjs-parallelLimit-tasksArray-limit" class="headerlink" title="Thenjs.parallelLimit(tasksArray, limit)"></a>Thenjs.parallelLimit(tasksArray, limit)</h3><p>同parallel，并行执行，不过限制最大并发数为limit</p>
<h3 id="Thenjs-eachLimit-array-iterator-limit"><a href="#Thenjs-eachLimit-array-iterator-limit" class="headerlink" title="Thenjs.eachLimit(array, iterator, limit)"></a>Thenjs.eachLimit(array, iterator, limit)</h3><p>同each，并行执行，限制最大并发数为limit</p>
<h3 id="Thenjs-prototype-then-successHandler-errorHandler"><a href="#Thenjs-prototype-then-successHandler-errorHandler" class="headerlink" title="Thenjs.prototype.then(successHandler, [errorHandler])"></a>Thenjs.prototype.then(successHandler, [errorHandler])</h3><p>如果上一链正确，则进入 successHandler 执行，否则进入 errorHandler 执行。返回一个新的 Thenjs 对象。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs(<span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123;</span><br><span class="line">  task(<span class="number">10</span>, cont);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, arg</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arg);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">cont, error</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.error(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-prototype-finally-finallyHandler"><a href="#Thenjs-prototype-finally-finallyHandler" class="headerlink" title="Thenjs.prototype.finally(finallyHandler)"></a>Thenjs.prototype.finally(finallyHandler)</h3><p>别名<code>fin</code><br>无论上一链是否存在 error，均进入 finallyHandler 执行，等效于 .then(successHandler, errorHandler)。返回一个新的 Thenjs 对象。</p>
<h3 id="Thenjs-prototype-fail-errorHandler"><a href="#Thenjs-prototype-fail-errorHandler" class="headerlink" title="Thenjs.prototype.fail(errorHandler)"></a>Thenjs.prototype.fail(errorHandler)</h3><p>fail 用于捕捉 error，如果在它之前的任意一个链上产生了 error，并且未被 then, finally 等捕获，则会跳过中间链，直接进入 fail。返回一个新的 Thenjs 对象。</p>
<h3 id="prototype也有each-eachSeries-parallel-series"><a href="#prototype也有each-eachSeries-parallel-series" class="headerlink" title="prototype也有each eachSeries parallel series"></a>prototype也有each eachSeries parallel series</h3><p>Thenjs.prototype.each(array, iterator)<br>参数类似 Thenjs.each，返回一个新的 Thenjs 对象。</p>
<p>不同在于，参数可省略，如果没有参数，则会查找上一个链的输出结果作为参数，即上一个链可以这样 cont(null, array, iterator) 传输参数到each。下面三个队列方法行为类似。</p>
<p>Thenjs.prototype.eachSeries(array, iterator)<br>参数类似 Thenjs.eachSeries，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.parallel(tasksArray)<br>参数类似 Thenjs.parallel，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.series(tasksArray)<br>参数类似 Thenjs.series，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.parallelLimit(tasksArray, limit)<br>参数类似 Thenjs.parallelLimit，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.eachLimit(array, iterator, limit)<br>参数类似 Thenjs.eachLimit，返回一个新的 Thenjs 对象。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/05/2017-12-05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/05/2017-12-05/" itemprop="url">设计模式6原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-05T00:00:00+08:00">
                2017-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="设计模式6原则"><a href="#设计模式6原则" class="headerlink" title="设计模式6原则"></a>设计模式6原则</h1><p>参考自csdn：<a href="https://www.cnblogs.com/dolphin0520/p/3919839.html" target="_blank" rel="noopener">设计模式之六大原则</a></p>
<h2 id="1-单一职责原则-SRP"><a href="#1-单一职责原则-SRP" class="headerlink" title="1 单一职责原则 SRP"></a>1 单一职责原则 SRP</h2><blockquote>
<p>单一职责原则(Single Responsibility Principle, SRP)：一个类只负责一个功能领域中的相应职责，或者可以定义为：就一个类而言，应该只有一个引起它变化的原因。</p>
</blockquote>
<p>  单一职责原则告诉我们：一个类不能太“累”！在软件系统中，一个类（大到模块，小到方法）承担的职责越多，它被复用的可能性就越小，而且一个类承担的职责过多，就相当于将这些职责耦合在一起，当其中一个职责变化时，可能会影响其他职责的运作，因此要将这些职责进行分离，将不同的职责封装在不同的类中，即将不同的变化原因封装在不同的类中，如果多个职责总是同时发生改变则可将它们封装在同一类中。</p>
<p>==单一职责原则是实现高内聚、低耦合的指导方针，它是最简单但又最难运用的原则，需要设计人员发现类的不同职责并将其分离，而发现类的多重职责需要设计人员具有较强的分析设计能力和相关实践经验。==</p>
<h2 id="2-开闭原则-OCP"><a href="#2-开闭原则-OCP" class="headerlink" title="2 开闭原则 OCP"></a>2 开闭原则 OCP</h2><p>开闭原则是面向对象的可复用设计的第一块基石，它是最重要的面向对象设计原则。</p>
<blockquote>
<p>开闭原则(Open-Closed Principle, OCP)：一个软件实体应当对扩展开放，对修改关闭。即软件实体应尽量在不修改原有代码的情况下进行扩展。</p>
</blockquote>
<p>任何软件都需要面临一个很重要的问题，即它们的需求会随时间的推移而发生变化。当软件系统需要面对新的需求时，我们应该尽量保证系统的设计框架是稳定的。如果一个软件设计符合开闭原则，那么可以非常方便地对系统进行扩展，而且在扩展时无须修改现有代码，使得软件系统在拥有适应性和灵活性的同时具备较好的稳定性和延续性。随着软件规模越来越大，软件寿命越来越长，软件维护成本越来越高，设计满足开闭原则的软件系统也变得越来越重要。</p>
<p>为了满足开闭原则，==需要对系统进行抽象化设计，抽象化是开闭原则的关键==。在Java、C#等编程语言中，可以为系统定义一个相对稳定的抽象层，而将不同的实现行为移至具体的实现层中完成。在很多面向对象编程语言中都提供了接口、抽象类等机制，可以通过它们定义系统的抽象层，再通过具体类来进行扩展。==如果需要修改系统的行为，无须对抽象层进行任何改动，只需要增加新的具体类来实现新的业务功能即可，实现在不修改已有代码的基础上扩展系统的功能，达到开闭原则的要求。==</p>
<h2 id="3-里氏替换原则-LSP"><a href="#3-里氏替换原则-LSP" class="headerlink" title="3 里氏替换原则 LSP"></a>3 里氏替换原则 LSP</h2><blockquote>
<p>里氏代换原则(Liskov Substitution Principle, LSP)：所有引用基类（父类）的地方必须能透明地使用其子类的对象。</p>
</blockquote>
<p>==通俗的讲：“老鼠的儿子会打洞”==</p>
<p>里氏代换原则告诉我们，==在软件中将一个基类对象替换成它的子类对象，程序将不会产生任何错误和异常，反过来则不成立，如果一个软件实体使用的是一个子类对象的话，那么它不一定能够使用基类对象==。例如：我喜欢动物，那我一定喜欢狗，因为狗是动物的子类；但是我喜欢狗，不能据此断定我喜欢动物，因为我并不喜欢老鼠，虽然它也是动物。</p>
<p>例如有两个类，一个类为BaseClass，另一个是SubClass类，并且SubClass类是BaseClass类的子类，那么一个方法如果可以接受一个BaseClass类型的基类对象base的话，如：method1(base)，那么它必然可以接受一个BaseClass类型的子类对象sub，method1(sub)能够正常运行。反过来的代换不成立，如一个方法method2接受BaseClass类型的子类对象sub为参数：method2(sub)，那么一般而言不可以有method2(base)，除非是重载方法。</p>
<p>==里氏代换原则是实现开闭原则的重要方式之一，由于使用基类对象的地方都可以使用子类对象，因此在程序中尽量使用基类类型来对对象进行定义，而在运行时再确定其子类类型，用子类对象来替换父类对象。==</p>
<p>在使用里氏代换原则时需要注意如下几个问题：</p>
<p>(1)子类的所有方法必须在父类中声明，或子类必须实现父类中声明的所有方法。根据里氏代换原则，为了保证系统的扩展性，在程序中通常使用父类来进行定义，如果一个方法只存在子类中，在父类中不提供相应的声明，则无法在以父类定义的对象中使用该方法。</p>
<p>(2) 我们在运用里氏代换原则时，尽量把父类设计为抽象类或者接口，让子类继承父类或实现父接口，并实现在父类中声明的方法，运行时，子类实例替换父类实例，我们可以很方便地扩展系统的功能，同时无须修改原有子类的代码，增加新的功能可以通过增加一个新的子类来实现。里氏代换原则是开闭原则的具体实现手段之一。</p>
<p>(3) Java语言中，在编译阶段，Java编译器会检查一个程序是否符合里氏代换原则，这是一个与实现无关的、纯语法意义上的检查，但Java编译器的检查是有局限的。</p>
<h2 id="4-依赖倒置原则-DIP"><a href="#4-依赖倒置原则-DIP" class="headerlink" title="4 依赖倒置原则  DIP"></a>4 依赖倒置原则  DIP</h2><blockquote>
<p>依赖倒转原则(Dependency Inversion  Principle, DIP)：抽象不应该依赖于细节，细节应当依赖于抽象。换言之，要针对接口编程，而不是针对实现编程。</p>
</blockquote>
<p>==依赖倒转原则要求我们在程序代码中传递参数时或在关联关系中，尽量引用层次高的抽象层类，即使用接口和抽象类进行变量类型声明、参数类型声明、方法返回类型声明，以及数据类型的转换等，而不要用具体类来做这些事情。为了确保该原则的应用，一个具体类应当只实现接口或抽象类中声明过的方法，而不要给出多余的方法，否则将无法调用到在子类中增加的新方法。==</p>
<p>在引入抽象层后，系统将具有很好的灵活性，在程序中尽量使用抽象层进行编程，而将具体类写在配置文件中，这样一来，如果系统行为发生变化，只需要对抽象层进行扩展，并修改配置文件，而无须修改原有系统的源代码，在不修改的情况下来扩展系统的功能，满足开闭原则的要求。</p>
<p>在实现依赖倒转原则时，==我们需要针对抽象层编程，而将具体类的对象通过<strong>依赖注入(DependencyInjection, DI)</strong>的方式注入到其他对象中，依赖注入是指当一个对象要与其他对象发生依赖关系时，通过抽象来注入所依赖的对象。常用的注入方式有三种，分别是：构造注入，设值注入（Setter注入）和接口注入。构造注入是指通过构造函数来传入具体类的对象，设值注入是指通过Setter方法来传入具体类的对象，而接口注入是指通过在接口中声明的业务方法来传入具体类的对象。这些方法在定义时使用的是抽象类型，在运行时再传入具体类型的对象，由子类对象来覆盖父类对象。==</p>
<h2 id="5-接口隔离原则-ISP"><a href="#5-接口隔离原则-ISP" class="headerlink" title="5 接口隔离原则 ISP"></a>5 接口隔离原则 ISP</h2><blockquote>
<p>接口隔离原则(Interface  Segregation Principle, ISP)：使用多个专门的接口，而不使用单一的总接口，即客户端不应该依赖那些它不需要的接口。</p>
</blockquote>
<p> 根据接口隔离原则，当一个接口太大时，我们需要将它分割成一些更细小的接口，使用该接口的客户端仅需知道与之相关的方法即可。==每一个接口应该承担一种相对独立的角色，不干不该干的事，该干的事都要干。==这里的“接口”往往有两种不同的含义：一种是指一个类型所具有的方法特征的集合，仅仅是一种逻辑上的抽象；另外一种是指某种语言具体的“接口”定义，有严格的定义和结构，比如Java语言中的interface。对于这两种不同的含义，ISP的表达方式以及含义都有所不同：</p>
<p>(1) 当把“接口”理解成一个类型所提供的所有方法特征的集合的时候，这就是一种逻辑上的概念，接口的划分将直接带来类型的划分。可以把接口理解成角色，一个接口只能代表一个角色，每个角色都有它特定的一个接口，此时，这个原则可以叫做==“角色隔离原则”==。</p>
<p>(2) 如果把“接口”理解成狭义的特定语言的接口，那么ISP表达的意思是指==接口仅仅提供客户端需要的行为，客户端不需要的行为则隐藏起来，应当为客户端提供尽可能小的单独的接口，而不要提供大的总接口==。在面向对象编程语言中，实现一个接口就需要实现该接口中定义的所有方法，因此大的总接口使用起来不一定很方便，为了使接口的职责单一，需要将大接口中的方法根据其职责不同分别放在不同的小接口中，以确保每个接口使用起来都较为方便，并都承担某一单一角色。接口应该尽量细化，同时接口中的方法应该尽量少，每个接口中只包含一个客户端（如子模块或业务逻辑类）所需的方法即可，这种机制也称为“定制服务”，即为不同的客户端提供宽窄不同的接口。</p>
<h2 id="6-迪米特法则-LOD"><a href="#6-迪米特法则-LOD" class="headerlink" title="6 迪米特法则 LOD"></a>6 迪米特法则 LOD</h2><p>==<strong>迪米特法则(Law of  Demeter, LoD)：一个软件实体应当尽可能少地与其他实体发生相互作用。</strong>==</p>
<p>如果一个系统符合迪米特法则，那么当其中某一个模块发生修改时，就会尽量少地影响其他模块，扩展会相对容易，这是对软件实体之间通信的限制，迪米特法则要求限制软件实体之间通信的宽度和深度。==迪米特法则可降低系统的耦合度，使类与类之间保持松散的耦合关系。==</p>
<p>迪米特法则还有几种定义形式，包括：<strong>不要和“陌生人”说话、只与你的直接朋友通信等</strong>。</p>
<p>迪米特法则要求我们在设计系统时，==应该尽量减少对象之间的交互，如果两个对象之间不必彼此直接通信，那么这两个对象就不应当发生任何直接的相互作用，如果其中的一个对象需要调用另一个对象的某一个方法的话，可以通过第三者转发这个调用。简言之，就是通过引入一个合理的第三者来降低现有对象之间的耦合度。==</p>
<p>在将迪米特法则运用到系统设计中时，要注意下面的几点：==在类的划分上，应当尽量创建松耦合的类，类之间的耦合度越低，就越有利于复用，一个处在松耦合中的类一旦被修改，不会对关联的类造成太大波及；在类的结构设计上，每一个类都应当尽量降低其成员变量和成员函数的访问权限；在类的设计上，只要有可能，一个类型应当设计成不变类；在对其他类的引用上，一个对象对其他对象的引用应当降到最低。==</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/02/2017-08-02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/02/2017-08-02/" itemprop="url">正则表达式总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-02T00:00:00+08:00">
                2017-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="正则表达式总结"><a href="#正则表达式总结" class="headerlink" title="正则表达式总结"></a>正则表达式总结</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 直接实例化</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern [, flags]);</span><br><span class="line"><span class="comment">// 隐式创建(推荐)</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/pattern/</span>flags;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>参数 pattern 是一个字符串，指定了正则表达式的模式或其他正则表达式。</p>
</li>
<li><p>参数 [, flags] 是一个可选的字符串，包含属性 “g”（global ）、”i” （ignoreCase）和 “m”（multiline）。</p>
</li>
</ul>
<h3 id="子表达式"><a href="#子表达式" class="headerlink" title="子表达式"></a>子表达式</h3><p>在正则表达式中，使用括号括起来的内容是一个<strong>子表达式</strong>，子表达式匹配到的内容会被系统捕获至缓冲区，使用<strong>\n（n：数字）</strong>来反向引用系统的第n号缓冲区的内容。</p>
<p><strong>使用场景：后面的内容要求与前面的一致，可以使用子表达式</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 查找连续相同的四个数字</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"1212ab45677778cd"</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\d)\1\1\1/gi</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.match(reg));</span><br><span class="line"><span class="comment">// OUTPUT:7777</span></span><br></pre></td></tr></table></figure>
<h3 id="方括号（字符簇）"><a href="#方括号（字符簇）" class="headerlink" title="方括号（字符簇）"></a>方括号（字符簇）</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Is this all there is?"</span>;</span><br><span class="line"><span class="keyword">var</span> patt1 = <span class="regexp">/[a-h]/g</span>;</span><br><span class="line"><span class="built_in">document</span>.write(str.match(patt1));</span><br><span class="line"><span class="comment">// OUTPUT:h,a,h,e,e</span></span><br></pre></td></tr></table></figure>
<p>方括号    作用</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[abc]	查找方括号之间的任何字符。</span><br><span class="line">[^abc]查找任何不在方括号之间的字符。</span><br><span class="line">[0-9]	查找任何从 0 至 9 的数字。同 \d</span><br><span class="line">[a-z]	查找任何从小写 a 到小写 z 的字符。</span><br><span class="line">[A-Z]	查找任何从大写 A 到大写 Z 的字符。</span><br><span class="line">[A-z]	查找任何从大写 A 到小写 z 的字符。</span><br><span class="line">[0-9a-zA-Z]	查找0-9,a-z,A-Z</span><br></pre></td></tr></table></figure>
<h3 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">元字符（Metacharacter）是拥有特殊含义的字符：</span><br><span class="line">元字符 | 作用</span><br><span class="line">—|—</span><br><span class="line">\ | 转义符 （、）、/、\</span><br><span class="line">| | 选择匹配符，可以匹配多个规则</span><br><span class="line">. | 查找单个字符，除了换行和行结束符。</span><br><span class="line">\w | 查找单词字符。字符 ( 字母 ，数字，下划线_ )</span><br><span class="line">\W | 查找非单词字符。</span><br><span class="line">\d | 查找数字。</span><br><span class="line">\D | 查找非数字字符。</span><br><span class="line">\s | 查找空白字符。空格</span><br><span class="line">\S | 查找非空白字符。</span><br><span class="line">\b | 匹配单词边界。</span><br><span class="line">\B | 匹配非单词边界。</span><br><span class="line">\0 | 查找 NUL 字符。</span><br><span class="line">\n | 查找换行符。</span><br><span class="line">\f | 查找换页符。</span><br><span class="line">\r | 查找回车符。</span><br><span class="line">\t | 查找制表符。</span><br><span class="line">\v | 查找垂直制表符。</span><br><span class="line">\xxx | 查找以八进制数 xxx 规定的字符。</span><br><span class="line">\xdd | 查找以十六进制数 dd 规定的字符。</span><br><span class="line">\uxxxx | 查找以十六进制数 xxxx 规定的 Unicode 字符。</span><br></pre></td></tr></table></figure>
<h3 id="量词"><a href="#量词" class="headerlink" title="量词"></a>量词</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">量词	作用</span><br><span class="line">n+	匹配任何包含至少一个 n 的字符串。同 &#123;1,&#125;</span><br><span class="line">n*	匹配任何包含零个或多个 n 的字符串。同 &#123;0,&#125;</span><br><span class="line">n?	匹配任何包含零个或一个 n 的字符串。同 &#123;0,1&#125;</span><br><span class="line">n&#123;X&#125;	匹配包含 X 个 n 的序列的字符串。</span><br><span class="line">n&#123;X,Y&#125;	匹配包含 X 至 Y 个 n 的序列的字符串。</span><br><span class="line">n&#123;X,&#125;	匹配包含至少 X 个 n 的序列的字符串。</span><br><span class="line">n$	匹配任何结尾为 n 的字符串。</span><br><span class="line">^n	匹配任何开头为 n 的字符串。注意 /[^a] / 和 /^ [a]/是不一样的，前者是排除的，后者是代表首位。</span><br><span class="line">(?=n)	匹配任何其后紧接指定字符串 n 的字符串。正向预查</span><br><span class="line">(?!n)	匹配任何其后没有紧接指定字符串 n 的字符串。反向预查</span><br></pre></td></tr></table></figure>
<h2 id="RegExp-对象方法"><a href="#RegExp-对象方法" class="headerlink" title="RegExp 对象方法"></a>RegExp 对象方法</h2><h3 id="test"><a href="#test" class="headerlink" title="test()"></a>test()</h3><p><code>test()</code> 方法检索字符串中是否存在指定的值。返回值是 true 或 false。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var patt1 = new RegExp(&apos;e&apos;);</span><br><span class="line">console.log(patt1.test(&apos;some text&apos;));</span><br><span class="line">// OUTPUT:true</span><br><span class="line">var patt2 = new RegExp(&apos;ee&apos;);</span><br><span class="line">console.log(patt2.test(&apos;some text&apos;));</span><br><span class="line">// OUTPUT:false</span><br></pre></td></tr></table></figure>
<h3 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h3><p><code>exec()</code> 方法检索字符串中的指定值。返回值是被找到的值。如果没有发现匹配，则返回 null。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> patt1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'e'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(patt1.exec(<span class="string">'some text'</span>));</span><br><span class="line"><span class="comment">// OUTPUT:e</span></span><br><span class="line"><span class="keyword">var</span> patt2 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'ee'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(patt2.exec(<span class="string">'some text'</span>));</span><br><span class="line"><span class="comment">// OUTPUT:null</span></span><br></pre></td></tr></table></figure>
<h3 id="compile"><a href="#compile" class="headerlink" title="compile()"></a>compile()</h3><p><code>compile()</code> 既可以改变检索模式，也可以添加或删除第二个参数。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> patt1=<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"e"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(patt1.test(<span class="string">"The best things in life are free"</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="comment">// 改变了检索模式</span></span><br><span class="line">patt1.compile(<span class="string">"eee"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(patt1.test(<span class="string">"The best things in life are free"</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="支持正则表达式的-String-对象的方法"><a href="#支持正则表达式的-String-对象的方法" class="headerlink" title="支持正则表达式的 String 对象的方法"></a>支持正则表达式的 String 对象的方法</h2><h3 id="search-检索与正则表达式相匹配的值，输出所在位置。"><a href="#search-检索与正则表达式相匹配的值，输出所在位置。" class="headerlink" title="search 检索与正则表达式相匹配的值，输出所在位置。"></a>search 检索与正则表达式相匹配的值，输出所在位置。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Visit W3School!"</span></span><br><span class="line"><span class="built_in">console</span>.log(str.search(<span class="regexp">/W3School/</span>))</span><br><span class="line"><span class="comment">// OUTPUT:6</span></span><br></pre></td></tr></table></figure>
<h3 id="match-找到一个或多个正则表达式的匹配。"><a href="#match-找到一个或多个正则表达式的匹配。" class="headerlink" title="match 找到一个或多个正则表达式的匹配。"></a>match 找到一个或多个正则表达式的匹配。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">"1 plus 2 equal 3"</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/\d+/g</span>))</span><br><span class="line"><span class="comment">// OUTPUT:1,2,3</span></span><br></pre></td></tr></table></figure>
<h3 id="replace-替换与正则表达式匹配的子串。"><a href="#replace-替换与正则表达式匹配的子串。" class="headerlink" title="replace 替换与正则表达式匹配的子串。"></a>replace 替换与正则表达式匹配的子串。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Visit Microsoft!"</span></span><br><span class="line"><span class="built_in">console</span>.log(str.replace(<span class="regexp">/Microsoft/</span>, <span class="string">"W3School"</span>));</span><br><span class="line"><span class="comment">// OUTPUT:Visit W3School!</span></span><br></pre></td></tr></table></figure>
<h3 id="split-把字符串分割为字符串数组。"><a href="#split-把字符串分割为字符串数组。" class="headerlink" title="split 把字符串分割为字符串数组。"></a>split 把字符串分割为字符串数组。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"How are you doing today?"</span></span><br><span class="line"><span class="built_in">document</span>.write(str.split(<span class="regexp">/\s+/</span>));</span><br><span class="line"><span class="comment">// OUTPUT:How,are,you,doing,today?</span></span><br></pre></td></tr></table></figure>
<h2 id="常见的正则验证"><a href="#常见的正则验证" class="headerlink" title="常见的正则验证"></a>常见的正则验证</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见的 正则表达式 校验</span></span><br><span class="line"><span class="comment">// QQ号、手机号、Email、是否是数字、去掉前后空格、是否存在中文、邮编、身份证、URL、日期格式、IP</span></span><br><span class="line"><span class="keyword">var</span> myRegExp = &#123;</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法QQ号码</span></span><br><span class="line">    isQQ: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 1 首位不能是0  ^[1-9]</span></span><br><span class="line">        <span class="comment">// 2 必须是 [5, 11] 位的数字  \d&#123;4, 9&#125;</span></span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^[1-9][0-9]&#123;4,9&#125;$/gim</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'QQ号码格式输入正确'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'请输入正确格式的QQ号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法手机号码</span></span><br><span class="line">    isPhone: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^(0|86|17951)?(13[0-9]|15[012356789]|18[0-9]|14[57]|17[678])[0-9]&#123;8&#125;$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'手机号码格式输入正确'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'请输入正确格式的手机号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法Email地址</span></span><br><span class="line">    isEmail: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/</span>;</span><br><span class="line">        <span class="comment">// var reg = /\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;</span></span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'Email格式输入正确'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'请输入正确格式的Email'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否是数字</span></span><br><span class="line">    isNumber: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^\d+$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">'是数字'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">'不是数字'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 去掉前后空格</span></span><br><span class="line">    trim: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^\s+|\s+$/g</span>;</span><br><span class="line">        <span class="keyword">return</span> str.replace(reg, <span class="string">''</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否存在中文</span></span><br><span class="line">    isChinese: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/[\u4e00-\u9fa5]/gm</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 中存在中文'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 中不存在中文'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法邮政编码</span></span><br><span class="line">    isPostcode: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 起始数字不能为0，然后是5个数字  [1-9]\d&#123;5&#125;</span></span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^[1-9]\d&#123;5&#125;$/g</span>;</span><br><span class="line">        <span class="comment">// var reg = /^[1-9]\d&#123;5&#125;(?!\d)$/;</span></span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的邮编格式'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的邮编格式'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法身份证号码</span></span><br><span class="line">    isIDcard: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^(^[1-9]\d&#123;7&#125;((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d&#123;3&#125;$)|(^[1-9]\d&#123;5&#125;[1-9]\d&#123;3&#125;((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d&#123;4&#125;)|\d&#123;3&#125;[Xx])$)$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的身份证号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的身份证号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法URL</span></span><br><span class="line">    isURL: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&amp;?[a-zA-Z0-9_-](\?)?)*)*$/i</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的URL'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的URL'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法日期格式 yyyy-mm-dd</span></span><br><span class="line">    isDate: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^[1-2][0-9][0-9][0-9]-[0-1]&#123;0,1&#125;[0-9]-[0-3]&#123;0,1&#125;[0-9]$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的日期格式'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的日期格式，yyyy-mm-dd'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法IP地址</span></span><br><span class="line">    isIP: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 1.1.1.1  四段  [0 , 255]</span></span><br><span class="line">        <span class="comment">// 第一段不能为0</span></span><br><span class="line">        <span class="comment">// 每个段不能以0开头</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 本机IP: 58.50.120.18 湖北省荆州市 电信</span></span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\.([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))&#123;3&#125;$/gi</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的IP地址'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的IP地址'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isQQ('80583600'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isPhone('17607160722'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isEmail('80583600@qq.com'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isNumber('100a'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.trim('  100  '));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isChinese('baixiaoming'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isChinese('小明'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isPostcode('412345'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isIDcard('42091119940927001X'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isURL('https://www.baidu.com/'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isDate('2017-4-4'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isIP('1.0.0.0'));</span></span><br></pre></td></tr></table></figure>
<h2 id="校验数字的表达式"><a href="#校验数字的表达式" class="headerlink" title="校验数字的表达式"></a>校验数字的表达式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">数字：^[0-9]*$</span><br><span class="line">n位的数字：^\d&#123;n&#125;$</span><br><span class="line">至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line">m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line">零和非零开头的数字：^(0|[1-9][0-9]*)$</span><br><span class="line">非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$</span><br><span class="line">正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line">有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line">非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$</span><br><span class="line">非零的负整数：^\-[1-9][]0-9&quot;*$ 或 ^-[1-9]\d*$</span><br><span class="line">非负整数：^\d+$ 或 ^[1-9]\d*|0$</span><br><span class="line">非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span><br><span class="line">非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span><br><span class="line">非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span><br><span class="line">正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span><br><span class="line">负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span><br><span class="line">浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span><br></pre></td></tr></table></figure>
<h2 id="校验字符的表达式"><a href="#校验字符的表达式" class="headerlink" title="校验字符的表达式"></a>校验字符的表达式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">汉字：^[\u4e00-\u9fa5]&#123;0,&#125;$</span><br><span class="line">英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span><br><span class="line">长度为3-20的所有字符：^.&#123;3,20&#125;$</span><br><span class="line">由26个英文字母组成的字符串：^[A-Za-z]+$</span><br><span class="line">由26个大写英文字母组成的字符串：^[A-Z]+$</span><br><span class="line">由26个小写英文字母组成的字符串：^[a-z]+$</span><br><span class="line">由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span><br><span class="line">由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;3,20&#125;$</span><br><span class="line">中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</span><br><span class="line">可以输入含有^%&amp;&apos;,;=?$\&quot;等字符：[^%&amp;&apos;,;=?$\x22]+</span><br><span class="line">禁止输入含有~的字符：[^~\x22]+</span><br></pre></td></tr></table></figure>
<h2 id="特殊需求的表达式"><a href="#特殊需求的表达式" class="headerlink" title="特殊需求的表达式"></a>特殊需求的表达式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span><br><span class="line">域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span><br><span class="line">InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$</span><br><span class="line">手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</span><br><span class="line">电话号码(&quot;XXX-XXXXXXX&quot;、&quot;XXXX-XXXXXXXX&quot;、&quot;XXX-XXXXXXX&quot;、&quot;XXX-XXXXXXXX&quot;、&quot;XXXXXXX&quot;和&quot;XXXXXXXX)：^(\(\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$</span><br><span class="line">国内电话号码(0511-4405222、021-87888822)：\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;</span><br><span class="line">身份证号(15位、18位数字)：^\d&#123;15&#125;|\d&#123;18&#125;$</span><br><span class="line">短身份证号码(数字、字母x结尾)：^([0-9])&#123;7,18&#125;(x|X)?$ 或 ^\d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$</span><br><span class="line">帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</span><br><span class="line">密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;5,17&#125;$</span><br><span class="line">强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</span><br><span class="line">日期格式：^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;</span><br><span class="line">一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line">一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$</span><br><span class="line">xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$</span><br><span class="line">中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line">双字节字符：[^\x00-\xff]    (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))</span><br><span class="line">空白行的正则表达式：\n\s*\r    (可以用来删除空白行)</span><br><span class="line">HTML标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;.*?&lt;/\1&gt;|&lt;.*? /&gt;    (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line">首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$)    (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line">腾讯QQ号：[1-9][0-9]&#123;4,&#125;    (腾讯QQ号从10000开始)</span><br><span class="line">中国邮政编码：[1-9]\d&#123;5&#125;(?!\d)    (中国邮政编码为6位数字)</span><br><span class="line">IP地址：\d+\.\d+\.\d+\.\d+    (提取IP地址时有用)</span><br><span class="line">IP地址：((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.)&#123;3&#125;(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))</span><br></pre></td></tr></table></figure>
<h2 id="钱的输入格式"><a href="#钱的输入格式" class="headerlink" title="钱的输入格式"></a>钱的输入格式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1.有四种钱的表示形式我们可以接受:&quot;10000.00&quot; 和 &quot;10,000.00&quot;, 和没有 &quot;分&quot; 的 &quot;10000&quot; 和 &quot;10,000&quot;：^[1-9][0-9]*$</span><br><span class="line">2.这表示任意一个不以0开头的数字,但是,这也意味着一个字符&quot;0&quot;不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$</span><br><span class="line">3.一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</span><br><span class="line">4.这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$</span><br><span class="line">5.必须说明的是,小数点后面至少应该有1位数,所以&quot;10.&quot;是不通过的,但是 &quot;10&quot; 和 &quot;10.2&quot; 是通过的：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">7.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">8.1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">备注：这就是最终结果了,别忘了&quot;+&quot;可以用&quot;*&quot;替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/2017-07-17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/17/2017-07-17/" itemprop="url">+a、NaN</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-17T00:00:00+08:00">
                2017-07-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="关于-a"><a href="#关于-a" class="headerlink" title="关于+a"></a>关于+a</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+a是转为number类型，同parseInt(a)</span><br><span class="line">    var a = 1;</span><br><span class="line">    console.log(+a);    //parseInt(a)=1</span><br><span class="line">    console.log(a); //1</span><br></pre></td></tr></table></figure>
<h3 id="NaN"><a href="#NaN" class="headerlink" title="NaN"></a>NaN</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="literal">NaN</span> == <span class="literal">NaN</span>   <span class="comment">//false</span></span><br><span class="line"><span class="literal">NaN</span> === <span class="literal">NaN</span>  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/2017-06-28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/2017-06-28/" itemprop="url">Mac环境变量配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-28T00:00:00+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mac环境变量配置"><a href="#Mac环境变量配置" class="headerlink" title="Mac环境变量配置"></a>Mac环境变量配置</h1><p>mac一般使用<code>bash</code>作为默认shell，如果安装了oh my sh，则默认使用<code>zsh</code>shell。</p>
<h2 id="Mac系统环境变量的加载顺序："><a href="#Mac系统环境变量的加载顺序：" class="headerlink" title="Mac系统环境变量的加载顺序："></a>Mac系统环境变量的加载顺序：</h2><p><code>/etc/profile</code><br><code>/etc/paths</code><br><code>~/.bash_profile</code><br><code>~/.bash_login</code><br><code>~/.profile</code><br><code>~/.bashrc</code></p>
<ul>
<li><code>/etc/profile</code>和<code>/etc/paths</code>是系统级别的，系统启动后就会加载。后面几个是当前用户级的环境变量。</li>
<li>如果<code>~/.bash_profile</code>存在，后面几个文件就会忽略不读，不存在时，才会以此类推读取后面的文件。</li>
<li><code>~/.bashrc</code>没有上述规则，他始终加载，他是在<code>bash shell</code>打开的时候载入的。</li>
</ul>
<h2 id="设置Path的语法"><a href="#设置Path的语法" class="headerlink" title="设置Path的语法"></a>设置Path的语法</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 中间使用冒号分隔</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:&lt;PATH 1&gt;:&lt;PATH 2&gt;:&lt;PATH 3&gt;:------:&lt;PATH N&gt;</span><br></pre></td></tr></table></figure>
<h2 id="全局设置"><a href="#全局设置" class="headerlink" title="全局设置"></a>全局设置</h2><p>下面的几个文件设置是全局的，修改时需要root权限</p>
<ul>
<li><code>/etc/paths</code> （全局建议修改这个文件 ）<br>编辑 paths，将环境变量添加到 paths文件中 ，一行一个路径.</li>
</ul>
<p>/etc/paths 文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/bin</span><br><span class="line">/usr/bin</span><br><span class="line">/bin</span><br><span class="line">/usr/sbin</span><br><span class="line">/sbin</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>/etc/profile</code> （建议不修改这个文件 ）<br>全局（公有）配置，不管是哪个用户，登录时都会读取该文件。</p>
</li>
<li><p><code>/etc/bashrc</code> （一般在这个文件中添加系统级环境变量）<br>全局（公有）配置，bash shell执行时，不管是何种方式，都会读取此文件。</p>
</li>
</ul>
<h2 id="单个用户设置"><a href="#单个用户设置" class="headerlink" title="单个用户设置"></a>单个用户设置</h2><ul>
<li><code>~/.bash_profile</code> （添加用户级环境变量）<br><strong>（注：Linux 里面是 .bashrc 而 Mac 是 .bash_profile）</strong><br>若<code>bash shell</code>是以login方式执行时，才会读取此文件，该文件仅仅执行一次，默认情况下，他设置一些环境变量。<br>设置命令别名</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> ll=’ls -la’</span><br></pre></td></tr></table></figure>
<p>设置环境变量：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/opt/<span class="built_in">local</span>/bin:/opt/<span class="built_in">local</span>/sbin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<p>比如设置<code>ANDROID_HOME</code>到PATH：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ANDROID_HOME=/Users/shaoc/Library/Android/sdk</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ANDROID_HOME</span>/tools:<span class="variable">$ANDROID_HOME</span>/platform-tools:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>~/.bashrc</code> 同上</li>
</ul>
<p>一般重启shell设置就会生效，如果想立刻生效，则可执行下面的语句：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">source</span> 相应的文件</span><br></pre></td></tr></table></figure>
<h2 id="zsh中配置环境变量"><a href="#zsh中配置环境变量" class="headerlink" title="zsh中配置环境变量"></a>zsh中配置环境变量</h2><p>在安装了<code>oh my zsh</code>后， <code>.bash_profile</code> 文件中的环境变量就无法起到作用，因为终端默认启动的是<code>zsh</code>，而不是<code>bash shell</code>，所以无法加载。</p>
<p>解决方法1：</p>
<p>在<code>~/.zshrc</code>配置文件中，增加对<code>.bash_profile</code>的引用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>.bash_profile文件示例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ANDROID_HOME=/Users/pengdan/software/sdk</span><br><span class="line"><span class="built_in">export</span> NDK=/Users/pengdan/software/android-ndk-r10d</span><br><span class="line"><span class="built_in">export</span> GRADLE_HOME=/Users/pengdan/software/gradle-2.4</span><br><span class="line"><span class="built_in">export</span> SUBLIME=/Users/pengdan/home/subin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ANDROID_HOME</span>/tools:<span class="variable">$ANDROID_HOME</span>/platform-tools:<span class="variable">$GRADLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SUBLIME</span>:/usr/<span class="built_in">local</span>/mysql/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/Users/pengdan/software/apache-tomcat-7.0.70/bin</span><br></pre></td></tr></table></figure>
<p>解决方法2:<br>可以使用zsh的方法进行配置：<br>（1）可以直接在<code>~/.zshrc</code>中添加path或者环境变量<br>（2）在目录<code>~/oh-my-zsh/custom</code>文件夹下的任何<code>.zsh</code>文件中的环境变量都将会加载。</p>
<p>.zshrc:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Path to your oh-my-zsh installation.</span></span><br><span class="line"><span class="built_in">export</span> ZSH=/Users/shaoc/.oh-my-zsh</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$ZSH</span>/oh-my-zsh.sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> zshconfig=<span class="string">"vim ~/.zshrc"</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>~/oh-my-zsh/custom/my.zsh:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">alias</span> subl=\<span class="string">''</span>/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl<span class="string">'\'</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/24/2017-05-24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/24/2017-05-24/" itemprop="url">关于Homebrew</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">
                2017-05-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Homebrew介绍"><a href="#Homebrew介绍" class="headerlink" title="Homebrew介绍"></a>Homebrew介绍</h1><p>官网<a href="https://brew.sh/index_zh-cn.html" target="_blank" rel="noopener">https://brew.sh/index_zh-cn.html</a></p>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p><code>Homebrew</code>是macOs下的一个软件包管理器,它是为macOs安装一些Unix上的工具最简单好用灵活的一种方式。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>粘贴下面命令到终端并执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>使用 <code>--verbose</code> 或 <code>-v</code>，很多命令会打印出额外的调试和安装信息</p>
<ul>
<li><code>$ brew --version</code>   查看版本</li>
<li><code>$ brew install formula</code> 安装软件包</li>
<li><code>$ brew uninstall formula</code> 卸载某个软件包</li>
<li><code>$ brew update</code>  更新homebrew到最新版</li>
<li><code>$ brew list</code>  列出所有安装的软件包</li>
<li><code>$ brew search formula</code>  搜索某个软件包</li>
</ul>
<p>更多命令<a href="http://docs.brew.sh/Manpage.html" target="_blank" rel="noopener">http://docs.brew.sh/Manpage.html</a></p>
<h2 id="他能做什么"><a href="#他能做什么" class="headerlink" title="他能做什么"></a>他能做什么</h2><ul>
<li><p>可以使用 <code>Homebrew</code> 安装 Apple 没有预装但你需要的东西，比如</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ brew install wget</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Homebrew</code>会将软件包安装到独立目录，并将其文件软链接至 <code>/usr/local</code> 。</p>
</li>
<li><p><code>Homebrew</code> 不会将文件安装到它本身目录之外，所以您可将 <code>Homebrew</code> 安装到任意位置。</p>
</li>
<li><p>轻松创建你自己的 <code>Homebrew</code> 包。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew create https://foo.com/bar-1.0.tgz</span><br><span class="line">Created /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/bar.rb</span><br></pre></td></tr></table></figure>
</li>
<li><p>完全基于 <code>git</code> 和 <code>ruby</code>，所以自由修改的同时你仍可以轻松撤销你的变更或与上游更新合并。</p>
</li>
<li><p><code>Homebrew</code> 的配方都是简单的 <code>Ruby</code> 脚本：</p>
  <figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wget</span> &lt; Formula</span></span><br><span class="line">  homepage <span class="string">"https://www.gnu.org/software/wget/"</span></span><br><span class="line">  url <span class="string">"https://ftp.gnu.org/gnu/wget/wget-1.15.tar.gz"</span></span><br><span class="line">  sha256 <span class="string">"52126be8cf1bddd7536886e74c053ad7d0ed2aa89b4b630f76785bac21695fcd"</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">install</span></span></span><br><span class="line">    system <span class="string">"./configure"</span>, <span class="string">"--prefix=<span class="subst">#&#123;prefix&#125;</span>"</span></span><br><span class="line">    system <span class="string">"make"</span>, <span class="string">"install"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Homebrew</code> 使 macOS 更完整。使用 <code>gem</code> 来安装 <code>gems</code>、用 <code>brew</code> 来安装那些依赖包。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/26/Cordova中的Config.xml配置文件详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/26/Cordova中的Config.xml配置文件详解/" itemprop="url">Cordova、Config.xml中几个重要配置解释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-26T10:43:15+08:00">
                2017-04-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p><code>Config.xml</code>存储着cordova应用的全局配置信息。</p>
<p>本文重点解释了config.xml中的几个常用配置，比如：<code>access</code> <code>allow-navigation</code> <code>allow-intent</code> 等。</p>
<p>更多信息请查看<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html" target="_blank" rel="noopener">官方参考文档</a>。</p>
<h3 id="widget、name、description、author"><a href="#widget、name、description、author" class="headerlink" title="widget、name、description、author"></a>widget、name、description、author</h3><ul>
<li>widget：<code>config.xml</code>中的根元素</li>
<li>name：指定app名，它会显示在设备的主屏幕上</li>
<li>description：app描述</li>
<li>author：作者信息</li>
</ul>
<h3 id="content"><a href="#content" class="headerlink" title="content"></a>content</h3><p>指定app的根页面，默认是<code>index.html</code><br>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;widget ...&gt;</span><br><span class="line">   &lt;content src=&quot;startPage.html&quot;&gt;&lt;/content&gt;</span><br><span class="line">&lt;/widget&gt;</span><br></pre></td></tr></table></figure>
<h3 id="access"><a href="#access" class="headerlink" title="access"></a>access</h3><p>配置允许app发起的网络请求（images, XHRs, etc）地址</p>
<p>注意：没有配置<code>access</code>标签时，，只有<code>file://</code>urls被允许访问。但一般情况，app包含一个默认的<code>&lt;access origin=&quot;*&quot;&gt;</code>标签。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--允许访问 google.com:--&gt;</span><br><span class="line">&lt;access origin=&quot;http://google.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--允许访问安全地址 google.com (https://):--&gt;</span><br><span class="line">&lt;access origin=&quot;https://google.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--允许访问 google.com 的所有子域名, 比如 mail.google.com and docs.google.com:--&gt;</span><br><span class="line">&lt;access origin=&quot;http://*.google.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--不阻止任何网络请求，比如 google.com and developer.mozilla.org:--&gt;</span><br><span class="line">&lt;access origin=&quot;*&quot; /&gt;</span><br><span class="line">&lt;!--This is the default value for newly created CLI projects.--&gt;</span><br></pre></td></tr></table></figure>
<p>更多请查看<a href="https://cordova.apache.org/docs/en/6.x/reference/cordova-plugin-whitelist/index.html#network-request-whitelist" target="_blank" rel="noopener">network-request-whitelist</a></p>
<h3 id="allow-navigation"><a href="#allow-navigation" class="headerlink" title="allow-navigation"></a>allow-navigation</h3><p>控制内部的<code>WebView</code>可以加载的<code>URL</code>，只适用于顶级导航。</p>
<p>默认情况下，只允许<code>file://</code>类型的URLS访问。如果要加载其他的urls，需要配置<code>&lt;allow-navigation&gt;</code>标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 允许访问 example.com --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;http://example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许使用通配符，协议，主机，地址都可以使用 --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;*://*.example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 使用通配符，允许所有网址访问，包括HTTP and HTTPS and file</span><br><span class="line">     *不推荐使用* --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 上面的和下面这三条等价 --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;http://*/*&quot; /&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;https://*/*&quot; /&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;data:*&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>更多请查看<a href="https://cordova.apache.org/docs/en/6.x/reference/cordova-plugin-whitelist/index.html#navigation-whitelist" target="_blank" rel="noopener">cordova-plugin-whitelist</a></p>
<h3 id="allow-intent"><a href="#allow-intent" class="headerlink" title="allow-intent"></a>allow-intent</h3><p>定义app可以要求操作系统打开的链接地址，默认，任何外部请求链接都被禁止。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 允许在浏览器中打开网址 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;http://*/*&quot; /&gt;</span><br><span class="line">&lt;allow-intent href=&quot;https://*/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在浏览器中打开 example.com --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;http://example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许通配符的使用，在协议、主机、地址 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;*://*.example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在短信应用中打开sms:链接 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;sms:*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在电话应用中打开tel:链接 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;tel:*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在地图应用中打开geo:链接 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;geo:*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在已安装的app中打开未被识别的url地址</span><br><span class="line">     *NOT RECOMMENDED* --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;*&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>查看更多<a href="https://cordova.apache.org/docs/en/6.x/reference/cordova-plugin-whitelist/index.html#intent-whitelist" target="_blank" rel="noopener">cordova-plugin-whitelist</a></p>
<h3 id="engine"><a href="#engine" class="headerlink" title="engine"></a>engine</h3><p>Specifies details about what platform to restore during a prepare.</p>
<h3 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h3><p>Specifies details about what plugin to restore during a prepare. This element is automatically added to a project’s config.xml when a plugin is added using the –save flag.</p>
<h3 id="variable"><a href="#variable" class="headerlink" title="variable"></a>variable</h3><p>Persists the value of a CLI variable to be used when restoring a plugin during a prepare. This element is added to config.xml when a plugin that uses CLI variables is added using the –save flag.</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;plugin name=&quot;cordova-plugin-device&quot; spec=&quot;^1.1.0&quot;&gt;</span><br><span class="line">    &lt;variable name=&quot;MY_VARIABLE&quot; value=&quot;my_variable_value&quot; /&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<h3 id="preference"><a href="#preference" class="headerlink" title="preference"></a>preference</h3><p>Sets various options as pairs of name/value attributes. Each preference’s name is case-insensitive. Many preferences are unique to specific platforms, and will be indicated as such.</p>
<p>配置详情：<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html#preference" target="_blank" rel="noopener">https://cordova.apache.org/docs/en/6.x/config_ref/index.html#preference</a></p>
<h3 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h3><p>If you use the CLI to build applications, you use the plugin command to enable device APIs. This does not modify the top-level config.xml file, so the element does not apply to your workflow. If you work directly in an SDK and using the platform-specific config.xml file as source, you use the tag to enable device-level APIs and external plugins. They often appear with custom values in platform-specific config.xml files. See the API Reference for details on how to specify each feature</p>
<p>更多请参考：<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html#feature" target="_blank" rel="noopener">feature</a></p>
<h3 id="platform"><a href="#platform" class="headerlink" title="platform"></a>platform</h3><p>When using the CLI to build applications, it is sometimes necessary to specify preferences or other elements specific to a particular platform.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;platform name=&quot;android&quot;&gt;</span><br><span class="line">   &lt;preference name=&quot;Fullscreen&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;/platform&gt;</span><br></pre></td></tr></table></figure>
<h3 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h3><p>Represents your custom script which will be called by Cordova when certain action occurs (for example, after plugin is added or platform prepare logic is invoked). This is useful when you need to extend default Cordova functionality. </p>
<p>更多请参考：<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html#hook" target="_blank" rel="noopener">https://cordova.apache.org/docs/en/6.x/config_ref/index.html#hook</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;hook type=&quot;after_plugin_install&quot; src=&quot;scripts/afterPluginInstall.js&quot; /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>date：2017-04-26 10:37:40<br>版本有变化时，配置可能发生变化，详细信息请参考<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html" target="_blank" rel="noopener">官方文档</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/20/Angular-iframe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/20/Angular-iframe/" itemprop="url">Angular - iframe、DomSanitizer模块、单例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-20T14:45:55+08:00">
                2017-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Angular开发中的几个小知识点"><a href="#Angular开发中的几个小知识点" class="headerlink" title="Angular开发中的几个小知识点"></a>Angular开发中的几个小知识点</h1><h2 id="Angular使用iframe加载外部网站"><a href="#Angular使用iframe加载外部网站" class="headerlink" title="Angular使用iframe加载外部网站"></a>Angular使用iframe加载外部网站</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>项目中，需要使用iframe来加载一个外部网页，但src被Angular的默认安全策略所禁止，无法加载网页。</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>在Angular中，可以使用iframe用来加载一个外部链接地址，但是src需要使用<code>@angular/platform-browser</code>中的<code>DomSanitizer模块</code>中的<code>sanitizer.bypassSecurityTrustResourceUrl(url)</code>方法来特殊处理，因为Angular中有默认的安全规则会阻止链接的加载。</p>
<p>一个例子：</p>
<p>html:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--这样无法正常加载网页，被安全策略禁止--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> [<span class="attr">src</span>]=<span class="string">"link"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--需要这样使用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">'MainIframe'</span> [<span class="attr">src</span>]=<span class="string">"trust(link)"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--或直接处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">'MainIframe'</span> [<span class="attr">src</span>]=<span class="string">"sanitizer.bypassSecurityTrustResourceUrl(link)"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ts:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//引入DomSanitizer模块</span></span><br><span class="line"><span class="keyword">import</span> &#123; DomSanitizer &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">link:<span class="built_in">string</span> = <span class="string">'http://www.baidu.com'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> sanitizer: DomSanitizer</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello IframeFull Component'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">trust(url) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.sanitizer.bypassSecurityTrustResourceUrl(url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>测试时间：2017-04-26<br>使用Angular版本： 2.2.1</p>
</blockquote>
<h2 id="Angular单例"><a href="#Angular单例" class="headerlink" title="Angular单例"></a>Angular单例</h2><p>angular2一个单例的写法</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Injectable&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;UserInterface&#125; <span class="keyword">from</span> <span class="string">"../interface/index"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这是一个单例模式的config，用于共享全局变量</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> Config &#123;</span><br><span class="line">    <span class="keyword">public</span> mode = <span class="string">'dev'</span>;                         <span class="comment">//运行模式 dev or release</span></span><br><span class="line">    <span class="comment">//   public hostURL = 'https://cnodejs.org/api/v1';     //http请求前缀</span></span><br><span class="line">    <span class="keyword">public</span> hostURL = <span class="string">'http://ionichina.com/api/v1'</span>;         <span class="comment">//http请求前缀</span></span><br><span class="line">    <span class="comment">// public hostURL = 'http://localhost:8100/api';         //http请求前缀</span></span><br><span class="line">    <span class="keyword">public</span> isIonic = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> pageLimit = <span class="number">15</span>;                       <span class="comment">//每页多少</span></span><br><span class="line">    <span class="keyword">public</span> DRAFTS_URL = <span class="string">'/data/drafts.json'</span>;     <span class="comment">//草稿本地地址</span></span><br><span class="line">    <span class="keyword">public</span> token: <span class="built_in">string</span> = <span class="string">''</span>;                   <span class="comment">//如果已经登录，存放token，请和localstorage.get('token')同步</span></span><br><span class="line">    <span class="keyword">public</span> loginUser: UserInterface;             <span class="comment">//如果已经登录，存放登录用户信息，请和本地存储保持同步</span></span><br><span class="line">    <span class="keyword">static</span> instance: Config;</span><br><span class="line">    <span class="keyword">static</span> isCreating: <span class="built_in">Boolean</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!Config.isCreating) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"You can't call new in Config Singleton instance!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> getInstance() &#123;</span><br><span class="line">        <span class="keyword">if</span> (Config.instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            Config.isCreating = <span class="literal">true</span>;</span><br><span class="line">            Config.instance = <span class="keyword">new</span> Config();</span><br><span class="line">            Config.isCreating = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Config.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ionic2在scss中访问主题颜色"><a href="#ionic2在scss中访问主题颜色" class="headerlink" title="ionic2在scss中访问主题颜色"></a>ionic2在scss中访问主题颜色</h2><p>通过在<code>scss</code>中引用主题颜色，可以增加程序的可维护性，当程序的主题颜色更改时，引用的地方随之自动更改。</p>
<p>使用<code>background-color: map-get($colors, primary)</code>来引用在主题中定义的颜色。</p>
<p>示例：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.progress-inner</span> &#123;</span><br><span class="line">        <span class="attribute">min-width</span>: <span class="number">15%</span>;</span><br><span class="line">        <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">        <span class="attribute">overflow</span>: hidden;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">4px</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">map-get</span>($colors, primary);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/11/Cordova应用中集成Crosswalk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/11/Cordova应用中集成Crosswalk/" itemprop="url">Cordova应用中集成Crosswalk</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-11T15:06:20+08:00">
                2017-04-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在cordova应用中集成crosswalk"><a href="#在cordova应用中集成crosswalk" class="headerlink" title="在cordova应用中集成crosswalk"></a>在cordova应用中集成crosswalk</h1><p><code>Crosswalk</code>是一款开源的Web引擎，其基于 Chromium/Blink 的应用运行环境，对于混合开发的轻量级应用尤为受欢迎。</p>
<p><code>crosswalk</code>是hybrid应用的运行时环境，它用来代替系统自带的<code>webview</code>，以保证应用行为的一致性（css一致，es6支持等），兼容性（完美支持WebRTC，WebAudio，Flexbox布局等）和提高流畅性（相比老旧安卓设备，因为它们自身的webview比较老旧）。</p>
<p>参考链接：<br><a href="https://crosswalk-project.org/" target="_blank" rel="noopener">crosswalk官网</a><br><a href="https://www.npmjs.com/package/cordova-plugin-crosswalk-webview/" target="_blank" rel="noopener">官方npm插件</a><br><a href="https://crosswalk-project.org/documentation/cordova.html" target="_blank" rel="noopener">crosswalk官网 - cordova应用步骤</a></p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li><code>webview</code>不再依赖于安卓版本，因为每个Android版本WebView的表现都有差别，可以最大限度降低Android碎片化的影响，得到一致的，可预测的行为。</li>
<li>兼容性更好，使用最新的Web技术及API，保证WebRTC, WebAudio, Web Components等</li>
<li>性能更好，与旧版本系统的老webview相比</li>
</ul>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>增大内存占用率，增加大约30MB</li>
<li>增大APK包的大小，大约17MB</li>
<li>增加安装后的磁盘占用空间，大约50MB</li>
<li><code>Crosswalk WebView</code>的本地存储(IndexedDB, LocalStorage, etc)和系统webview的相互独立</li>
</ul>
<h3 id="安装crosswalk插件"><a href="#安装crosswalk插件" class="headerlink" title="安装crosswalk插件"></a>安装crosswalk插件</h3><p>ionic2或者cordova应用中安装：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cordova plugin add cordova-plugin-crosswalk-webview --save</span><br></pre></td></tr></table></figure>
<p>构建：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cordova build android</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/29/windows下mongodb的安装和配置记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/29/windows下mongodb的安装和配置记录/" itemprop="url">Windows下MongoDB的安装配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-29T16:20:13+08:00">
                2017-03-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="windows下mongodb的安装配置"><a href="#windows下mongodb的安装配置" class="headerlink" title="windows下mongodb的安装配置"></a>windows下mongodb的安装配置</h1><p>2017年3月29日，系统：win10，mongodb version v3.4.2</p>
<h2 id="下载和安装"><a href="#下载和安装" class="headerlink" title="下载和安装"></a>下载和安装</h2><ol>
<li>下载地址：<a href="https://www.mongodb.com/download-center#community" target="_blank" rel="noopener">https://www.mongodb.com/download-center#community</a></li>
<li>下载符合你系统的版本，然后安装。默认安装到<code>C:\Program Files\MongoDB</code>,你也可以自定义安装目录。</li>
</ol>
<h2 id="创建数据目录"><a href="#创建数据目录" class="headerlink" title="创建数据目录"></a>创建数据目录</h2><p>MongoDB将数据目录存储在 db 目录下。但是这个数据目录不会主动创建，我们在安装完成后需要创建它。</p>
<p>请注意，<strong>数据目录应该放在根目录下</strong>（(如： C:\ 或者 D:\ 等 )。</p>
<p>这里我们假设创建数据目录在<code>E:\data\db</code></p>
<h2 id="命令行运行mogondb服务"><a href="#命令行运行mogondb服务" class="headerlink" title="命令行运行mogondb服务"></a>命令行运行mogondb服务</h2><p>假设你的mongodb安装在<code>C:\Program Files\MongoDB</code>:</p>
<p>进入安装目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Program Files\MongoDB\Server\3.4\bin</span><br></pre></td></tr></table></figure>
<p>启动服务：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongod.exe --dbpath e:\data\db</span><br></pre></td></tr></table></figure>
<h2 id="将MongoDB服务器作为Windows服务运行"><a href="#将MongoDB服务器作为Windows服务运行" class="headerlink" title="将MongoDB服务器作为Windows服务运行"></a>将MongoDB服务器作为Windows服务运行</h2><p>在命令行中启动服务之后，执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongod.exe --logpath <span class="string">"e:\data\dbConf\mongodb.log"</span> --logappend --dbpath <span class="string">"e:/data/db"</span> --port 27017 --serviceName <span class="string">"MongoDB"</span> --install</span><br></pre></td></tr></table></figure>
<p>终止命令行中的mongodb服务，打开刚才新建的mongodb服务：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">NET START MongoDB</span><br></pre></td></tr></table></figure>
<p>如果出现服务器无法正常启动的问题，是因为mongod.lock这个文件，在服务器异常退出时，该文件会影响下一次启动mongod服务的,我们首先关闭命令行mongodb服务，然后只需要删除该文件就行了：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mongod.exe --config e:\data\db\mongod.lock --remove</span><br></pre></td></tr></table></figure>
<blockquote>
<p>windows删除服务命令： <code>sc delete MongoDB</code></p>
</blockquote>
<p>说明：</p>
<p>请注意，你必须有管理权限才能运行下面的命令。执行以下命令将MongoDB服务器作为Windows服务运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongod.exe --bind_ip yourIPadress --logpath <span class="string">"C:\data\dbConf\mongodb.log"</span> --logappend --dbpath <span class="string">"C:\data\db"</span> --port yourPortNumber --serviceName <span class="string">"YourServiceName"</span> --serviceDisplayName <span class="string">"YourServiceName"</span> --install</span><br></pre></td></tr></table></figure>
<p>下表为mongodb启动的参数说明：</p>
<p>参数    描述</p>
<p>–bind_ip    绑定服务IP，若绑定127.0.0.1，则只能本机访问，不指定默认本地所有IP</p>
<p>–logpath    定MongoDB日志文件，注意是指定文件不是目录</p>
<p>–logappend    使用追加的方式写日志</p>
<p>–dbpath    指定数据库路径</p>
<p>–port    指定服务端口号，默认端口27017</p>
<p>–serviceName    指定服务名称</p>
<p>–serviceDisplayName    指定服务名称，有多个mongodb服务时执行。</p>
<p>–install    指定作为一个Windows服务安装。</p>
<h2 id="MongoDB后台管理-Shell"><a href="#MongoDB后台管理-Shell" class="headerlink" title="MongoDB后台管理 Shell"></a>MongoDB后台管理 Shell</h2><p>进入安装目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Program Files\MongoDB\Server\3.4\bin</span><br><span class="line">mongo.exe</span><br></pre></td></tr></table></figure>
<p><code>db</code> 命令用于查看当前操作的文档（数据库）</p>
<p>插入一些简单的记录并查找它：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; db.runoob.insert(&#123;x:10&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)</span><br><span class="line">&gt; db.runoob.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5604ff74a274a611b0c990aa&quot;), &quot;x&quot; : 10 &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文章写于，2017年3月29日，测试环境：mongodb版本 v3.4.2，操作系统win10</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/22/babel-cli入门使用步骤/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/22/babel-cli入门使用步骤/" itemprop="url">babel-cli入门使用步骤</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-22T00:00:00+08:00">
                2017-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h1><h2 id="babel-cli"><a href="#babel-cli" class="headerlink" title="babel-cli"></a>babel-cli</h2><p>项目中遇到了一个es6写的文件代码，在某些老的android设备的webview运行环境中不支持es6，比如<code>class</code>，<code>扩展运算符</code>等，使用这个解决方案：用<code>babel-cli</code>和<code>babel-preset-es2015</code>插件，把代码转为es5的代码。下面是具体步骤：</p>
<h3 id="1-全局安装babel-cli"><a href="#1-全局安装babel-cli" class="headerlink" title="1.全局安装babel-cli"></a>1.全局安装babel-cli</h3><p><code>$ npm install --global babel-cli</code></p>
<p><code>babel</code>提供命令行工具，用来在命令行转码，参考：<a href="http://babeljs.cn/docs/usage/cli/" target="_blank" rel="noopener">官方文档</a></p>
<p>基本用法如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 转码结果输出到标准输出</span></span><br><span class="line">$ babel example.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转码结果写入一个文件</span></span><br><span class="line"><span class="comment"># --out-file 或 -o 参数指定输出文件</span></span><br><span class="line">$ babel example.js --out-file compiled.js</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ babel example.js -o compiled.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># 整个目录转码</span></span><br><span class="line"><span class="comment"># --out-dir 或 -d 参数指定输出目录</span></span><br><span class="line">$ babel src --out-dir lib</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ babel src -d lib</span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 参数生成source map文件</span></span><br><span class="line">$ babel src -d lib -s</span><br></pre></td></tr></table></figure>
<h3 id="2-项目中新建-babelrc-配置文件"><a href="#2-项目中新建-babelrc-配置文件" class="headerlink" title="2.项目中新建.babelrc 配置文件"></a>2.项目中新建.babelrc 配置文件</h3><p><code>.babelrc</code>它是<code>babel</code>的配置文件，存放在项目的根目录下面，用来设置转码规则和插件。基本格式如下：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [</span><br><span class="line">      <span class="string">"es2015"</span>,</span><br><span class="line">      <span class="string">"react"</span>,</span><br><span class="line">      <span class="string">"stage-2"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"plugins"</span>: []</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>presets字段设定<code>转码规则</code>，官方提供以下的规则集，你可以根据需要安装。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ES2015转码规则</span></span><br><span class="line">$ npm install --save-dev babel-preset-es2015</span><br><span class="line"></span><br><span class="line"><span class="comment"># react转码规则</span></span><br><span class="line">$ npm install --save-dev babel-preset-react</span><br><span class="line"></span><br><span class="line"><span class="comment"># ES7不同阶段语法提案的转码规则（共有4个阶段），选装一个</span></span><br><span class="line">$ npm install --save-dev babel-preset-stage-0</span><br><span class="line">$ npm install --save-dev babel-preset-stage-1</span><br><span class="line">$ npm install --save-dev babel-preset-stage-2</span><br><span class="line">$ npm install --save-dev babel-preset-stage-3</span><br></pre></td></tr></table></figure>
<h3 id="3-安装es2015插件"><a href="#3-安装es2015插件" class="headerlink" title="3.安装es2015插件"></a>3.安装es2015插件</h3><p><code>$ npm install --save-dev babel-preset-es2015</code></p>
<p>修改配置文件为：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [</span><br><span class="line">      <span class="string">"es2015"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"plugins"</span>: []</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-在命令行中使用命令转码"><a href="#4-在命令行中使用命令转码" class="headerlink" title="4.在命令行中使用命令转码"></a>4.在命令行中使用命令转码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ babel example.js -o compiled.js</span><br></pre></td></tr></table></figure>
<h2 id="关于babel-node"><a href="#关于babel-node" class="headerlink" title="关于babel-node"></a>关于babel-node</h2><p>babel-cli工具自带一个<code>babel-node</code>命令，提供一个支持ES6的REPL环境。它支持Node的REPL环境的所有功能，而且可以直接运行ES6代码。<br>它不用单独安装，而是随<code>babel-cli</code>一起安装。然后，执行babel-node就进入PEPL环境。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ babel-node</span><br><span class="line">&gt; (x =&gt; x * 2)(1)</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p>babel-node命令可以直接运行ES6脚本。将上面的代码放入脚本文件es6.js，然后直接运行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ babel-node es6.js</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p>babel-node也可以安装在项目中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install --save-dev babel-cli</span><br></pre></td></tr></table></figure>
<p>然后，改写<code>package.json</code>。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"script-name"</span>: <span class="string">"babel-node script.js"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码中，使用babel-node替代node，这样script.js本身就不用做任何转码处理。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/22/ES6中5种遍历对象属性的方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/22/ES6中5种遍历对象属性的方法/" itemprop="url">ES6中5种遍历对象属性的方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-22T00:00:00+08:00">
                2017-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ES6中5种遍历对象属性的方法"><a href="#ES6中5种遍历对象属性的方法" class="headerlink" title="ES6中5种遍历对象属性的方法"></a>ES6中5种遍历对象属性的方法</h1><h3 id="5种遍历对象属性的方法："><a href="#5种遍历对象属性的方法：" class="headerlink" title="5种遍历对象属性的方法："></a>5种遍历对象属性的方法：</h3><ul>
<li><p>for…in<br><code>for...in</code>循环遍历自身的和继承的可枚举属性（不含Symbol属性）</p>
</li>
<li><p>Object.keys(obj)<br><code>Object.keys(obj)</code>返回一个数组，包括对象自身的（不含继承）所有可枚举属性（不含Symbol属性）</p>
</li>
<li><p>Object.getOwnPropertyNames(obj)<br><code>Object.getOwnPropertyNames(obj)</code>返回一个数组，包括对象自身（不含继承）所有属性（包括不可枚举的属性，不含Symbol属性）</p>
</li>
<li><p>Object.getOwnPropertySymbols(obj)<br><code>Object.getOwnPropertySymbols(obj)</code>返回一个数组，包括对象自身所有的Symbol属性</p>
</li>
<li><p>Reflect.ownKeys(obj)<br><code>Reflect.ownKeys(obj)</code>返回一个数组，包含对象自身的所有属性，不管属性名是Symbol或字符串，也不管是否可枚举</p>
</li>
</ul>
<p>###通过比较，可以得到结论：</p>
<ol>
<li>要想获得对象自身和它所继承的属性（可枚举的），必须用<code>for...in</code>，其它只与对象自身有关。</li>
<li><code>Object.keys(obj)</code>返回自身的<strong>可枚举属性</strong>。</li>
<li><code>Object.getOwnPropertyNames(obj)</code>比<code>Object.keys(obj)</code>多包含了对象自身的不可枚举属性。</li>
<li><code>Reflect.ownKeys(obj)</code>的返回结果是<code>Object.getOwnPropertyNames(obj)</code>和<code>Object.getOwnPropertySymbols(obj)</code>的合集。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/07/RxJs常用Operator记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/07/RxJs常用Operator记录/" itemprop="url">RxJs常用Operator记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-07T00:00:00+08:00">
                2017-03-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="RxJs中的operator"><a href="#RxJs中的operator" class="headerlink" title="RxJs中的operator"></a>RxJs中的operator</h1><h2 id="创建操作符"><a href="#创建操作符" class="headerlink" title="创建操作符"></a>创建操作符</h2><p>常见的有<code>Observable.forEvent()</code>,  <code>Observable.create()</code>, <code>Observable.interval()</code>。</p>
<h3 id="create"><a href="#create" class="headerlink" title="create"></a>create</h3><p><code>Observable.create()</code>：自定义创建一个<code>observable</code></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;Observable&#125; = <span class="built_in">require</span>(<span class="string">'rxjs/Observable'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/observable/of'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/operator/map'</span>);</span><br><span class="line"><span class="comment">//create创建操作符</span></span><br><span class="line"><span class="keyword">let</span> observable = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    observer.next(<span class="number">3</span>);</span><br><span class="line">    observer.next(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">observable.subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="interval"><a href="#interval" class="headerlink" title="interval"></a>interval</h3><p><code>interval(time:number)</code>:创建一个递增序列，每隔指定时间发送一条数据</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = Rx.Observable.interval(<span class="number">1000</span>);</span><br><span class="line">numbers.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));  <span class="comment">// 0 1 2 3 4 5 6 ......</span></span><br></pre></td></tr></table></figure>
<h3 id="of"><a href="#of" class="headerlink" title="of"></a>of</h3><p><code>public static of(values: ...T, scheduler: Scheduler): Observable&lt;T&gt;</code>: 从数组创建一个序列，一次将数据发射出去，然后发射完成命令</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = Rx.Observable.of(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">var</span> letters = Rx.Observable.of(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>);</span><br><span class="line"><span class="keyword">var</span> result = numbers.concat(letters);</span><br><span class="line">result.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));  <span class="comment">//10 20 30 a b c</span></span><br></pre></td></tr></table></figure>
<h2 id="变换操作符"><a href="#变换操作符" class="headerlink" title="变换操作符"></a>变换操作符</h2><p>对每一次返回数据做一次变换操作，把原本的数据流变成需要的数据流，最常使用的变换操作是<code>observable.map()</code></p>
<p>比如，数据获取接口经常会有一些规范去包裹数据，比如</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;err_code&quot;:0,</span><br><span class="line">    &quot;data&quot;:&#123;&quot;name&quot;:&quot;Operators&quot;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们只需要data字段，就可以使用map来实现：</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">observable.map(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.data;</span><br><span class="line">&#125;).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//do sth with data</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="过滤操作符filter"><a href="#过滤操作符filter" class="headerlink" title="过滤操作符filter"></a>过滤操作符filter</h2><p>用于过滤掉数据流中一些不需要处理的数据，常用的是<code>observable.filter()</code><br>比如，前端获取数据的时候，接口可能会因为各种原因无法返回最终需要的数据，可能由于异常返回的数据为空，或者返回一个错误代码和错误描述告知前端，但是并不需要处理这些错误信息，就需要过滤掉这些错误数据。</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//过滤操作符</span></span><br><span class="line">observable.filter(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !!response.data &amp;&amp; response.status === <span class="number">200</span>;</span><br><span class="line">&#125;).map(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> response.data;</span><br><span class="line">&#125;).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//do sth with data</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="组合操作符"><a href="#组合操作符" class="headerlink" title="组合操作符"></a>组合操作符</h2><p>很多业务场景需要依赖两个甚至更多的接口数据，并且在这些接口数据都成功获取后，再进行关联合并。要满足这种场景，就需要把各个数据流汇汇合组成新的数据流，这时就要用到<code>组合操作符</code>，比如<code>Observable.forkJoin()</code>,<code>Observable.prototype.concatMap()</code></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//组合操作符 Observable.forkJoin</span></span><br><span class="line"><span class="keyword">let</span> getFirstDataObs = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    observer.next(<span class="string">'a1'</span>);</span><br><span class="line">    observer.next(<span class="string">'a2'</span>);</span><br><span class="line">    observer.complete();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> getSecondDataObs = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    observer.next(<span class="string">'b1'</span>);</span><br><span class="line">    observer.next(<span class="string">'b2'</span>);</span><br><span class="line">    observer.complete();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> joinedObservable = Observable.forkJoin(</span><br><span class="line">    getFirstDataObs, getSecondDataObs</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">joinedObservable.subscribe(<span class="function"><span class="params">datas</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//data[0] 是getFirstDataObs 的数据</span></span><br><span class="line">    <span class="comment">//data[1] 是getSecondDataObs 的数据</span></span><br><span class="line">    <span class="comment">//只有在他两个都执行complete()之后，才会返回数据，且返回最后发送的数据</span></span><br><span class="line">    <span class="built_in">console</span>.log(datas);  <span class="comment">//[ 'a2', 'b2' ]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果某次请求数据需要依赖前一次请求的结果，也就是说两次请求必须有先后顺序，这时候可以使用<code>Observalbe.prototype.concatMap()</code>,示例：</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//concatMap</span></span><br><span class="line"><span class="keyword">let</span> getFirstDataObs = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.next(<span class="number">1</span>);&#125;, <span class="number">500</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.next(<span class="number">2</span>);&#125;, <span class="number">1000</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.next(<span class="number">3</span>);&#125;, <span class="number">1500</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.complete();&#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> createSecondDataObs  = <span class="function">(<span class="params">firstData</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">        observer.next(firstData*<span class="number">10</span>+<span class="number">1</span>);</span><br><span class="line">        observer.next(firstData*<span class="number">10</span>+<span class="number">2</span>);</span><br><span class="line">        observer.next(firstData*<span class="number">10</span>+<span class="number">3</span>);</span><br><span class="line">        observer.complete();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> concatedObs = getFirstDataObs.concatMap(<span class="function"><span class="params">firstData</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createSecondDataObs(firstData);</span><br><span class="line">&#125;).subscribe(<span class="function"><span class="params">secondData</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//do sth with second data</span></span><br><span class="line">    <span class="built_in">console</span>.log(secondData); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>结果输出：<code>11 12 13 21 22 23 31 32 33</code></p>
<p>通过<code>Observable.prototype.concatMap()</code>方法，<code>getSecondDataObs()</code>的数据流被紧接在<code>getFirstDataObs()</code>的数据流后，并且最终被数据流被subscribe()所捕获。</p>
<h2 id="工具操作符"><a href="#工具操作符" class="headerlink" title="工具操作符"></a>工具操作符</h2><p>在Observable.prototype中有很多有用的工具方法，统称为工具操作符，如<code>delay</code>,<code>timeout</code>,<code>debounce</code>,<code>take</code>,<code>takeUntil</code>,<code>takeLast</code>,<code>takeWhile</code>,<code>skip</code>等等</p>
<h3 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h3><p><code>timeout</code>:当observable在指定时间内数据没有完全返回时，发出一个错误</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//工具操作符timeout</span></span><br><span class="line"><span class="keyword">let</span> observable = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">   observer.next(<span class="number">3</span>);</span><br><span class="line">   setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       observer.complete();</span><br><span class="line">   &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">observable.timeout(<span class="number">2000</span>).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">   <span class="comment">//do sth with data</span></span><br><span class="line">   <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;,<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">   handleError(err);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//当observable超过2000ms没有返回全部数据流（即返回complete时），便会抛出一个err错误，被handleError捕获。</span></span><br></pre></td></tr></table></figure>
<h3 id="delay"><a href="#delay" class="headerlink" title="delay"></a>delay</h3><p><code>delay</code>: 返回一个新序列，但是每个序列数据延迟指定时间<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-delay.png" alt="delay"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//延迟1000ms</span></span><br><span class="line">observable.delay(<span class="number">1000</span>).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="debounceTime"><a href="#debounceTime" class="headerlink" title="debounceTime"></a>debounceTime</h3><p><code>public debounceTime(time: number)</code>: 和<code>delay</code>一样，也会延迟发送数据，但仅发送这一段时间内最新的<strong>一条</strong>消息，如果原序列在这段时间内没有发送消息，就不发送。比如可以用在，前台界面搜索框延迟500ms后自动发起api请求进行查询，或后台数据返回的太过频繁。<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-debounceTime-1.png" alt="debounceTime"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Observable.fromEvent(inputSelector,<span class="string">'keyup'</span>)</span><br><span class="line">    .debounceTime(<span class="number">500</span>)</span><br><span class="line">    .switchMap(<span class="function"><span class="params">event</span>=&gt;</span>getValue(event.target.value))</span><br><span class="line">    .subscribe(callback);</span><br></pre></td></tr></table></figure>
<h3 id="debounce"><a href="#debounce" class="headerlink" title="debounce"></a>debounce</h3><p><code>public debounce(durationSelector: function(value: T): SubscribableOrPromise): Observable</code>：和<code>debounceTime</code>类似，但它的发送时机不是由延迟时间决定，而是由另一个<code>observable</code>决定,</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="built_in">document</span>, <span class="string">'click'</span>);</span><br><span class="line"><span class="keyword">var</span> result = clicks.debounce(<span class="function"><span class="params">()</span> =&gt;</span> Rx.Observable.interval(<span class="number">1000</span>));</span><br><span class="line">result.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>
<h3 id="take"><a href="#take" class="headerlink" title="take"></a>take</h3><p><code>public take(count:number)</code>: 挑选出指定的前几个数据，作为新的序列，并complete<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-take.png" alt="take"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> interval = Rx.Observable.interval(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">var</span> five = interval.take(<span class="number">5</span>);  <span class="comment">//取出前5个数据</span></span><br><span class="line">five.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x)); <span class="comment">//0 1 2 3 4</span></span><br><span class="line"><span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### takeLast</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>takeLast(count:<span class="built_in">number</span>)<span class="string">`：挑选出原序列的最后count个数据，在complete时一起发送出去</span></span><br><span class="line"><span class="string">![takeLast](http://ol1ftyec4.bkt.clouddn.com/2017-03-07-takeLast.png)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>ts</span><br><span class="line"><span class="keyword">let</span> interval = Rx.Observable.interval(<span class="number">1000</span>).take(<span class="number">5</span>);</span><br><span class="line">five.takeLast(<span class="number">2</span>).subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x)); <span class="comment">//挑选出最后2个，打印：3 4</span></span><br></pre></td></tr></table></figure>
<h3 id="takeUntil"><a href="#takeUntil" class="headerlink" title="takeUntil"></a>takeUntil</h3><p><code>public takeUntil(notifier: Observable): Observable&lt;T&gt;</code>： 筛选原序列中数据，直到notifier发射出一个数据为止.(Lets values pass until a second Observable, notifier, emits something. Then, it completes.)</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> interval = Rx.Observable.interval(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="built_in">document</span>, <span class="string">'click'</span>);</span><br><span class="line"><span class="keyword">var</span> result = interval.takeUntil(clicks);  <span class="comment">//一直从原序列中取数据，直到点击事件发生为止</span></span><br><span class="line">result.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>
<h3 id="takeWhile"><a href="#takeWhile" class="headerlink" title="takeWhile"></a>takeWhile</h3><p><code>public takeWhile(predicate: function(value: T, index: number): boolean): Observable&lt;T&gt;</code> ：满足某个条件时不再从原序列中取数据<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-takeWhile.png" alt="takeWhile"></p>
<h3 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h3><p><code>public skip(count: Number): Observable</code>：跳过序列中的前<code>count</code>个数据</p>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-skip.png" alt="skip"></p>
<h3 id="switchMap"><a href="#switchMap" class="headerlink" title="switchMap"></a>switchMap</h3><p><code>public switchMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code>: 将原序列某个数据转换为另一个observable的若干个序列数据，当元序列有新数据到来时，会截断旧数据</p>
<p><a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-switchMap" target="_blank" rel="noopener">switchMap官方说明</a></p>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-08-switchMap.png" alt="switchMap"></p>
<h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/03/JavaScript响应式编程 - RxJs入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/03/JavaScript响应式编程 - RxJs入门/" itemprop="url">JavaScript响应式编程 - RxJs入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-03T16:13:48+08:00">
                2017-03-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在angular2项目的过程中，接触到了Rxjs这个东西，对它进行了一下简单的了解，对它的基本用法进行了学习和总结，介绍了：</p>
<ul>
<li>基本概念</li>
<li>如何创建一个Observerble可观察序列</li>
<li>Observer实例的生命周期</li>
<li>如何对Observer实例进行订阅？以及监听他的next、error、complete事件？</li>
<li>rxjs交互图怎么看？</li>
<li>map、filter、from等简单的操作符含义</li>
</ul>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p>官方文档：<a href="http://reactivex.io/rxjs/" target="_blank" rel="noopener">http://reactivex.io/rxjs/</a></p>
<p><code>Rx</code>（<code>ReactiveX</code>, <code>Reactive Extensions</code>）,它是微软开发和维护的基于<code>响应式编程</code>（<code>Reactive Programming</code>）范式实现的一套工具库集合，于2012年11月开源，它提供了一系列接口规范来帮助开发者方便的处理异步数据流。Rx系列结合了观察者模式、迭代器模式、函数式编程，它已成为业界响应式编程的优秀实践。</p>
<p><code>RxJs</code>就是Rx在JavaScript层面上的实现，除此之外还有RxJava、Rx.Net、RxSwift等等。</p>
<p><code>RxJs</code>全名<code>Reactive Extensions for JavaScript</code>，翻译为<code>Javascript的响应式扩展</code>, 它的思路是把随时间不断变化的数据、状态、事件等等转成可被观察的序列(<code>Observable Sequence</code>)，然后订阅序列中那些Observable对象的变化，一旦变化，就会执行事先安排好的各种转换和操作。</p>
<h2 id="几个名词"><a href="#几个名词" class="headerlink" title="几个名词"></a>几个名词</h2><p><code>Observable</code>: <code>可观察的数据序列</code>.<br><code>Observer</code>: <code>观察者实例</code>，用来决定何时观察指定数据，只有在Rx.Observable.create创建方法可以获取<br><code>Subscription</code>: 观察数据序列返回的<code>订阅实例</code>.<br><code>Operators</code>: <code>Observable的操作符</code>，包括转换数据序列，过滤等，所有的Operators方法接受的参数是上一次发送的数据变更的值，而方法返回值我们称之为发射新数据变更</p>
<p><code>Observable</code>可以发射三种类型的事件：<code>next</code>、<code>error</code>、<code>complete</code><br><code>Subscription</code>可以订阅三种类型的事件：<code>onNext</code> <code>onError</code> <code>onComplete</code><br><code>Observable</code>有四个生命周期：创建 、订阅 、 执行 、销毁。</p>
<h2 id="使用create创建一个Observable"><a href="#使用create创建一个Observable" class="headerlink" title="使用create创建一个Observable"></a>使用create创建一个Observable</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Rx = <span class="built_in">require</span>(<span class="string">'rxjs/Rx'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;Observable&#125; = <span class="built_in">require</span>(<span class="string">'rxjs/Observable'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/observable/of'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/operator/map'</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//创建序列源</span></span><br><span class="line"><span class="keyword">const</span> source = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    observer.next(<span class="string">'foo'</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> observer.next(<span class="string">'bar'</span>), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//订阅</span></span><br><span class="line"><span class="keyword">const</span> subscription = source.subscribe(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data));</span><br></pre></td></tr></table></figure>
<h2 id="捕获error和complete"><a href="#捕获error和complete" class="headerlink" title="捕获error和complete"></a>捕获error和complete</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> source = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    observer.next(<span class="string">'foo'</span>);                         <span class="comment">//发射数据</span></span><br><span class="line">    observer.error(<span class="string">'my error'</span>);                   <span class="comment">//发射错误</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> observer.next(<span class="string">'bar'</span>), <span class="number">1000</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>observer.complete(),<span class="number">2000</span>);     <span class="comment">//发射完成</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> source1 = source.map(<span class="function"><span class="params">e</span>=&gt;</span><span class="string">`hello <span class="subst">$&#123;e&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription = source1</span><br><span class="line">    .subscribe(</span><br><span class="line">        data=&gt;<span class="built_in">console</span>.log(data),</span><br><span class="line">        error=&gt;<span class="built_in">console</span>.log(error),</span><br><span class="line">        ()=&gt;<span class="built_in">console</span>.log(<span class="string">'complete'</span>)</span><br><span class="line">        );</span><br></pre></td></tr></table></figure>
<h2 id="rxjs交互图"><a href="#rxjs交互图" class="headerlink" title="rxjs交互图"></a>rxjs交互图</h2><ul>
<li>每条线表示一个数据序列</li>
<li>每个球表示发送的数据变更，小竖线表示complete</li>
<li>方法下面表示经过map、filter等操作符处理过后产生的新序列</li>
</ul>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-03%2014.23.49.png" alt="屏幕快照 2017-03-03 14.23.49"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//序列1</span></span><br><span class="line"><span class="keyword">let</span> source = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    observer.next(<span class="number">1</span>);</span><br><span class="line">    observer.next(<span class="number">2</span>);</span><br><span class="line">    observer.next(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//序列2</span></span><br><span class="line"><span class="keyword">let</span> source2 = source.map(<span class="function"><span class="params">e</span>=&gt;</span>e=e*<span class="number">10</span>);</span><br><span class="line"><span class="comment">//订阅序列1</span></span><br><span class="line">source.subscribe(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data));</span><br><span class="line"><span class="comment">//订阅序列2</span></span><br><span class="line">source2.subscribe(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data));</span><br></pre></td></tr></table></figure>
<h2 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h2><p><code>map</code>：对要发送的data作统一处理后再返回<br><code>filter</code>：满足条件时才发射出去<br><code>toPromise</code>：将observer转为promise<br><code>debounce</code>：（防抖动）取一段时间内最新的数据<br><code>throttle</code>：(防抖动) 忽略这段时间，发现新值后再发送</p>
<p>更多，如 mapTo, scan, from ,concat, concatAll, merge, mergeAll等</p>
<h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>angular2中的HTTP模块，ionic-native中的BLE模块都默认使用了<code>Observable</code></p>
<p>还需要要研究：</p>
<ul>
<li>他的使用场景？</li>
<li>与promise相比他的优势劣势是什么？</li>
<li>未来的使用趋势如何？</li>
</ul>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p>官方文档：<a href="http://reactivex.io/rxjs/" target="_blank" rel="noopener">http://reactivex.io/rxjs/</a></p>
<p><a href="https://yq.aliyun.com/articles/65027" target="_blank" rel="noopener">rxjs简单入门</a></p>
<p><a href="http://www.oschina.net/translate/rxjs-streams?lang=chs&amp;page=1#" target="_blank" rel="noopener">使用 RxJS 实现 JavaScript 的 Reactive 编程</a></p>
<p><a href="https://dzone.com/refcardz/rxjs-streams" target="_blank" rel="noopener">Reactive Programming in JavaScript With RxJS</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/27/对node事件循环机制中Macrotask和Microtask的理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/27/对node事件循环机制中Macrotask和Microtask的理解/" itemprop="url">对node事件循环机制中Macrotask和Microtask的理解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-27T10:38:23+08:00">
                2017-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="node事件循环机制中的Microtask和Macrotask"><a href="#node事件循环机制中的Microtask和Macrotask" class="headerlink" title="node事件循环机制中的Microtask和Macrotask?"></a>node事件循环机制中的<code>Microtask</code>和<code>Macrotask</code>?</h2><h3 id="他是什么？"><a href="#他是什么？" class="headerlink" title="他是什么？"></a>他是什么？</h3><p>在Nodejs事件循环机制中，有任务两个队列：<code>Macrotask队列</code>和<code>Microtask队列</code>。在一个事件循环里，这两个队列会分两步执行，第一步会固定地执行一个（且仅一个）Macrotask任务，第二步会执行整个Microtask队列中的所有任务。并且，在执行Microtask队列任务的时候，也允许加入新的Microtask任务，直到所有Microtask任务全部执行完毕，才会结束循环。</p>
<p>Macrotasks一般包括: <code>setTimeout</code>, <code>setInterval</code>, <code>setImmediate</code>, <code>I/O</code>, <code>UI rendering</code>；<br>Microtasks一般包括: <code>process.nextTick</code>, <code>Promises</code>, <code>Object.observe</code>, <code>MutationObserver</code>。</p>
<h3 id="node事件循环机制详解"><a href="#node事件循环机制详解" class="headerlink" title="node事件循环机制详解"></a>node事件循环机制详解</h3><p>从一个事件循环开始，到结束会经历以下步骤：</p>
<ol>
<li>检查Macrotask队列，选择其中最早加入（即最老的）的任务X，设置为“目前运行的任务”。如果任务X不存在，那么直接跳到步骤4。</li>
<li>运行任务X，即运行对应的回调函数。</li>
<li>设置“目前运行的任务”为null，从Macrotask队列中移除任务X。</li>
<li><p>检查Microtask队列：</p>
<ol>
<li>选择其中最老的任务a，如果任务a不存在，直接结束Microtask队列。</li>
<li>设置任务a为“目前运行的任务”，并执行。</li>
<li>设置“目前运行的任务”为null，从Microtask队列中移除任务a。</li>
<li>选择下一个最老的任务b，跳到步骤2）。</li>
<li>直到队列里没有剩余的任务，结束队列。</li>
</ol>
</li>
<li>跳回步骤1，检查下一个Macrotask任务。</li>
</ol>
<h3 id="如何选用Macrotask或Microtask呢？"><a href="#如何选用Macrotask或Microtask呢？" class="headerlink" title="如何选用Macrotask或Microtask呢？"></a>如何选用Macrotask或Microtask呢？</h3><p><strong><em>如果你想让一个任务立即执行，那么就把它设置为Microtask，除此之外都用Macrotask比较好。</em></strong></p>
<p>因为可以看出，虽然Node是异步非阻塞的，但<strong>在一个事件循环中，Microtask的执行方式基本上就是用同步的</strong>。</p>
<h3 id="有什么问题？"><a href="#有什么问题？" class="headerlink" title="有什么问题？"></a>有什么问题？</h3><p>如果<code>Microtask</code>任务列表太长，或不断加入新的<code>Microtask</code>，就会导致下一个<code>Macrotask</code>任务很久得不到执行，可能导致UI一直无法刷新或IO无法完成。</p>
<p>应该是考虑到了这一点，至少Microtask任务中的<code>process.nextTick</code>任务，是被设置了（在一个事件循环中的）最大调用次数的，叫<code>process.maxTickDepth</code>，默认是1000。一定程度上避免了上述情况。</p>
<h3 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h3><p><a href="https://segmentfault.com/a/1190000007710772" target="_blank" rel="noopener">Node.js事件循环中的：Macrotask 与 Microtask</a></p>
<p><a href="https://segmentfault.com/a/1190000002914296" target="_blank" rel="noopener">Node.js事件驱动实现概览</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/27/js面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/27/js面试题/" itemprop="url">函数闭包、IIFE、JS解释器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-27T09:53:44+08:00">
                2017-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在掘金上看到了篇文章，里面讲了几个js代码片段，觉得很有意思，其中考察了关于<code>setTimeout</code>、<code>函数闭包</code>、<code>IIFE（立即执行函数表达式）</code>、<code>promise</code>、<code>js解释器</code>等概念的理解</p>
<p>A：下面的程序输出啥？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：没有坑，别想多了。输出<code>0 1 2 3 4</code></p>
<p>A：恩，那下面这个呢？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;, <span class="number">1000</span>*i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：<code>settimeout</code>时间到后，会在下一个tick中执行程序，所以程序打印的时候，i已经变成5了，输出<code>5 5 5 5 5</code>。</p>
<p>A：不错，那我想输出的结果是<code>0 1 2 3 4</code>，应该怎么办呢？</p>
<p>我：用闭包就解决了，如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;, <span class="number">1000</span>*i);</span><br><span class="line">    &#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为函数作用域内，保存着对于变量i的引用，故函数执行的时候仍能访问到当初的i。</p>
<p>A：很好。那如果去掉参数i呢？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;, <span class="number">1000</span>*i);</span><br><span class="line">    &#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：这样的话，函数闭包内没有存储对i保持引用，所以输出结果又会变成<code>5 5 5 5 5</code></p>
<p>A： 对。那我再给你改一下程序，你看看输出啥？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//给setTimeout传递一个立即执行函数 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">     setTimeout((<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(i);</span><br><span class="line">     &#125;)(i), <span class="number">1000</span>*i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：这里给<code>setTimeout</code>传递的是一个立即执行函数表达式，它会马上运行，执行结果是<code>undefined</code>，所以<code>setTimeout</code>输出0之后，应该会报错吧，因为参数传递不对，应该接受一个函数类型的参数。</p>
<p>上面的代码差不多等于：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//其实等价于</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">     setTimeout(<span class="literal">undefined</span>, <span class="number">1000</span>*i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A：恩！再看下面的这个程序输出什么？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> <span class="title">executor</span>(<span class="params">resolve</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10000</span>;i++)&#123;</span><br><span class="line">        i == <span class="number">9999</span> &amp;&amp; resolve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>我：思考半天…，应该输出<code>2 3 5 4 1</code>。这个题目是关于js解释器理解的。<code>setTimeout</code>中的函数会在下一个时钟周期运行，肯定比较靠后。<code>2，3</code>在立即执行函数中，所以他会立马打印。<code>4</code>在<code>then</code>中输出，它会放在当前周期的最后执行。最后<code>5</code>会立马打印。所以会这样<code>2 3 5 4 1</code>。</p>
<p>疑问：关于setTimeout和promise.then执行先后的问题，上网找了一下原因，setTimeout属于<code>Macrotask</code>，而promise属于<code>Microtask</code>，<code>Microtask</code>在当前周期队列执行，<code>Macrotask</code>在下一周期执行。</p>
<p>参考自：<a href="https://gold.xitu.io/entry/58b21e6c570c3500692805f1" target="_blank" rel="noopener">Excuse me？这个前端面试在搞事！</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/24/node版本管理 n和nvm说明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/24/node版本管理 n和nvm说明/" itemprop="url">node版本管理 n和nvm说明</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-24T10:33:54+08:00">
                2017-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>项目中我们有时需要使用不同版本 的node来调试或测试程序，最本的方法当然是手动下载不同的版本，并卸载之前的版本，这样可以达到目的，但是无疑是麻烦时间的，在node中有“node版本管理器”来实现类似的功能需要。这里介绍比较流行的两个，“<code>n</code>”和“<code>nvm</code>”.<br>先说说n。<br>n是node一个模块，可以用来管理和切换node版本，其作者是TJ Holowaychuk（出名的Express框架作者），使用非常之简单。<br>安装 方法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo npm install -g n</span><br></pre></td></tr></table></figure>
<p>常用命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$n</span> //查看已安装版本  </span><br><span class="line"><span class="variable">$n</span> latest  //安装最新版本并使用  </span><br><span class="line"><span class="variable">$n</span> latest -d   //下载最新版但不使用，-d参数表示为仅下载  </span><br><span class="line"><span class="variable">$n</span> stable  //安装最新稳定版本并使用  </span><br><span class="line"><span class="variable">$n</span> &lt;version&gt;  //安装某个版本并使用，如<span class="variable">$n</span> 6.2.2  </span><br><span class="line"><span class="variable">$n</span> rm &lt;version ...&gt; //删除某些版本  </span><br><span class="line"><span class="variable">$n</span> ls    //查看可用版本  </span><br><span class="line"><span class="variable">$n</span> --latest    //查看最新版本  </span><br><span class="line"><span class="variable">$n</span> --stable    //查看最新稳定版  </span><br><span class="line"><span class="variable">$n</span> -h    //查看帮助信息，更多命令在这里查看  </span><br><span class="line">[plain] view plain copy <span class="built_in">print</span>?在CODE上查看代码片派生到我的代码片</span><br><span class="line">$ n use 0.10.21 some.js   //&lt;span style=<span class="string">"font-family: Arial, Helvetica, sans-serif;"</span>&gt;以指定的版本来执行脚本&lt;/span&gt;</span><br></pre></td></tr></table></figure>
<p>下面说说<code>nvm</code>。<br>问题来了，既然有这么简单好用的n，那么nvm为什么还会大肆流行呢？这个问题一会回答，先说说nvm。<br>nvm全称Node Version Manager，不同于 n，nvm 不是一个 npm package，而是一个独立软件包。这意味着我们需要单独使用它的安装逻辑：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ wget -qO- https://raw.github.com/creationix/nvm/v0.4.0/install.sh | sh </span><br><span class="line">``` </span><br><span class="line">独立的安装包，因此当你机器上没有安装node时仍可以使用它。</span><br><span class="line">常用命令：</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">$ nvm install 0.10    </span><br><span class="line">$ nvm use 0.10         //使用指定的版本   </span><br><span class="line">$ nvm ls               //查看当前已经安装的版本  </span><br><span class="line">.nvm  </span><br><span class="line">-&gt;  v0.10.24  </span><br><span class="line">$ nvm current         //查看正在使用的版本  </span><br><span class="line">v0.10.24  </span><br><span class="line">$ nvm run 0.10.24 myApp.js      //以指定版本执行脚本  </span><br><span class="line">$ rm -rf ~/.nvm     //卸载nvm</span><br></pre></td></tr></table></figure>
<p>对比说明：<br>我们在使用 n 管理 node 版本前，首先需要一个 node 环境。我们或者用 Homebrew 来安装一个 node，或者从官网下载 pkg 来安装，总之我们得先自己装一个 node —— n 本身是没法给你装的。<br>然后我们可以使用 n 来安装不同版本的 node。<br>在安装的时候，n 会先将指定版本的 node 存储下来，然后将其复制到我们熟知的路径 /usr/local/bin，非常简单明了。当然由于 n 会操作到非用户目录，所以需要加 sudo 来执行命令。<br>两者区别:<br>安装简易度。nvm 安装起来显然是要麻烦不少；n 这种安装方式更符合 node 的惯性思维。见仁见智吧。<br>系统支持。注意， nvm 不支持 Windows。<br>对全局模块的管理。n 对全局模块毫无作为，因此有可能在切换了 node 版本后发生全局模块执行出错的问题；nvm 的全局模块存在于各自版本的沙箱中，切换版本后需要重新安装，不同版本间也不存在任何冲突。<br>关于 node 路径。n 是万年不变的 /usr/local/bin；nvm 需要手动指定路径。</p>
<p>参考地址：<br><a href="http://taobaofed.org/blog/2015/11/17/nvm-or-n/" target="_blank" rel="noopener">http://taobaofed.org/blog/2015/11/17/nvm-or-n/</a>     管理 node 版本，选择 nvm 还是 n？<br><a href="http://it.taocms.org/03/3079.htm" target="_blank" rel="noopener">http://it.taocms.org/03/3079.htm</a>      利用n和nvm管理Node的版本</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/22/Angular笔记 - 属性型指令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/22/Angular笔记 - 属性型指令/" itemprop="url">Angular笔记 - 属性型指令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-22T16:52:47+08:00">
                2017-02-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>属性型指令用于改变DOM元素的外观或行为。</p>
<p>在Angular中有三种类型的指令：</p>
<ol>
<li>组件 — 拥有模板的指令</li>
<li>属性型指令 — 改变元素外观或行为，例如内置的 <code>NgStyle</code> 指令可以同时修改元素的多个样式</li>
<li>结构型指令 — 通过添加和移除dom元素改变视图结构，例如，<code>NgFor</code> 和 <code>NgIf</code>。</li>
</ol>
<h2 id="一个简单的属性型指令"><a href="#一个简单的属性型指令" class="headerlink" title="一个简单的属性型指令"></a>一个简单的属性型指令</h2><p>我们这里实现了一个简单的属性型指令，说一下几个重点的内容</p>
<p>功能：当用户鼠标悬浮在元素上时，改变它的背景颜色</p>
<p>代码：</p>
<p>highlight.directive.ts</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Directive, ElementRef, HostListener, Input, Renderer &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  selector: <span class="string">'[myHighlight]'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HighlightDirective &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> el: ElementRef, <span class="keyword">private</span> renderer: Renderer</span>) &#123; &#125;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseenter'</span>) onMouseEnter() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="string">'yellow'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseleave'</span>) onMouseLeave() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> highlight(color: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.renderer.setElementStyle(<span class="keyword">this</span>.el.nativeElement, <span class="string">'backgroundColor'</span>, color);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>a.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>My First Attribute Directive<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">myHighlight</span>&gt;</span>Highlight me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li><code>@Directive</code>装饰器需要一个 CSS 选择器，以便从模板中识别出关联到这个指令的 HTML，这里指令的选择器是<code>[myHighlight]</code>，Angular 将会在模板中找到所有带<code>myHighlight属性</code>的元素。</li>
<li>需要把 Angular 的<code>ElementRef</code>和<code>Renderer</code>注入进构造函数。<code>ElementRef</code>是一个服务，它赋予我们通过它的<code>nativeElement</code>属性直接访问 DOM 元素的能力。 <code>Renderer</code>服务允许通过代码设置元素的样式。</li>
<li>需要把这个类添加到 NgModule 元数据的<code>declarations数组</code>中</li>
</ul>
<blockquote>
<p>EXCEPTION: Template parse errors:<br>  Can’t bind to ‘myHighlight’ since it isn’t a known property of ‘p’.</p>
</blockquote>
<p>  错误原因:你记着设置<code>@NgModule</code>的<code>declarations数组</code>了吗？它很容易被忘掉</p>
<ul>
<li><code>@HostListener</code>装饰器引用属性型指令的宿主元素，在这个例子中就是<code>&lt;p&gt;</code></li>
</ul>
<h2 id="高级点的属性型指令"><a href="#高级点的属性型指令" class="headerlink" title="高级点的属性型指令"></a>高级点的属性型指令</h2><p>对上面的那个指令添加功能：</p>
<ol>
<li>通过绑定从外部设定这个颜色 </li>
<li>从外部设定一个默认颜色，如果没有传入颜色，则使用这个默认颜色</li>
<li><p>这样使用这个指令</p>
 <figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span> [<span class="attr">defaultColor</span>]=<span class="string">"'violet'"</span>&gt;</span></span><br><span class="line">    Highlight me too!</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>代码：</p>
<p>highlight.directive.ts</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Directive, ElementRef, HostListener, Input, Renderer &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  selector: <span class="string">'[myHighlight]'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HighlightDirective &#123;</span><br><span class="line">  <span class="keyword">private</span> _defaultColor = <span class="string">'red'</span>;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> el: ElementRef, <span class="keyword">private</span> renderer: Renderer</span>) &#123; &#125;</span><br><span class="line">  <span class="meta">@Input</span>() <span class="keyword">set</span> defaultColor(colorName: <span class="built_in">string</span>)&#123;</span><br><span class="line">    <span class="keyword">this</span>._defaultColor = colorName || <span class="keyword">this</span>._defaultColor;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Input</span>(<span class="string">'myHighlight'</span>) highlightColor: <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseenter'</span>) onMouseEnter() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="keyword">this</span>.highlightColor || <span class="keyword">this</span>._defaultColor);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseleave'</span>) onMouseLeave() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> highlight(color: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.renderer.setElementStyle(<span class="keyword">this</span>.el.nativeElement, <span class="string">'backgroundColor'</span>, color);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>a.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"colors"</span> (<span class="attr">click</span>)=<span class="string">"color='lightgreen'"</span>&gt;</span>Green</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"colors"</span> (<span class="attr">click</span>)=<span class="string">"color='yellow'"</span>&gt;</span>Yellow</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"colors"</span> (<span class="attr">click</span>)=<span class="string">"color='cyan'"</span>&gt;</span>Cyan</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span>&gt;</span>Highlight me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span> [<span class="attr">defaultColor</span>]=<span class="string">"'violet'"</span>&gt;</span></span><br><span class="line">  Highlight me too!</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li>新的<code>highlightColor</code>属性被称为输入属性，因为数据是从绑定表达式流入指令中。 注意，在定义这个属性的时候，我们调用了<code>@Input()</code>装饰器，<code>@Input</code>向类添加元数据，使<code>highlightColor</code>属性能以<code>myHighlight</code>为别名进行绑定</li>
<li>你可以通过重命名属性名到myHighlight来移除这个区别，像这样：<code>@Input() myHighlight: string;</code></li>
<li><code>defaultColor</code>属性是一个 <code>setter</code> 函数，它代替了硬编码的默认颜色 “red”,它不需要 getter 函数。这里，把字符串字面量<code>&#39;violet&#39;</code>绑定到了<code>defaultColor</code>上。</li>
</ul>
<h2 id="关于-输入属性的源和目标"><a href="#关于-输入属性的源和目标" class="headerlink" title="关于 输入属性的源和目标"></a>关于 输入属性的源和目标</h2><p>Angular 在绑定的源和目标之间的区别：</p>
<ul>
<li><p>如果属性出现在了模板表达式等号 (=) 的右侧，它就是一个<code>源</code>。</p>
</li>
<li><p>如果它出现在了方括号 ([ ]) 中，并且出现在等号 (=) 的左侧，它就是一个<code>目标</code>， 就像在绑定到HighlightDirective的myHighlight属性时所做的那样。</p>
</li>
</ul>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span>&gt;</span>Highlight me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>[myHighlight]=&quot;color&quot;</code>中的 <code>&#39;color&#39;</code>是绑定源。 源属性不需要声明。</p>
<p><code>[myHighlight]=&quot;color&quot;</code>中的 <code>&#39;myHighlight&#39;</code> 是绑定目标。 必须把它定义为一个输入属性，否则，Angular 就会拒绝绑定，并给出一个明确的错误。</p>
<p>Angular 这样区别对待目标属性有充分的理由。 作为目标的组件或指令需要保护。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/22/TypeScript - 类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/22/TypeScript - 类/" itemprop="url">TypeScript - 类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-22T16:04:45+08:00">
                2017-02-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><p> 从ECMAScript 2015，也就是ECMAScript 6开始，JavaScript程序员将能够使用基于类的面向对象的方式。 使用TypeScript，我们允许开发者现在就使用这些特性，并且编译后的JavaScript可以在所有主流浏览器和平台上运行，而不需要等到下个JavaScript版本。</p>
<h2 id="创建一个类"><a href="#创建一个类" class="headerlink" title="创建一个类"></a>创建一个类</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Greeter &#123;</span><br><span class="line">    greeting: <span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">message: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.greeting = message;</span><br><span class="line">    &#125;</span><br><span class="line">    greet() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello, "</span> + <span class="keyword">this</span>.greeting;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> greeter = <span class="keyword">new</span> Greeter(<span class="string">"world"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><ul>
<li>使用<code>extend</code>关键字来创建子类</li>
<li>子类构造函数中使用<code>super()</code>，执行父类的构造方法</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">theName: <span class="built_in">string</span></span>) &#123; <span class="keyword">this</span>.name = theName; &#125;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span> = <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;this.name&#125;</span> moved <span class="subst">$&#123;distanceInMeters&#125;</span>m.`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Snake <span class="keyword">extends</span> Animal &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123; <span class="keyword">super</span>(name); &#125;</span><br><span class="line">    move(distanceInMeters = <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Slithering..."</span>);</span><br><span class="line">        <span class="keyword">super</span>.move(distanceInMeters);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Horse <span class="keyword">extends</span> Animal &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123; <span class="keyword">super</span>(name); &#125;</span><br><span class="line">    move(distanceInMeters = <span class="number">45</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Galloping..."</span>);</span><br><span class="line">        <span class="keyword">super</span>.move(distanceInMeters);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sam = <span class="keyword">new</span> Snake(<span class="string">"Sammy the Python"</span>);</span><br><span class="line"><span class="keyword">let</span> tom: Animal = <span class="keyword">new</span> Horse(<span class="string">"Tommy the Palomino"</span>);</span><br><span class="line"></span><br><span class="line">sam.move();</span><br><span class="line">tom.move(<span class="number">34</span>);</span><br></pre></td></tr></table></figure>
<h2 id="public、private、protected修饰符"><a href="#public、private、protected修饰符" class="headerlink" title="public、private、protected修饰符"></a>public、private、protected修饰符</h2><ul>
<li><p>在ts中，成员类型默认为<code>public</code></p>
</li>
<li><p>当成员被标记成<code>private</code>时，它就不能在声明它的类的外部访问</p>
</li>
<li><p><code>protected</code>修饰符与<code>private</code>修饰符的行为相似，但<strong><code>protected</code>成员在派生类中仍然可以访问</strong></p>
</li>
<li><p>构造函数可以被标记成<code>protected</code>，这是这个类不可以在类外进行实例化，但是能被继承并在子类中实例化。</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">   <span class="keyword">protected</span> name: <span class="built_in">string</span>;</span><br><span class="line">       <span class="keyword">protected</span> <span class="keyword">constructor</span>(<span class="params">theName: <span class="built_in">string</span></span>) &#123; <span class="keyword">this</span>.name = theName; &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// Employee can extend Person</span></span><br><span class="line">   <span class="keyword">class</span> Employee <span class="keyword">extends</span> Person &#123;</span><br><span class="line">       <span class="keyword">private</span> department: <span class="built_in">string</span>;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, department: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">           <span class="keyword">super</span>(name);</span><br><span class="line">           <span class="keyword">this</span>.department = department;</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">public</span> getElevatorPitch() &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">`Hello, my name is <span class="subst">$&#123;this.name&#125;</span> and I work in <span class="subst">$&#123;this.department&#125;</span>.`</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">let</span> howard = <span class="keyword">new</span> Employee(<span class="string">"Howard"</span>, <span class="string">"Sales"</span>);</span><br><span class="line">   <span class="keyword">let</span> john = <span class="keyword">new</span> Person(<span class="string">"John"</span>); <span class="comment">// Error: The 'Person' constructor is protected</span></span><br></pre></td></tr></table></figure>
<h2 id="readonly修饰符"><a href="#readonly修饰符" class="headerlink" title="readonly修饰符"></a>readonly修饰符</h2><ul>
<li><code>readnoly</code>修饰符，设置属性为只读的</li>
<li>只读属性必须在声明时或构造函数里被初始化</li>
</ul>
<h2 id="参数属性"><a href="#参数属性" class="headerlink" title="参数属性"></a>参数属性</h2><p>使用参数属性可以方便地在一个地方创建并初始化一个成员,可以简化代码</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> name: <span class="built_in">string</span></span>) &#123; &#125;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面仅在构造函数里使用<code>private name: string</code>参数来创建和初始化name成员,把声明和赋值合并至一处。</p>
<p>等价于</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    <span class="keyword">private</span> name:<span class="built_in">string</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">theName: <span class="built_in">string</span></span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.name=theName;</span><br><span class="line">    &#125;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="存取器-getters-setters"><a href="#存取器-getters-setters" class="headerlink" title="存取器 getters/setters"></a>存取器 getters/setters</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Person&#123;</span><br><span class="line">    <span class="keyword">private</span> _name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">get</span> name():<span class="built_in">string</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">set</span> name(name:<span class="built_in">string</span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>._name=name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.name=<span class="string">'tom'</span>;        <span class="comment">//调用set</span></span><br><span class="line"><span class="built_in">console</span>.log(p.name); <span class="comment">//调用get</span></span><br></pre></td></tr></table></figure>
<p>要注意几点：</p>
<ul>
<li>使用<code>tsc file.ts --target es5</code>编译，因为它只支持ECMAScript 5或更高</li>
<li>只带有 <code>get</code>不带有<code>set</code>的存取器自动被推断为readonly</li>
</ul>
<p>用在哪里？<br>可以用在存取时需要做一些额外操作，而不是直接赋值的地方。</p>
<h2 id="静态属性"><a href="#静态属性" class="headerlink" title="静态属性"></a>静态属性</h2><ul>
<li><code>static</code>可以创建类的静态成员，这些属性存在于类本身，而不是类的实例上</li>
<li>使用<code>类名.静态成员名</code>格式访问类的静态成员</li>
</ul>
<h2 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h2><ul>
<li>抽象类一般不会直接实例化，而是作为派生类的基类。</li>
<li>与接口不同的地方：抽象类可以包含成员的实现细节。</li>
<li><code>abstract</code>关键字是用于定义抽象类和在抽象类内部定义抽象方法。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> Animal &#123;</span><br><span class="line">    <span class="keyword">abstract</span> makeSound(): <span class="built_in">void</span>;</span><br><span class="line">    move(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'roaming the earch...'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：<br><strong>抽象类中的抽象方法不包含具体实现</strong>，而且<strong>它必须要在派生类中实现</strong></p>
<h2 id="高级技巧"><a href="#高级技巧" class="headerlink" title="高级技巧"></a>高级技巧</h2><h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>在创建ts的一个类时，声明了几个东西：</p>
<ul>
<li>类的<code>实例类型</code></li>
<li>创建了一个叫做<code>构造函数的值</code></li>
</ul>
<p>a.ts<br><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Greeter &#123;</span><br><span class="line">    greeting: <span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">message: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.greeting = message;</span><br><span class="line">    &#125;</span><br><span class="line">    greet() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello, "</span> + <span class="keyword">this</span>.greeting;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> greeter: Greeter;</span><br><span class="line">greeter = <span class="keyword">new</span> Greeter(<span class="string">"world"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(greeter.greet());</span><br></pre></td></tr></table></figure></p>
<p>上面的代码使用<code>tsc a.ts</code> 编译后得到的js代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> Greeter = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Greeter</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.greeting = message;</span><br><span class="line">    &#125;</span><br><span class="line">    Greeter.prototype.greet = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello, "</span> + <span class="keyword">this</span>.greeting;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> Greeter;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> greeter;</span><br><span class="line">greeter = <span class="keyword">new</span> Greeter(<span class="string">"world"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(greeter.greet());</span><br></pre></td></tr></table></figure>
<h3 id="把类当做接口使用"><a href="#把类当做接口使用" class="headerlink" title="把类当做接口使用"></a>把类当做接口使用</h3><p>类定义会创建两个东西：<code>类的实例类型</code>和<code>一个构造函数</code>。 因为<strong>类可以创建出类型</strong>，所以你能够在允许使用接口的地方使用类。</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Point &#123;</span><br><span class="line">    x: <span class="built_in">number</span>;</span><br><span class="line">    y: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Point3d <span class="keyword">extends</span> Point &#123;</span><br><span class="line">    z: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> point3d: Point3d = &#123;x: <span class="number">1</span>, y: <span class="number">2</span>, z: <span class="number">3</span>&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/tx.jpeg"
                alt="Ethan Hunt" />
            
              <p class="site-author-name" itemprop="name">Ethan Hunt</p>
              <p class="site-description motion-element" itemprop="description">Make more time</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">46</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ethan Hunt</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
