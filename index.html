<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Make more time">
<meta property="og:type" content="website">
<meta property="og:title" content="易天行">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="易天行">
<meta property="og:description" content="Make more time">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="易天行">
<meta name="twitter:description" content="Make more time">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>易天行</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">易天行</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">积累点滴，汇聚江河</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/12/2018-07-11-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/12/2018-07-11-1/" itemprop="url">nginx入门使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T00:00:00+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文综合介绍了Nginx的概念、特性、配置文件说明、常用命令等。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Nginx是一个<strong>轻量级、高性能的HTTP和反向代理服务器</strong>，也是一个IMAP/POP3/SMTP服务器。它是由c语言开发，由俄罗斯人<code>伊戈尔·赛索耶夫</code>开发的，第一个公开版本发布于2004年10月4日。因它的稳定性、丰富的功能集、示例配置文件和低系统资源的消耗而闻名。其特点是<strong>占有内存少，并发能力强</strong>，事实上nginx是并发能力最好的web服务器，中国大陆使用nginx网站用户有：百度、京东、新浪、网易、腾讯、淘宝等。</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul>
<li><p>作为 Web 服务器：相比 Apache，Nginx 使用更少的资源，支持更多的并发连接，这点使 Nginx 尤其受到虚拟主机提供商的欢迎，能够支持高达 50,000 个并发连接数的响应。</p>
</li>
<li><p>作为反向代理和负载均衡服务器：Nginx 既可以在内部直接支持 Rails 和 PHP，也可以支持作为 HTTP代理服务器 对外进行服务。</p>
</li>
<li><p>作为邮件代理服务器: Nginx 同时也是一个非常优秀的邮件代理服务器（最早开发这个产品的目的之一也是作为邮件代理服务器）。</p>
</li>
<li><p>Nginx 安装非常简单，配置文件非常简洁，Bugs非常少，资源占用低: Nginx 启动特别容易，并且几乎可以做到7*24不间断运行，即使运行数个月也不需要重新启动。</p>
</li>
</ul>
<h2 id="安装步骤（Mac）"><a href="#安装步骤（Mac）" class="headerlink" title="安装步骤（Mac）"></a>安装步骤（Mac）</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew search nginx   <span class="comment"># 检查是否存在</span></span><br><span class="line">brew info nginx     <span class="comment"># 查看要安装的信息</span></span><br><span class="line">brew install nginx  <span class="comment"># 默认port 8080，访问：localhost:8080</span></span><br></pre></td></tr></table></figure>
<ul>
<li>默认的配置文件目录：<code>/usr/local/etc/nginx/nginx.conf</code></li>
<li>默认安装目录：<code>/usr/local/Cellar/nginx/1.13.9</code>，里面会有以nginx版本号命名的文件夹，这里就是安装的根目录。进入<code>1.13.9/bin</code>可以看到nginx的可执行文件。</li>
<li>在<code>1.13.9</code>目录下，还有一个名字为html的快捷方式文件夹，它指向的是<code>/usr/local/var/www</code>目录，该目录下包含<code>50x.html</code>和<code>index.html</code>文件，是nginx服务器默认的显示页面。当它不存在时，访问出现<code>403错误</code>。</li>
<li>使用<code>nginx</code>命令后台启动服务器</li>
</ul>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nginx            <span class="comment">#打开 nginx</span></span><br><span class="line">nginx -s reload  <span class="comment">#重新加载配置</span></span><br><span class="line">nginx -s reopen  <span class="comment">#重启nginx</span></span><br><span class="line">nginx -s stop    <span class="comment">#停止nginx</span></span><br><span class="line">nginx -s quit    <span class="comment">#退出nginx</span></span><br><span class="line">nginx -t         <span class="comment">#测试配置是否有语法错误</span></span><br></pre></td></tr></table></figure>
<h2 id="配置文件示例"><a href="#配置文件示例" class="headerlink" title="配置文件示例"></a>配置文件示例</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#运行用户</span></span><br><span class="line">user nobody;</span><br><span class="line"><span class="comment">#启动进程,通常设置成和cpu的数量相等</span></span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line"><span class="comment">#全局错误日志及PID文件</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#工作模式及连接数上限</span></span><br><span class="line">events &#123;</span><br><span class="line">    <span class="comment">#epoll是多路复用IO(I/O Multiplexing)中的一种方式,</span></span><br><span class="line">    <span class="comment">#仅用于linux2.6以上内核,可以大大提高nginx的性能</span></span><br><span class="line">    use   epoll; </span><br><span class="line"></span><br><span class="line">    <span class="comment">#单个后台worker process进程的最大并发链接数    </span></span><br><span class="line">    worker_connections  1024;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 并发总数是 worker_processes 和 worker_connections 的乘积</span></span><br><span class="line">    <span class="comment"># 即 max_clients = worker_processes * worker_connections</span></span><br><span class="line">    <span class="comment"># 在设置了反向代理的情况下，max_clients = worker_processes * worker_connections / 4  为什么</span></span><br><span class="line">    <span class="comment"># 为什么上面反向代理要除以4，应该说是一个经验值</span></span><br><span class="line">    <span class="comment"># 根据以上条件，正常情况下的Nginx Server可以应付的最大连接数为：4 * 8000 = 32000</span></span><br><span class="line">    <span class="comment"># worker_connections 值的设置跟物理内存大小有关</span></span><br><span class="line">    <span class="comment"># 因为并发受IO约束，max_clients的值须小于系统可以打开的最大文件数</span></span><br><span class="line">    <span class="comment"># 而系统可以打开的最大文件数和内存大小成正比，一般1GB内存的机器上可以打开的文件数大约是10万左右</span></span><br><span class="line">    <span class="comment"># 我们来看看360M内存的VPS可以打开的文件句柄数是多少：</span></span><br><span class="line">    <span class="comment"># $ cat /proc/sys/fs/file-max</span></span><br><span class="line">    <span class="comment"># 输出 34336</span></span><br><span class="line">    <span class="comment"># 32000 &lt; 34336，即并发连接总数小于系统可以打开的文件句柄总数，这样就在操作系统可以承受的范围之内</span></span><br><span class="line">    <span class="comment"># 所以，worker_connections 的值需根据 worker_processes 进程数目和系统可以打开的最大文件总数进行适当地进行设置</span></span><br><span class="line">    <span class="comment"># 使得并发总数小于操作系统可以打开的最大文件数目</span></span><br><span class="line">    <span class="comment"># 其实质也就是根据主机的物理CPU和内存进行配置</span></span><br><span class="line">    <span class="comment"># 当然，理论上的并发总数可能会和实际有所偏差，因为主机还有其他的工作进程需要消耗系统资源。</span></span><br><span class="line">    <span class="comment"># ulimit -SHn 65535</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    <span class="comment">#设定mime类型,类型由mime.type文件定义</span></span><br><span class="line">    include    mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    <span class="comment">#设定日志格式</span></span><br><span class="line">    log_format  main  <span class="string">'$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;</span><br><span class="line"></span><br><span class="line">    access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#sendfile 指令指定 nginx 是否调用 sendfile 函数（zero copy 方式）来输出文件，</span></span><br><span class="line">    <span class="comment">#对于普通应用，必须设为 on,</span></span><br><span class="line">    <span class="comment">#如果用来进行下载等应用磁盘IO重负载应用，可设置为 off，</span></span><br><span class="line">    <span class="comment">#以平衡磁盘与网络I/O处理速度，降低系统的uptime.</span></span><br><span class="line">    sendfile     on;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#连接超时时间</span></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    tcp_nodelay     on;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#开启gzip压缩</span></span><br><span class="line">    gzip  on;</span><br><span class="line">    gzip_disable <span class="string">"MSIE [1-6]."</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#设定请求缓冲</span></span><br><span class="line">    client_header_buffer_size    128k;</span><br><span class="line">    large_client_header_buffers  4 128k;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#设定虚拟主机配置</span></span><br><span class="line">    server &#123;</span><br><span class="line">        <span class="comment">#侦听80端口</span></span><br><span class="line">        listen    80;</span><br><span class="line">        <span class="comment">#定义使用 www.nginx.cn访问</span></span><br><span class="line">        server_name  www.nginx.cn;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#定义服务器的默认网站根目录位置</span></span><br><span class="line">        root html;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#设定本虚拟主机的访问日志</span></span><br><span class="line">        access_log  logs/nginx.access.log  main;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#默认请求</span></span><br><span class="line">        location / &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#定义首页索引文件的名称</span></span><br><span class="line">            index index.php index.html index.htm;   </span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义错误提示页面</span></span><br><span class="line">        error_page   500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#静态文件，nginx自己处理</span></span><br><span class="line">        location ~ ^/(images|javascript|js|css|flash|media|static)/ &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#过期30天，静态文件不怎么更新，过期可以设大一点，</span></span><br><span class="line">            <span class="comment">#如果频繁更新，则可以设置得小一点。</span></span><br><span class="line">            expires 30d;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#PHP 脚本请求全部转发到 FastCGI处理. 使用FastCGI默认配置.</span></span><br><span class="line">        location ~ .php$ &#123;</span><br><span class="line">            fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">            fastcgi_index index.php;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">            include fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#禁止访问 .htxxx 文件</span></span><br><span class="line">            location ~ /.ht &#123;</span><br><span class="line">            deny all;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/12/2018-07-11-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/12/2018-07-11-2/" itemprop="url">mongo原子性和事务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T00:00:00+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>关于mongodb原子性和事务的说明，大部分翻译自官方文档<code>(https://docs.mongodb.com/manual/tutorial)</code></p>
</blockquote>
<h1 id="原子性和事务"><a href="#原子性和事务" class="headerlink" title="原子性和事务"></a>原子性和事务</h1><p>在MongoDb中，写操作在<code>文档级别</code>是原子性的，即使该文档包含多个嵌入的子文档。</p>
<p>当一次写操作修改多个文档时，对每个文档的更新时原子性的，但整个写入操作不是原子性的，而且中间可能会插入多个其他操作。</p>
<h2 id="模拟事务"><a href="#模拟事务" class="headerlink" title="模拟事务"></a>模拟事务</h2><p>因为一个文档可以包含多个子文档，所以文档级别的原子性可以满足大部分的应用场景。如果你想把多个操作作为一个事务来处理，你可以实现一个<code>two-phase commit</code>。</p>
<p>然而，<code>two-phase commit</code>仅仅可以提供类事务语义。使用它可以保证数据的一致性，但是在<code>two-phase commit</code>或回滚进行时可能会返回中间数据。关于two-phase commit的更多信息，请看这里<a href="https://docs.mongodb.com/manual/tutorial/perform-two-phase-commits/" target="_blank" rel="noopener"> Perform Two Phase Commits</a></p>
<h2 id="并发控制-Concurrency-Control"><a href="#并发控制-Concurrency-Control" class="headerlink" title="并发控制  Concurrency Control"></a>并发控制  Concurrency Control</h2><p>并发控制可以保证多个应用运行时的一致性，避免导致数据不一致或数据冲突问题。</p>
<p>方法一是在一个有唯一数据值的字段上创建一个唯一索引<a href="https://docs.mongodb.com/manual/core/index-unique/#index-type-unique" target="_blank" rel="noopener">unique index</a>。这样可以防止插入或更新产生重复数据。在多个字段上创建唯一索引，来保证这多个字段组合值的唯一性。示例操作请看，<a href="https://docs.mongodb.com/manual/reference/method/db.collection.update/#update-with-unique-indexes" target="_blank" rel="noopener">update() and Unique Index</a>, <a href="https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/#upsert-and-unique-index" target="_blank" rel="noopener">findAndModify() and Unique Index</a>。</p>
<p>方法二是，在查询条件上对指定字段的当前值进行判断。在写操作中，<code>two-phase commit</code>模式提供了一个变量，其中的查询条件包含了应用标识<a href="https://docs.mongodb.com/manual/tutorial/perform-two-phase-commits/#phase-commits-concurrency" target="_blank" rel="noopener">application identifier</a>和写操作中数据的预期状态。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/11/2018-07-11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/11/2018-07-11/" itemprop="url">node.js错误类型总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-11T00:00:00+08:00">
                2018-07-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本文大致介绍了node.js中四种常见的错误类型，列举了常见的标准错误，比如<code>SyntaxError``ReferenceError</code>等等，然后列举了自定义error和assertError的实例及错误的捕获和处理的几种方式。</p>
</blockquote>
<p>四种错误类型：</p>
<h2 id="1-标准错误"><a href="#1-标准错误" class="headerlink" title="1.标准错误"></a>1.标准错误</h2><p>这些错误在开发中都很常见，错误类型的有</p>
<ul>
<li><code>SyntaxError</code> js语法错误</li>
<li><code>ReferenceError</code> 使用未定义变量时抛出</li>
<li><code>RangeError</code> 当一个值不在指定范围内时抛出</li>
<li><code>TypeError</code> 传递错误的参数类型时抛出</li>
<li><code>EvalError</code> 调用<code>eval()</code>失败时抛出</li>
<li><code>URIError</code> 当一个全局的URI函数被错误使用时抛出</li>
</ul>
<h2 id="2-自定义错误"><a href="#2-自定义错误" class="headerlink" title="2.自定义错误"></a>2.自定义错误</h2><p>使用Error构造函数抛出错误信息：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var a = 1;</span><br><span class="line">if(a&lt;2)&#123;</span><br><span class="line">  throw Error(&quot;less than 2&quot;);</span><br><span class="line">&#125;</span><br><span class="line">console.log(&apos;last&apos;)  //这里不会在执行</span><br><span class="line"></span><br><span class="line">/Users/shaoc/svn/npmtest/src/tableheader/b.js:4</span><br><span class="line">  throw Error(&quot;less than 2&quot;);</span><br><span class="line">  ^</span><br><span class="line"></span><br><span class="line">Error: less than 2</span><br><span class="line">    at Error (native)</span><br><span class="line">    at Object.&lt;anonymous&gt; (/Users/shaoc/svn/npmtest/src/tableheader/b.js:4:9)</span><br><span class="line">    at Module._compile (module.js:570:32)</span><br><span class="line">    at Object.Module._extensions..js (module.js:579:10)</span><br><span class="line">    at Module.load (module.js:487:32)</span><br><span class="line">    at tryModuleLoad (module.js:446:12)</span><br><span class="line">    at Function.Module._load (module.js:438:3)</span><br><span class="line">    at Module.runMain (module.js:604:10)</span><br><span class="line">    at run (bootstrap_node.js:394:7)</span><br><span class="line">    at startup (bootstrap_node.js:149:9)</span><br></pre></td></tr></table></figure>
<h2 id="3-断言错误"><a href="#3-断言错误" class="headerlink" title="3.断言错误"></a>3.断言错误</h2><p>当代码违反业务逻辑时，由<code>assert</code>模块触发 </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">"assert"</span>)</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">assert(a &gt; <span class="number">10</span>, <span class="string">"a不能小于10"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'last'</span>)</span><br><span class="line">assert.js:<span class="number">85</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> assert.AssertionError(&#123;</span><br><span class="line">  ^</span><br><span class="line">AssertionError: a不能小于<span class="number">10</span></span><br><span class="line">    at <span class="built_in">Object</span>.&lt;anonymous&gt; (<span class="regexp">/Users/</span>shaoc/svn/npmtest/src/tableheader/b.js:<span class="number">5</span>:<span class="number">1</span>)</span><br><span class="line">    at Module._compile (<span class="built_in">module</span>.js:<span class="number">570</span>:<span class="number">32</span>)</span><br><span class="line">    at <span class="built_in">Object</span>.Module._extensions..js (<span class="built_in">module</span>.js:<span class="number">579</span>:<span class="number">10</span>)</span><br><span class="line">    at Module.load (<span class="built_in">module</span>.js:<span class="number">487</span>:<span class="number">32</span>)</span><br><span class="line">    at tryModuleLoad (<span class="built_in">module</span>.js:<span class="number">446</span>:<span class="number">12</span>)</span><br><span class="line">    at <span class="built_in">Function</span>.Module._load (<span class="built_in">module</span>.js:<span class="number">438</span>:<span class="number">3</span>)</span><br><span class="line">    at Module.runMain (<span class="built_in">module</span>.js:<span class="number">604</span>:<span class="number">10</span>)</span><br><span class="line">    at run (bootstrap_node.js:<span class="number">394</span>:<span class="number">7</span>)</span><br><span class="line">    at startup (bootstrap_node.js:<span class="number">149</span>:<span class="number">9</span>)</span><br><span class="line">    at bootstrap_node.js:<span class="number">509</span>:<span class="number">3</span></span><br></pre></td></tr></table></figure>
<h2 id="4-系统错误"><a href="#4-系统错误" class="headerlink" title="4.系统错误"></a>4.系统错误</h2><p>系统错误是对JavaScript错误Error对象的一个扩展，它们表示程序能够处理的操作错误，这些错误信息都是在系统级别生成的。系统错误实例中除Error实例中的属性外，还包括以下几个属性：</p>
<p>1、error.syscall - 一个表示失败的系统调用信息的字符串<br>2、error.errno - 一个整数的错误码<br>3、error.code - 表示错误字符串，通常是大写字母E开头</p>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><ul>
<li>node可以使用try catch 捕获异常，但是没有办法捕获到异步调用中发生的异常</li>
<li>使用错误优先的回调函数，function(err, data) //优先处理错误信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const fs = require(&apos;fs&apos;);</span><br><span class="line">fs.readFile(&apos;一个不存在的文件&apos;, (err, data) =&gt; &#123;</span><br><span class="line"> if (err) &#123;</span><br><span class="line">  console.error(&apos;读取文件错误&apos;, err);</span><br><span class="line">  return;</span><br><span class="line"> &#125;</span><br><span class="line"> // 其它处理</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>使用事件机制捕获异常</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const net = require(&apos;net&apos;);</span><br><span class="line">const connection = net.connect(&apos;localhost&apos;);</span><br><span class="line"> </span><br><span class="line">// 为stream添加一个 &apos;error&apos; 事件处理器:</span><br><span class="line">connection.on(&apos;error&apos;, (err) =&gt; &#123;</span><br><span class="line"> // 如果连接被服务器重置或连接不到指定的服务器</span><br><span class="line"> // 或其它连接错误时，错误会被传递到这里</span><br><span class="line"> console.error(err);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">connection.pipe(process.stdout);</span><br><span class="line"></span><br><span class="line">//全局</span><br><span class="line">process.on(&apos;uncaughtException&apos;, function (err) &#123;</span><br><span class="line">  log.app.error(&quot;Caught exception:-----&gt;&quot;, err);</span><br><span class="line">  process.exit(8);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>使用domain</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/15/2018-05-15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/15/2018-05-15/" itemprop="url">node.js中的module.exports和exports</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-15T00:00:00+08:00">
                2018-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前对<code>exports</code>和<code>module.exports</code>一直存在疑惑，知道<code>exports</code>使用不当可能会导致问题，所以一直使用<code>module.exports</code>, 理解没有深入。通过阅读官方文档，对它们的区别、联系和使用注意事项做一个总结。</p>
<h2 id="翻译自官方文档"><a href="#翻译自官方文档" class="headerlink" title="翻译自官方文档"></a>翻译自官方文档</h2><p><a href="https://nodejs.org/docs/latest/api/modules.html#modules_module_exports" target="_blank" rel="noopener">官方文档</a><br>在node每个模块中，都有一个<code>module</code>变量保存着对当前模块的引用。为了方便，<code>module.exports</code>也可以通过<code>exports</code>全局模块来访问。<code>module</code>不是全局的，对每一个模块来说，它都是一个本地变量。</p>
<h3 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a>module.exports</h3><p><code>module.exports</code>对象，是由模块系统创建的。当你想在其他类中引用一个模块时，可以用它来实现，通过将你要导出的对象赋值给<code>module.exports</code>。千万注意，本地的<code>exports</code>对象仅仅在初始的时候保存着对<code>module.exports</code>的引用，有些时候可能不会得到你想要的结果。<br>举个例子来说，创建一个a.js的模块：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"><span class="comment">// Do some work, and after some time emit</span></span><br><span class="line"><span class="comment">// the 'ready' event from the module itself.</span></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">module</span>.exports.emit(<span class="string">'ready'</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p>然后在另一个模块，我们可以引入它：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="built_in">require</span>(<span class="string">'./a'</span>);</span><br><span class="line">a.on(<span class="string">'ready'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'module "a" is ready'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>请注意，对<code>module.exports</code>的复制必须是立即执行的，不可以在任何回调中进行导出。比如，下面这样无效：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">module</span>.exports = &#123; <span class="attr">a</span>: <span class="string">'hello'</span> &#125;;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="exports-shortcut"><a href="#exports-shortcut" class="headerlink" title="exports shortcut"></a>exports shortcut</h3><p><code>exports</code>变量仅在模块的文件作用域内有效，在初始时，它保存着对<code>module.exports</code>的应用。所以有些时候，<code>module.exports.f = ...</code>可以简写为<code>exports.f = ....</code>。但是，千万注意，在对它进行重新赋值之后，它将不再绑定到<code>module.exports</code>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports.hello = <span class="literal">true</span>; <span class="comment">// Exported from require of module</span></span><br><span class="line">exports = &#123; <span class="attr">hello</span>: <span class="literal">false</span> &#125;;  <span class="comment">// Not exported, only available in the module</span></span><br></pre></td></tr></table></figure>
<p><strong>当对<code>module.exports</code>重新赋值为新对象的时候，最好把<code>exports</code>也重新赋值</strong>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = exports = <span class="function"><span class="keyword">function</span> <span class="title">Constructor</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... etc.</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="require实现"><a href="#require实现" class="headerlink" title="require实现"></a>require实现</h3><p>为了更好的解释这一点，下面是<code>require()</code>方法的简要实现，它和实际的实现基本原理相同：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">require</span>(<span class="params"><span class="regexp">/* ... */</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">module</span> = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line">  (<span class="function">(<span class="params"><span class="built_in">module</span>, exports</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Module code here. In this example, define a function.</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">someFunc</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    exports = someFunc;</span><br><span class="line">    <span class="comment">// At this point, exports is no longer a shortcut to module.exports, and</span></span><br><span class="line">    <span class="comment">// this module will still export an empty default object.</span></span><br><span class="line">    <span class="built_in">module</span>.exports = someFunc;</span><br><span class="line">    <span class="comment">// At this point, the module will now export someFunc, instead of the</span></span><br><span class="line">    <span class="comment">// default object.</span></span><br><span class="line">  &#125;)(<span class="built_in">module</span>, <span class="built_in">module</span>.exports);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>在一个模块内，<code>exports</code>仅仅是对<code>module.exports</code>的引用</li>
<li>在未对<code>exports</code>重新赋值前，可以使用<code>exports.myfun=function(){}</code>的形式导出，但请不要使用<code>exports = { }</code> 的形式</li>
<li>整对象导出时，尽量使用<code>module.exports=exports= function Constructor(){ }</code>的形式，避免出现漏洞</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/14/2018-05-14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/14/2018-05-14/" itemprop="url">node.js异步框架thenjs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-14T00:00:00+08:00">
                2018-05-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>项目中存在大量的es5回调的代码，而且生产环境对原生Promise、awati/async 支持不够好，所以使用then.js作为异步解决方案，避免回调地狱的问题，也能兼容老代码。本文简要介绍了then.js异步框架的特点、安装和基本用法。</p>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p>一个解决js异步回调问题的方案，它可以将“回调地狱”处理成并列的then链，方便代码的阅读和维护。<br><a href="https://www.npmjs.com/package/thenjs" target="_blank" rel="noopener">官网地址</a></p>
<h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul>
<li><p>可以像标准的 Promise 那样，把N多异步回调函数写成一个长长的 then 链，并且比 Promise 更简洁自然。因为如果使用标准 Promise 的 then 链，其中的异步函数都必须转换成 Promise，Thenjs 则无需转换，像使用 callback 一样执行异步函数即可。</p>
</li>
<li><p>强大的 Error 机制，可以捕捉任何同步或异步的异常错误，甚至是位于异步函数中的语法错误。并且捕捉的错误任君处置。</p>
</li>
<li><p>开启debug模式，可以把每一个then链运行结果输出到debug函数（未定义debug函数则用 console.log），方便调试。</p>
</li>
</ul>
<h2 id="安装-amp-使用"><a href="#安装-amp-使用" class="headerlink" title="安装&amp;使用"></a>安装&amp;使用</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install thenjs --save</span><br><span class="line">var Thenjs = require(&quot;thenjs&quot;);</span><br></pre></td></tr></table></figure>
<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs(<span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123;</span><br><span class="line">  cont(<span class="literal">null</span>, result);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123;</span><br><span class="line">  cont(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error!'</span>), <span class="number">123</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.fin(<span class="function"><span class="keyword">function</span> (<span class="params">cont, error, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(error, result);</span><br><span class="line">  cont();</span><br><span class="line">&#125;)</span><br><span class="line">.each([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="function"><span class="keyword">function</span> (<span class="params">cont, value</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//do sth with value</span></span><br><span class="line">  cont(<span class="literal">null</span>);  <span class="comment">// 并行执行队列任务，把队列 list 中的每一个值输入到 task 中运行</span></span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">  cont();</span><br><span class="line">&#125;)</span><br><span class="line">.series([ <span class="comment">// 串行执行队列任务</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; task(<span class="number">88</span>, cont); &#125;, <span class="comment">// 队列第一个是异步任务</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; cont(<span class="literal">null</span>, <span class="number">99</span>); &#125; <span class="comment">// 第二个是同步任务</span></span><br><span class="line">])</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">  cont(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error!!'</span>));</span><br><span class="line">&#125;)</span><br><span class="line">.fail(<span class="function"><span class="keyword">function</span> (<span class="params">cont, error</span>) </span>&#123; <span class="comment">// 通常应该在链的最后放置一个 `fail` 方法收集异常</span></span><br><span class="line">  <span class="built_in">console</span>.log(error);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'DEMO END!'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="两种方式定义"><a href="#两种方式定义" class="headerlink" title="两种方式定义"></a>两种方式定义</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs().then(<span class="function"><span class="keyword">function</span>(<span class="params">cont</span>) </span>&#123; </span><br><span class="line">    cont(<span class="literal">null</span>); </span><br><span class="line">&#125;);</span><br><span class="line">Thenjs(<span class="function"><span class="keyword">function</span>(<span class="params">cont, result</span>) </span>&#123; </span><br><span class="line">    cont(result); </span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-each-array-iterator"><a href="#Thenjs-each-array-iterator" class="headerlink" title="Thenjs.each(array, iterator)"></a>Thenjs.each(array, iterator)</h3><p>将 array 中的值应用于 iterator 函数（同步或异步），并行执行。返回一个新的 Thenjs 对象。<br>返回结果result是一个数组，包含每个cont返回的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs.each([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="function"><span class="keyword">function</span> (<span class="params">cont, value</span>) </span>&#123;</span><br><span class="line">  task(value * <span class="number">2</span>, cont);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-eachSeries-array-iterator"><a href="#Thenjs-eachSeries-array-iterator" class="headerlink" title="Thenjs.eachSeries(array, iterator)"></a>Thenjs.eachSeries(array, iterator)</h3><p>同上，串行执行</p>
<h3 id="Thenjs-parallel-tasksArray"><a href="#Thenjs-parallel-tasksArray" class="headerlink" title="Thenjs.parallel(tasksArray)"></a>Thenjs.parallel(tasksArray)</h3><p>tasksArray 是一个函数（同步或异步）数组，<strong>并行执行</strong>。返回一个新的 Thenjs 对象。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs.parallel([</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; task(<span class="number">88</span>, cont); &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123; cont(<span class="literal">null</span>, <span class="number">99</span>); &#125;</span><br><span class="line">])</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, result</span>) </span>&#123;  <span class="comment">//result 是返回结果的数组</span></span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-series-tasksArray"><a href="#Thenjs-series-tasksArray" class="headerlink" title="Thenjs.series(tasksArray)"></a>Thenjs.series(tasksArray)</h3><p>同上，接受函数数组参数，<strong>串行执行</strong></p>
<h3 id="Thenjs-parallelLimit-tasksArray-limit"><a href="#Thenjs-parallelLimit-tasksArray-limit" class="headerlink" title="Thenjs.parallelLimit(tasksArray, limit)"></a>Thenjs.parallelLimit(tasksArray, limit)</h3><p>同parallel，并行执行，不过限制最大并发数为limit</p>
<h3 id="Thenjs-eachLimit-array-iterator-limit"><a href="#Thenjs-eachLimit-array-iterator-limit" class="headerlink" title="Thenjs.eachLimit(array, iterator, limit)"></a>Thenjs.eachLimit(array, iterator, limit)</h3><p>同each，并行执行，限制最大并发数为limit</p>
<h3 id="Thenjs-prototype-then-successHandler-errorHandler"><a href="#Thenjs-prototype-then-successHandler-errorHandler" class="headerlink" title="Thenjs.prototype.then(successHandler, [errorHandler])"></a>Thenjs.prototype.then(successHandler, [errorHandler])</h3><p>如果上一链正确，则进入 successHandler 执行，否则进入 errorHandler 执行。返回一个新的 Thenjs 对象。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Thenjs(<span class="function"><span class="keyword">function</span> (<span class="params">cont</span>) </span>&#123;</span><br><span class="line">  task(<span class="number">10</span>, cont);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">cont, arg</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arg);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">cont, error</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.error(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Thenjs-prototype-finally-finallyHandler"><a href="#Thenjs-prototype-finally-finallyHandler" class="headerlink" title="Thenjs.prototype.finally(finallyHandler)"></a>Thenjs.prototype.finally(finallyHandler)</h3><p>别名<code>fin</code><br>无论上一链是否存在 error，均进入 finallyHandler 执行，等效于 .then(successHandler, errorHandler)。返回一个新的 Thenjs 对象。</p>
<h3 id="Thenjs-prototype-fail-errorHandler"><a href="#Thenjs-prototype-fail-errorHandler" class="headerlink" title="Thenjs.prototype.fail(errorHandler)"></a>Thenjs.prototype.fail(errorHandler)</h3><p>fail 用于捕捉 error，如果在它之前的任意一个链上产生了 error，并且未被 then, finally 等捕获，则会跳过中间链，直接进入 fail。返回一个新的 Thenjs 对象。</p>
<h3 id="prototype也有each-eachSeries-parallel-series"><a href="#prototype也有each-eachSeries-parallel-series" class="headerlink" title="prototype也有each eachSeries parallel series"></a>prototype也有each eachSeries parallel series</h3><p>Thenjs.prototype.each(array, iterator)<br>参数类似 Thenjs.each，返回一个新的 Thenjs 对象。</p>
<p>不同在于，参数可省略，如果没有参数，则会查找上一个链的输出结果作为参数，即上一个链可以这样 cont(null, array, iterator) 传输参数到each。下面三个队列方法行为类似。</p>
<p>Thenjs.prototype.eachSeries(array, iterator)<br>参数类似 Thenjs.eachSeries，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.parallel(tasksArray)<br>参数类似 Thenjs.parallel，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.series(tasksArray)<br>参数类似 Thenjs.series，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.parallelLimit(tasksArray, limit)<br>参数类似 Thenjs.parallelLimit，返回一个新的 Thenjs 对象。</p>
<p>Thenjs.prototype.eachLimit(array, iterator, limit)<br>参数类似 Thenjs.eachLimit，返回一个新的 Thenjs 对象。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/05/2017-12-05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/05/2017-12-05/" itemprop="url">设计模式6原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-05T00:00:00+08:00">
                2017-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="设计模式6原则"><a href="#设计模式6原则" class="headerlink" title="设计模式6原则"></a>设计模式6原则</h1><p>参考自csdn：<a href="https://www.cnblogs.com/dolphin0520/p/3919839.html" target="_blank" rel="noopener">设计模式之六大原则</a></p>
<h2 id="1-单一职责原则-SRP"><a href="#1-单一职责原则-SRP" class="headerlink" title="1 单一职责原则 SRP"></a>1 单一职责原则 SRP</h2><blockquote>
<p>单一职责原则(Single Responsibility Principle, SRP)：一个类只负责一个功能领域中的相应职责，或者可以定义为：就一个类而言，应该只有一个引起它变化的原因。</p>
</blockquote>
<p>  单一职责原则告诉我们：一个类不能太“累”！在软件系统中，一个类（大到模块，小到方法）承担的职责越多，它被复用的可能性就越小，而且一个类承担的职责过多，就相当于将这些职责耦合在一起，当其中一个职责变化时，可能会影响其他职责的运作，因此要将这些职责进行分离，将不同的职责封装在不同的类中，即将不同的变化原因封装在不同的类中，如果多个职责总是同时发生改变则可将它们封装在同一类中。</p>
<p>==单一职责原则是实现高内聚、低耦合的指导方针，它是最简单但又最难运用的原则，需要设计人员发现类的不同职责并将其分离，而发现类的多重职责需要设计人员具有较强的分析设计能力和相关实践经验。==</p>
<h2 id="2-开闭原则-OCP"><a href="#2-开闭原则-OCP" class="headerlink" title="2 开闭原则 OCP"></a>2 开闭原则 OCP</h2><p>开闭原则是面向对象的可复用设计的第一块基石，它是最重要的面向对象设计原则。</p>
<blockquote>
<p>开闭原则(Open-Closed Principle, OCP)：一个软件实体应当对扩展开放，对修改关闭。即软件实体应尽量在不修改原有代码的情况下进行扩展。</p>
</blockquote>
<p>任何软件都需要面临一个很重要的问题，即它们的需求会随时间的推移而发生变化。当软件系统需要面对新的需求时，我们应该尽量保证系统的设计框架是稳定的。如果一个软件设计符合开闭原则，那么可以非常方便地对系统进行扩展，而且在扩展时无须修改现有代码，使得软件系统在拥有适应性和灵活性的同时具备较好的稳定性和延续性。随着软件规模越来越大，软件寿命越来越长，软件维护成本越来越高，设计满足开闭原则的软件系统也变得越来越重要。</p>
<p>为了满足开闭原则，==需要对系统进行抽象化设计，抽象化是开闭原则的关键==。在Java、C#等编程语言中，可以为系统定义一个相对稳定的抽象层，而将不同的实现行为移至具体的实现层中完成。在很多面向对象编程语言中都提供了接口、抽象类等机制，可以通过它们定义系统的抽象层，再通过具体类来进行扩展。==如果需要修改系统的行为，无须对抽象层进行任何改动，只需要增加新的具体类来实现新的业务功能即可，实现在不修改已有代码的基础上扩展系统的功能，达到开闭原则的要求。==</p>
<h2 id="3-里氏替换原则-LSP"><a href="#3-里氏替换原则-LSP" class="headerlink" title="3 里氏替换原则 LSP"></a>3 里氏替换原则 LSP</h2><blockquote>
<p>里氏代换原则(Liskov Substitution Principle, LSP)：所有引用基类（父类）的地方必须能透明地使用其子类的对象。</p>
</blockquote>
<p>==通俗的讲：“老鼠的儿子会打洞”==</p>
<p>里氏代换原则告诉我们，==在软件中将一个基类对象替换成它的子类对象，程序将不会产生任何错误和异常，反过来则不成立，如果一个软件实体使用的是一个子类对象的话，那么它不一定能够使用基类对象==。例如：我喜欢动物，那我一定喜欢狗，因为狗是动物的子类；但是我喜欢狗，不能据此断定我喜欢动物，因为我并不喜欢老鼠，虽然它也是动物。</p>
<p>例如有两个类，一个类为BaseClass，另一个是SubClass类，并且SubClass类是BaseClass类的子类，那么一个方法如果可以接受一个BaseClass类型的基类对象base的话，如：method1(base)，那么它必然可以接受一个BaseClass类型的子类对象sub，method1(sub)能够正常运行。反过来的代换不成立，如一个方法method2接受BaseClass类型的子类对象sub为参数：method2(sub)，那么一般而言不可以有method2(base)，除非是重载方法。</p>
<p>==里氏代换原则是实现开闭原则的重要方式之一，由于使用基类对象的地方都可以使用子类对象，因此在程序中尽量使用基类类型来对对象进行定义，而在运行时再确定其子类类型，用子类对象来替换父类对象。==</p>
<p>在使用里氏代换原则时需要注意如下几个问题：</p>
<p>(1)子类的所有方法必须在父类中声明，或子类必须实现父类中声明的所有方法。根据里氏代换原则，为了保证系统的扩展性，在程序中通常使用父类来进行定义，如果一个方法只存在子类中，在父类中不提供相应的声明，则无法在以父类定义的对象中使用该方法。</p>
<p>(2) 我们在运用里氏代换原则时，尽量把父类设计为抽象类或者接口，让子类继承父类或实现父接口，并实现在父类中声明的方法，运行时，子类实例替换父类实例，我们可以很方便地扩展系统的功能，同时无须修改原有子类的代码，增加新的功能可以通过增加一个新的子类来实现。里氏代换原则是开闭原则的具体实现手段之一。</p>
<p>(3) Java语言中，在编译阶段，Java编译器会检查一个程序是否符合里氏代换原则，这是一个与实现无关的、纯语法意义上的检查，但Java编译器的检查是有局限的。</p>
<h2 id="4-依赖倒置原则-DIP"><a href="#4-依赖倒置原则-DIP" class="headerlink" title="4 依赖倒置原则  DIP"></a>4 依赖倒置原则  DIP</h2><blockquote>
<p>依赖倒转原则(Dependency Inversion  Principle, DIP)：抽象不应该依赖于细节，细节应当依赖于抽象。换言之，要针对接口编程，而不是针对实现编程。</p>
</blockquote>
<p>==依赖倒转原则要求我们在程序代码中传递参数时或在关联关系中，尽量引用层次高的抽象层类，即使用接口和抽象类进行变量类型声明、参数类型声明、方法返回类型声明，以及数据类型的转换等，而不要用具体类来做这些事情。为了确保该原则的应用，一个具体类应当只实现接口或抽象类中声明过的方法，而不要给出多余的方法，否则将无法调用到在子类中增加的新方法。==</p>
<p>在引入抽象层后，系统将具有很好的灵活性，在程序中尽量使用抽象层进行编程，而将具体类写在配置文件中，这样一来，如果系统行为发生变化，只需要对抽象层进行扩展，并修改配置文件，而无须修改原有系统的源代码，在不修改的情况下来扩展系统的功能，满足开闭原则的要求。</p>
<p>在实现依赖倒转原则时，==我们需要针对抽象层编程，而将具体类的对象通过<strong>依赖注入(DependencyInjection, DI)</strong>的方式注入到其他对象中，依赖注入是指当一个对象要与其他对象发生依赖关系时，通过抽象来注入所依赖的对象。常用的注入方式有三种，分别是：构造注入，设值注入（Setter注入）和接口注入。构造注入是指通过构造函数来传入具体类的对象，设值注入是指通过Setter方法来传入具体类的对象，而接口注入是指通过在接口中声明的业务方法来传入具体类的对象。这些方法在定义时使用的是抽象类型，在运行时再传入具体类型的对象，由子类对象来覆盖父类对象。==</p>
<h2 id="5-接口隔离原则-ISP"><a href="#5-接口隔离原则-ISP" class="headerlink" title="5 接口隔离原则 ISP"></a>5 接口隔离原则 ISP</h2><blockquote>
<p>接口隔离原则(Interface  Segregation Principle, ISP)：使用多个专门的接口，而不使用单一的总接口，即客户端不应该依赖那些它不需要的接口。</p>
</blockquote>
<p> 根据接口隔离原则，当一个接口太大时，我们需要将它分割成一些更细小的接口，使用该接口的客户端仅需知道与之相关的方法即可。==每一个接口应该承担一种相对独立的角色，不干不该干的事，该干的事都要干。==这里的“接口”往往有两种不同的含义：一种是指一个类型所具有的方法特征的集合，仅仅是一种逻辑上的抽象；另外一种是指某种语言具体的“接口”定义，有严格的定义和结构，比如Java语言中的interface。对于这两种不同的含义，ISP的表达方式以及含义都有所不同：</p>
<p>(1) 当把“接口”理解成一个类型所提供的所有方法特征的集合的时候，这就是一种逻辑上的概念，接口的划分将直接带来类型的划分。可以把接口理解成角色，一个接口只能代表一个角色，每个角色都有它特定的一个接口，此时，这个原则可以叫做==“角色隔离原则”==。</p>
<p>(2) 如果把“接口”理解成狭义的特定语言的接口，那么ISP表达的意思是指==接口仅仅提供客户端需要的行为，客户端不需要的行为则隐藏起来，应当为客户端提供尽可能小的单独的接口，而不要提供大的总接口==。在面向对象编程语言中，实现一个接口就需要实现该接口中定义的所有方法，因此大的总接口使用起来不一定很方便，为了使接口的职责单一，需要将大接口中的方法根据其职责不同分别放在不同的小接口中，以确保每个接口使用起来都较为方便，并都承担某一单一角色。接口应该尽量细化，同时接口中的方法应该尽量少，每个接口中只包含一个客户端（如子模块或业务逻辑类）所需的方法即可，这种机制也称为“定制服务”，即为不同的客户端提供宽窄不同的接口。</p>
<h2 id="6-迪米特法则-LOD"><a href="#6-迪米特法则-LOD" class="headerlink" title="6 迪米特法则 LOD"></a>6 迪米特法则 LOD</h2><p>==<strong>迪米特法则(Law of  Demeter, LoD)：一个软件实体应当尽可能少地与其他实体发生相互作用。</strong>==</p>
<p>如果一个系统符合迪米特法则，那么当其中某一个模块发生修改时，就会尽量少地影响其他模块，扩展会相对容易，这是对软件实体之间通信的限制，迪米特法则要求限制软件实体之间通信的宽度和深度。==迪米特法则可降低系统的耦合度，使类与类之间保持松散的耦合关系。==</p>
<p>迪米特法则还有几种定义形式，包括：<strong>不要和“陌生人”说话、只与你的直接朋友通信等</strong>。</p>
<p>迪米特法则要求我们在设计系统时，==应该尽量减少对象之间的交互，如果两个对象之间不必彼此直接通信，那么这两个对象就不应当发生任何直接的相互作用，如果其中的一个对象需要调用另一个对象的某一个方法的话，可以通过第三者转发这个调用。简言之，就是通过引入一个合理的第三者来降低现有对象之间的耦合度。==</p>
<p>在将迪米特法则运用到系统设计中时，要注意下面的几点：==在类的划分上，应当尽量创建松耦合的类，类之间的耦合度越低，就越有利于复用，一个处在松耦合中的类一旦被修改，不会对关联的类造成太大波及；在类的结构设计上，每一个类都应当尽量降低其成员变量和成员函数的访问权限；在类的设计上，只要有可能，一个类型应当设计成不变类；在对其他类的引用上，一个对象对其他对象的引用应当降到最低。==</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/02/2017-08-02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/02/2017-08-02/" itemprop="url">正则表达式总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-02T00:00:00+08:00">
                2017-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="正则表达式总结"><a href="#正则表达式总结" class="headerlink" title="正则表达式总结"></a>正则表达式总结</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 直接实例化</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern [, flags]);</span><br><span class="line"><span class="comment">// 隐式创建(推荐)</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/pattern/</span>flags;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>参数 pattern 是一个字符串，指定了正则表达式的模式或其他正则表达式。</p>
</li>
<li><p>参数 [, flags] 是一个可选的字符串，包含属性 “g”（global ）、”i” （ignoreCase）和 “m”（multiline）。</p>
</li>
</ul>
<h3 id="子表达式"><a href="#子表达式" class="headerlink" title="子表达式"></a>子表达式</h3><p>在正则表达式中，使用括号括起来的内容是一个<strong>子表达式</strong>，子表达式匹配到的内容会被系统捕获至缓冲区，使用<strong>\n（n：数字）</strong>来反向引用系统的第n号缓冲区的内容。</p>
<p><strong>使用场景：后面的内容要求与前面的一致，可以使用子表达式</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 查找连续相同的四个数字</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"1212ab45677778cd"</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\d)\1\1\1/gi</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.match(reg));</span><br><span class="line"><span class="comment">// OUTPUT:7777</span></span><br></pre></td></tr></table></figure>
<h3 id="方括号（字符簇）"><a href="#方括号（字符簇）" class="headerlink" title="方括号（字符簇）"></a>方括号（字符簇）</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Is this all there is?"</span>;</span><br><span class="line"><span class="keyword">var</span> patt1 = <span class="regexp">/[a-h]/g</span>;</span><br><span class="line"><span class="built_in">document</span>.write(str.match(patt1));</span><br><span class="line"><span class="comment">// OUTPUT:h,a,h,e,e</span></span><br></pre></td></tr></table></figure>
<p>方括号    作用</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[abc]	查找方括号之间的任何字符。</span><br><span class="line">[^abc]查找任何不在方括号之间的字符。</span><br><span class="line">[0-9]	查找任何从 0 至 9 的数字。同 \d</span><br><span class="line">[a-z]	查找任何从小写 a 到小写 z 的字符。</span><br><span class="line">[A-Z]	查找任何从大写 A 到大写 Z 的字符。</span><br><span class="line">[A-z]	查找任何从大写 A 到小写 z 的字符。</span><br><span class="line">[0-9a-zA-Z]	查找0-9,a-z,A-Z</span><br></pre></td></tr></table></figure>
<h3 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">元字符（Metacharacter）是拥有特殊含义的字符：</span><br><span class="line">元字符 | 作用</span><br><span class="line">—|—</span><br><span class="line">\ | 转义符 （、）、/、\</span><br><span class="line">| | 选择匹配符，可以匹配多个规则</span><br><span class="line">. | 查找单个字符，除了换行和行结束符。</span><br><span class="line">\w | 查找单词字符。字符 ( 字母 ，数字，下划线_ )</span><br><span class="line">\W | 查找非单词字符。</span><br><span class="line">\d | 查找数字。</span><br><span class="line">\D | 查找非数字字符。</span><br><span class="line">\s | 查找空白字符。空格</span><br><span class="line">\S | 查找非空白字符。</span><br><span class="line">\b | 匹配单词边界。</span><br><span class="line">\B | 匹配非单词边界。</span><br><span class="line">\0 | 查找 NUL 字符。</span><br><span class="line">\n | 查找换行符。</span><br><span class="line">\f | 查找换页符。</span><br><span class="line">\r | 查找回车符。</span><br><span class="line">\t | 查找制表符。</span><br><span class="line">\v | 查找垂直制表符。</span><br><span class="line">\xxx | 查找以八进制数 xxx 规定的字符。</span><br><span class="line">\xdd | 查找以十六进制数 dd 规定的字符。</span><br><span class="line">\uxxxx | 查找以十六进制数 xxxx 规定的 Unicode 字符。</span><br></pre></td></tr></table></figure>
<h3 id="量词"><a href="#量词" class="headerlink" title="量词"></a>量词</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">量词	作用</span><br><span class="line">n+	匹配任何包含至少一个 n 的字符串。同 &#123;1,&#125;</span><br><span class="line">n*	匹配任何包含零个或多个 n 的字符串。同 &#123;0,&#125;</span><br><span class="line">n?	匹配任何包含零个或一个 n 的字符串。同 &#123;0,1&#125;</span><br><span class="line">n&#123;X&#125;	匹配包含 X 个 n 的序列的字符串。</span><br><span class="line">n&#123;X,Y&#125;	匹配包含 X 至 Y 个 n 的序列的字符串。</span><br><span class="line">n&#123;X,&#125;	匹配包含至少 X 个 n 的序列的字符串。</span><br><span class="line">n$	匹配任何结尾为 n 的字符串。</span><br><span class="line">^n	匹配任何开头为 n 的字符串。注意 /[^a] / 和 /^ [a]/是不一样的，前者是排除的，后者是代表首位。</span><br><span class="line">(?=n)	匹配任何其后紧接指定字符串 n 的字符串。正向预查</span><br><span class="line">(?!n)	匹配任何其后没有紧接指定字符串 n 的字符串。反向预查</span><br></pre></td></tr></table></figure>
<h2 id="RegExp-对象方法"><a href="#RegExp-对象方法" class="headerlink" title="RegExp 对象方法"></a>RegExp 对象方法</h2><h3 id="test"><a href="#test" class="headerlink" title="test()"></a>test()</h3><p><code>test()</code> 方法检索字符串中是否存在指定的值。返回值是 true 或 false。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var patt1 = new RegExp(&apos;e&apos;);</span><br><span class="line">console.log(patt1.test(&apos;some text&apos;));</span><br><span class="line">// OUTPUT:true</span><br><span class="line">var patt2 = new RegExp(&apos;ee&apos;);</span><br><span class="line">console.log(patt2.test(&apos;some text&apos;));</span><br><span class="line">// OUTPUT:false</span><br></pre></td></tr></table></figure>
<h3 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h3><p><code>exec()</code> 方法检索字符串中的指定值。返回值是被找到的值。如果没有发现匹配，则返回 null。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> patt1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'e'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(patt1.exec(<span class="string">'some text'</span>));</span><br><span class="line"><span class="comment">// OUTPUT:e</span></span><br><span class="line"><span class="keyword">var</span> patt2 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'ee'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(patt2.exec(<span class="string">'some text'</span>));</span><br><span class="line"><span class="comment">// OUTPUT:null</span></span><br></pre></td></tr></table></figure>
<h3 id="compile"><a href="#compile" class="headerlink" title="compile()"></a>compile()</h3><p><code>compile()</code> 既可以改变检索模式，也可以添加或删除第二个参数。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> patt1=<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"e"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(patt1.test(<span class="string">"The best things in life are free"</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="comment">// 改变了检索模式</span></span><br><span class="line">patt1.compile(<span class="string">"eee"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(patt1.test(<span class="string">"The best things in life are free"</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="支持正则表达式的-String-对象的方法"><a href="#支持正则表达式的-String-对象的方法" class="headerlink" title="支持正则表达式的 String 对象的方法"></a>支持正则表达式的 String 对象的方法</h2><h3 id="search-检索与正则表达式相匹配的值，输出所在位置。"><a href="#search-检索与正则表达式相匹配的值，输出所在位置。" class="headerlink" title="search 检索与正则表达式相匹配的值，输出所在位置。"></a>search 检索与正则表达式相匹配的值，输出所在位置。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Visit W3School!"</span></span><br><span class="line"><span class="built_in">console</span>.log(str.search(<span class="regexp">/W3School/</span>))</span><br><span class="line"><span class="comment">// OUTPUT:6</span></span><br></pre></td></tr></table></figure>
<h3 id="match-找到一个或多个正则表达式的匹配。"><a href="#match-找到一个或多个正则表达式的匹配。" class="headerlink" title="match 找到一个或多个正则表达式的匹配。"></a>match 找到一个或多个正则表达式的匹配。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">"1 plus 2 equal 3"</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/\d+/g</span>))</span><br><span class="line"><span class="comment">// OUTPUT:1,2,3</span></span><br></pre></td></tr></table></figure>
<h3 id="replace-替换与正则表达式匹配的子串。"><a href="#replace-替换与正则表达式匹配的子串。" class="headerlink" title="replace 替换与正则表达式匹配的子串。"></a>replace 替换与正则表达式匹配的子串。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Visit Microsoft!"</span></span><br><span class="line"><span class="built_in">console</span>.log(str.replace(<span class="regexp">/Microsoft/</span>, <span class="string">"W3School"</span>));</span><br><span class="line"><span class="comment">// OUTPUT:Visit W3School!</span></span><br></pre></td></tr></table></figure>
<h3 id="split-把字符串分割为字符串数组。"><a href="#split-把字符串分割为字符串数组。" class="headerlink" title="split 把字符串分割为字符串数组。"></a>split 把字符串分割为字符串数组。</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"How are you doing today?"</span></span><br><span class="line"><span class="built_in">document</span>.write(str.split(<span class="regexp">/\s+/</span>));</span><br><span class="line"><span class="comment">// OUTPUT:How,are,you,doing,today?</span></span><br></pre></td></tr></table></figure>
<h2 id="常见的正则验证"><a href="#常见的正则验证" class="headerlink" title="常见的正则验证"></a>常见的正则验证</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见的 正则表达式 校验</span></span><br><span class="line"><span class="comment">// QQ号、手机号、Email、是否是数字、去掉前后空格、是否存在中文、邮编、身份证、URL、日期格式、IP</span></span><br><span class="line"><span class="keyword">var</span> myRegExp = &#123;</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法QQ号码</span></span><br><span class="line">    isQQ: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 1 首位不能是0  ^[1-9]</span></span><br><span class="line">        <span class="comment">// 2 必须是 [5, 11] 位的数字  \d&#123;4, 9&#125;</span></span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^[1-9][0-9]&#123;4,9&#125;$/gim</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'QQ号码格式输入正确'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'请输入正确格式的QQ号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法手机号码</span></span><br><span class="line">    isPhone: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^(0|86|17951)?(13[0-9]|15[012356789]|18[0-9]|14[57]|17[678])[0-9]&#123;8&#125;$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'手机号码格式输入正确'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'请输入正确格式的手机号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法Email地址</span></span><br><span class="line">    isEmail: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/</span>;</span><br><span class="line">        <span class="comment">// var reg = /\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;</span></span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'Email格式输入正确'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'请输入正确格式的Email'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否是数字</span></span><br><span class="line">    isNumber: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^\d+$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">'是数字'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">'不是数字'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 去掉前后空格</span></span><br><span class="line">    trim: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^\s+|\s+$/g</span>;</span><br><span class="line">        <span class="keyword">return</span> str.replace(reg, <span class="string">''</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否存在中文</span></span><br><span class="line">    isChinese: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/[\u4e00-\u9fa5]/gm</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 中存在中文'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 中不存在中文'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法邮政编码</span></span><br><span class="line">    isPostcode: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 起始数字不能为0，然后是5个数字  [1-9]\d&#123;5&#125;</span></span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^[1-9]\d&#123;5&#125;$/g</span>;</span><br><span class="line">        <span class="comment">// var reg = /^[1-9]\d&#123;5&#125;(?!\d)$/;</span></span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的邮编格式'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的邮编格式'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法身份证号码</span></span><br><span class="line">    isIDcard: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^(^[1-9]\d&#123;7&#125;((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d&#123;3&#125;$)|(^[1-9]\d&#123;5&#125;[1-9]\d&#123;3&#125;((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d&#123;4&#125;)|\d&#123;3&#125;[Xx])$)$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的身份证号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的身份证号码'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法URL</span></span><br><span class="line">    isURL: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&amp;?[a-zA-Z0-9_-](\?)?)*)*$/i</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的URL'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的URL'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法日期格式 yyyy-mm-dd</span></span><br><span class="line">    isDate: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^[1-2][0-9][0-9][0-9]-[0-1]&#123;0,1&#125;[0-9]-[0-3]&#123;0,1&#125;[0-9]$/</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的日期格式'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的日期格式，yyyy-mm-dd'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 检查字符串是否为合法IP地址</span></span><br><span class="line">    isIP: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 1.1.1.1  四段  [0 , 255]</span></span><br><span class="line">        <span class="comment">// 第一段不能为0</span></span><br><span class="line">        <span class="comment">// 每个段不能以0开头</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 本机IP: 58.50.120.18 湖北省荆州市 电信</span></span><br><span class="line">        <span class="keyword">var</span> reg = <span class="regexp">/^([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\.([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))&#123;3&#125;$/gi</span>;</span><br><span class="line">        <span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是合法的IP地址'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(str + <span class="string">' 是不合法的IP地址'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isQQ('80583600'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isPhone('17607160722'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isEmail('80583600@qq.com'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isNumber('100a'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.trim('  100  '));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isChinese('baixiaoming'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isChinese('小明'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isPostcode('412345'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isIDcard('42091119940927001X'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isURL('https://www.baidu.com/'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isDate('2017-4-4'));</span></span><br><span class="line"><span class="comment">// console.log(myRegExp.isIP('1.0.0.0'));</span></span><br></pre></td></tr></table></figure>
<h2 id="校验数字的表达式"><a href="#校验数字的表达式" class="headerlink" title="校验数字的表达式"></a>校验数字的表达式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">数字：^[0-9]*$</span><br><span class="line">n位的数字：^\d&#123;n&#125;$</span><br><span class="line">至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line">m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line">零和非零开头的数字：^(0|[1-9][0-9]*)$</span><br><span class="line">非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$</span><br><span class="line">正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line">有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line">非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$</span><br><span class="line">非零的负整数：^\-[1-9][]0-9&quot;*$ 或 ^-[1-9]\d*$</span><br><span class="line">非负整数：^\d+$ 或 ^[1-9]\d*|0$</span><br><span class="line">非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span><br><span class="line">非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span><br><span class="line">非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span><br><span class="line">正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span><br><span class="line">负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span><br><span class="line">浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span><br></pre></td></tr></table></figure>
<h2 id="校验字符的表达式"><a href="#校验字符的表达式" class="headerlink" title="校验字符的表达式"></a>校验字符的表达式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">汉字：^[\u4e00-\u9fa5]&#123;0,&#125;$</span><br><span class="line">英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span><br><span class="line">长度为3-20的所有字符：^.&#123;3,20&#125;$</span><br><span class="line">由26个英文字母组成的字符串：^[A-Za-z]+$</span><br><span class="line">由26个大写英文字母组成的字符串：^[A-Z]+$</span><br><span class="line">由26个小写英文字母组成的字符串：^[a-z]+$</span><br><span class="line">由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span><br><span class="line">由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;3,20&#125;$</span><br><span class="line">中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</span><br><span class="line">可以输入含有^%&amp;&apos;,;=?$\&quot;等字符：[^%&amp;&apos;,;=?$\x22]+</span><br><span class="line">禁止输入含有~的字符：[^~\x22]+</span><br></pre></td></tr></table></figure>
<h2 id="特殊需求的表达式"><a href="#特殊需求的表达式" class="headerlink" title="特殊需求的表达式"></a>特殊需求的表达式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span><br><span class="line">域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span><br><span class="line">InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$</span><br><span class="line">手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</span><br><span class="line">电话号码(&quot;XXX-XXXXXXX&quot;、&quot;XXXX-XXXXXXXX&quot;、&quot;XXX-XXXXXXX&quot;、&quot;XXX-XXXXXXXX&quot;、&quot;XXXXXXX&quot;和&quot;XXXXXXXX)：^(\(\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$</span><br><span class="line">国内电话号码(0511-4405222、021-87888822)：\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;</span><br><span class="line">身份证号(15位、18位数字)：^\d&#123;15&#125;|\d&#123;18&#125;$</span><br><span class="line">短身份证号码(数字、字母x结尾)：^([0-9])&#123;7,18&#125;(x|X)?$ 或 ^\d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$</span><br><span class="line">帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</span><br><span class="line">密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;5,17&#125;$</span><br><span class="line">强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</span><br><span class="line">日期格式：^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;</span><br><span class="line">一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line">一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$</span><br><span class="line">xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$</span><br><span class="line">中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line">双字节字符：[^\x00-\xff]    (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))</span><br><span class="line">空白行的正则表达式：\n\s*\r    (可以用来删除空白行)</span><br><span class="line">HTML标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;.*?&lt;/\1&gt;|&lt;.*? /&gt;    (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line">首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$)    (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line">腾讯QQ号：[1-9][0-9]&#123;4,&#125;    (腾讯QQ号从10000开始)</span><br><span class="line">中国邮政编码：[1-9]\d&#123;5&#125;(?!\d)    (中国邮政编码为6位数字)</span><br><span class="line">IP地址：\d+\.\d+\.\d+\.\d+    (提取IP地址时有用)</span><br><span class="line">IP地址：((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.)&#123;3&#125;(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))</span><br></pre></td></tr></table></figure>
<h2 id="钱的输入格式"><a href="#钱的输入格式" class="headerlink" title="钱的输入格式"></a>钱的输入格式</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1.有四种钱的表示形式我们可以接受:&quot;10000.00&quot; 和 &quot;10,000.00&quot;, 和没有 &quot;分&quot; 的 &quot;10000&quot; 和 &quot;10,000&quot;：^[1-9][0-9]*$</span><br><span class="line">2.这表示任意一个不以0开头的数字,但是,这也意味着一个字符&quot;0&quot;不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$</span><br><span class="line">3.一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</span><br><span class="line">4.这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$</span><br><span class="line">5.必须说明的是,小数点后面至少应该有1位数,所以&quot;10.&quot;是不通过的,但是 &quot;10&quot; 和 &quot;10.2&quot; 是通过的：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">7.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">8.1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">备注：这就是最终结果了,别忘了&quot;+&quot;可以用&quot;*&quot;替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/2017-07-17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/17/2017-07-17/" itemprop="url">+a、NaN</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-17T00:00:00+08:00">
                2017-07-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="关于-a"><a href="#关于-a" class="headerlink" title="关于+a"></a>关于+a</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+a是转为number类型，同parseInt(a)</span><br><span class="line">    var a = 1;</span><br><span class="line">    console.log(+a);    //parseInt(a)=1</span><br><span class="line">    console.log(a); //1</span><br></pre></td></tr></table></figure>
<h3 id="NaN"><a href="#NaN" class="headerlink" title="NaN"></a>NaN</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="literal">NaN</span> == <span class="literal">NaN</span>   <span class="comment">//false</span></span><br><span class="line"><span class="literal">NaN</span> === <span class="literal">NaN</span>  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/2017-06-28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/2017-06-28/" itemprop="url">Mac环境变量配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-28T00:00:00+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mac环境变量配置"><a href="#Mac环境变量配置" class="headerlink" title="Mac环境变量配置"></a>Mac环境变量配置</h1><p>mac一般使用<code>bash</code>作为默认shell，如果安装了oh my sh，则默认使用<code>zsh</code>shell。</p>
<h2 id="Mac系统环境变量的加载顺序："><a href="#Mac系统环境变量的加载顺序：" class="headerlink" title="Mac系统环境变量的加载顺序："></a>Mac系统环境变量的加载顺序：</h2><p><code>/etc/profile</code><br><code>/etc/paths</code><br><code>~/.bash_profile</code><br><code>~/.bash_login</code><br><code>~/.profile</code><br><code>~/.bashrc</code></p>
<ul>
<li><code>/etc/profile</code>和<code>/etc/paths</code>是系统级别的，系统启动后就会加载。后面几个是当前用户级的环境变量。</li>
<li>如果<code>~/.bash_profile</code>存在，后面几个文件就会忽略不读，不存在时，才会以此类推读取后面的文件。</li>
<li><code>~/.bashrc</code>没有上述规则，他始终加载，他是在<code>bash shell</code>打开的时候载入的。</li>
</ul>
<h2 id="设置Path的语法"><a href="#设置Path的语法" class="headerlink" title="设置Path的语法"></a>设置Path的语法</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 中间使用冒号分隔</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:&lt;PATH 1&gt;:&lt;PATH 2&gt;:&lt;PATH 3&gt;:------:&lt;PATH N&gt;</span><br></pre></td></tr></table></figure>
<h2 id="全局设置"><a href="#全局设置" class="headerlink" title="全局设置"></a>全局设置</h2><p>下面的几个文件设置是全局的，修改时需要root权限</p>
<ul>
<li><code>/etc/paths</code> （全局建议修改这个文件 ）<br>编辑 paths，将环境变量添加到 paths文件中 ，一行一个路径.</li>
</ul>
<p>/etc/paths 文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/bin</span><br><span class="line">/usr/bin</span><br><span class="line">/bin</span><br><span class="line">/usr/sbin</span><br><span class="line">/sbin</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>/etc/profile</code> （建议不修改这个文件 ）<br>全局（公有）配置，不管是哪个用户，登录时都会读取该文件。</p>
</li>
<li><p><code>/etc/bashrc</code> （一般在这个文件中添加系统级环境变量）<br>全局（公有）配置，bash shell执行时，不管是何种方式，都会读取此文件。</p>
</li>
</ul>
<h2 id="单个用户设置"><a href="#单个用户设置" class="headerlink" title="单个用户设置"></a>单个用户设置</h2><ul>
<li><code>~/.bash_profile</code> （添加用户级环境变量）<br><strong>（注：Linux 里面是 .bashrc 而 Mac 是 .bash_profile）</strong><br>若<code>bash shell</code>是以login方式执行时，才会读取此文件，该文件仅仅执行一次，默认情况下，他设置一些环境变量。<br>设置命令别名</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> ll=’ls -la’</span><br></pre></td></tr></table></figure>
<p>设置环境变量：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/opt/<span class="built_in">local</span>/bin:/opt/<span class="built_in">local</span>/sbin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<p>比如设置<code>ANDROID_HOME</code>到PATH：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ANDROID_HOME=/Users/shaoc/Library/Android/sdk</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ANDROID_HOME</span>/tools:<span class="variable">$ANDROID_HOME</span>/platform-tools:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>~/.bashrc</code> 同上</li>
</ul>
<p>一般重启shell设置就会生效，如果想立刻生效，则可执行下面的语句：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">source</span> 相应的文件</span><br></pre></td></tr></table></figure>
<h2 id="zsh中配置环境变量"><a href="#zsh中配置环境变量" class="headerlink" title="zsh中配置环境变量"></a>zsh中配置环境变量</h2><p>在安装了<code>oh my zsh</code>后， <code>.bash_profile</code> 文件中的环境变量就无法起到作用，因为终端默认启动的是<code>zsh</code>，而不是<code>bash shell</code>，所以无法加载。</p>
<p>解决方法1：</p>
<p>在<code>~/.zshrc</code>配置文件中，增加对<code>.bash_profile</code>的引用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>.bash_profile文件示例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ANDROID_HOME=/Users/pengdan/software/sdk</span><br><span class="line"><span class="built_in">export</span> NDK=/Users/pengdan/software/android-ndk-r10d</span><br><span class="line"><span class="built_in">export</span> GRADLE_HOME=/Users/pengdan/software/gradle-2.4</span><br><span class="line"><span class="built_in">export</span> SUBLIME=/Users/pengdan/home/subin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ANDROID_HOME</span>/tools:<span class="variable">$ANDROID_HOME</span>/platform-tools:<span class="variable">$GRADLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SUBLIME</span>:/usr/<span class="built_in">local</span>/mysql/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/Users/pengdan/software/apache-tomcat-7.0.70/bin</span><br></pre></td></tr></table></figure>
<p>解决方法2:<br>可以使用zsh的方法进行配置：<br>（1）可以直接在<code>~/.zshrc</code>中添加path或者环境变量<br>（2）在目录<code>~/oh-my-zsh/custom</code>文件夹下的任何<code>.zsh</code>文件中的环境变量都将会加载。</p>
<p>.zshrc:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Path to your oh-my-zsh installation.</span></span><br><span class="line"><span class="built_in">export</span> ZSH=/Users/shaoc/.oh-my-zsh</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$ZSH</span>/oh-my-zsh.sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> zshconfig=<span class="string">"vim ~/.zshrc"</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>~/oh-my-zsh/custom/my.zsh:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">alias</span> subl=\<span class="string">''</span>/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl<span class="string">'\'</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/24/2017-05-24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/24/2017-05-24/" itemprop="url">关于Homebrew</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">
                2017-05-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Homebrew介绍"><a href="#Homebrew介绍" class="headerlink" title="Homebrew介绍"></a>Homebrew介绍</h1><p>官网<a href="https://brew.sh/index_zh-cn.html" target="_blank" rel="noopener">https://brew.sh/index_zh-cn.html</a></p>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p><code>Homebrew</code>是macOs下的一个软件包管理器,它是为macOs安装一些Unix上的工具最简单好用灵活的一种方式。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>粘贴下面命令到终端并执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>使用 <code>--verbose</code> 或 <code>-v</code>，很多命令会打印出额外的调试和安装信息</p>
<ul>
<li><code>$ brew --version</code>   查看版本</li>
<li><code>$ brew install formula</code> 安装软件包</li>
<li><code>$ brew uninstall formula</code> 卸载某个软件包</li>
<li><code>$ brew update</code>  更新homebrew到最新版</li>
<li><code>$ brew list</code>  列出所有安装的软件包</li>
<li><code>$ brew search formula</code>  搜索某个软件包</li>
</ul>
<p>更多命令<a href="http://docs.brew.sh/Manpage.html" target="_blank" rel="noopener">http://docs.brew.sh/Manpage.html</a></p>
<h2 id="他能做什么"><a href="#他能做什么" class="headerlink" title="他能做什么"></a>他能做什么</h2><ul>
<li><p>可以使用 <code>Homebrew</code> 安装 Apple 没有预装但你需要的东西，比如</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ brew install wget</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Homebrew</code>会将软件包安装到独立目录，并将其文件软链接至 <code>/usr/local</code> 。</p>
</li>
<li><p><code>Homebrew</code> 不会将文件安装到它本身目录之外，所以您可将 <code>Homebrew</code> 安装到任意位置。</p>
</li>
<li><p>轻松创建你自己的 <code>Homebrew</code> 包。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew create https://foo.com/bar-1.0.tgz</span><br><span class="line">Created /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/bar.rb</span><br></pre></td></tr></table></figure>
</li>
<li><p>完全基于 <code>git</code> 和 <code>ruby</code>，所以自由修改的同时你仍可以轻松撤销你的变更或与上游更新合并。</p>
</li>
<li><p><code>Homebrew</code> 的配方都是简单的 <code>Ruby</code> 脚本：</p>
  <figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wget</span> &lt; Formula</span></span><br><span class="line">  homepage <span class="string">"https://www.gnu.org/software/wget/"</span></span><br><span class="line">  url <span class="string">"https://ftp.gnu.org/gnu/wget/wget-1.15.tar.gz"</span></span><br><span class="line">  sha256 <span class="string">"52126be8cf1bddd7536886e74c053ad7d0ed2aa89b4b630f76785bac21695fcd"</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">install</span></span></span><br><span class="line">    system <span class="string">"./configure"</span>, <span class="string">"--prefix=<span class="subst">#&#123;prefix&#125;</span>"</span></span><br><span class="line">    system <span class="string">"make"</span>, <span class="string">"install"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Homebrew</code> 使 macOS 更完整。使用 <code>gem</code> 来安装 <code>gems</code>、用 <code>brew</code> 来安装那些依赖包。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/26/Cordova中的Config.xml配置文件详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/26/Cordova中的Config.xml配置文件详解/" itemprop="url">Cordova、Config.xml中几个重要配置解释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-26T10:43:15+08:00">
                2017-04-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p><code>Config.xml</code>存储着cordova应用的全局配置信息。</p>
<p>本文重点解释了config.xml中的几个常用配置，比如：<code>access</code> <code>allow-navigation</code> <code>allow-intent</code> 等。</p>
<p>更多信息请查看<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html" target="_blank" rel="noopener">官方参考文档</a>。</p>
<h3 id="widget、name、description、author"><a href="#widget、name、description、author" class="headerlink" title="widget、name、description、author"></a>widget、name、description、author</h3><ul>
<li>widget：<code>config.xml</code>中的根元素</li>
<li>name：指定app名，它会显示在设备的主屏幕上</li>
<li>description：app描述</li>
<li>author：作者信息</li>
</ul>
<h3 id="content"><a href="#content" class="headerlink" title="content"></a>content</h3><p>指定app的根页面，默认是<code>index.html</code><br>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;widget ...&gt;</span><br><span class="line">   &lt;content src=&quot;startPage.html&quot;&gt;&lt;/content&gt;</span><br><span class="line">&lt;/widget&gt;</span><br></pre></td></tr></table></figure>
<h3 id="access"><a href="#access" class="headerlink" title="access"></a>access</h3><p>配置允许app发起的网络请求（images, XHRs, etc）地址</p>
<p>注意：没有配置<code>access</code>标签时，，只有<code>file://</code>urls被允许访问。但一般情况，app包含一个默认的<code>&lt;access origin=&quot;*&quot;&gt;</code>标签。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--允许访问 google.com:--&gt;</span><br><span class="line">&lt;access origin=&quot;http://google.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--允许访问安全地址 google.com (https://):--&gt;</span><br><span class="line">&lt;access origin=&quot;https://google.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--允许访问 google.com 的所有子域名, 比如 mail.google.com and docs.google.com:--&gt;</span><br><span class="line">&lt;access origin=&quot;http://*.google.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--不阻止任何网络请求，比如 google.com and developer.mozilla.org:--&gt;</span><br><span class="line">&lt;access origin=&quot;*&quot; /&gt;</span><br><span class="line">&lt;!--This is the default value for newly created CLI projects.--&gt;</span><br></pre></td></tr></table></figure>
<p>更多请查看<a href="https://cordova.apache.org/docs/en/6.x/reference/cordova-plugin-whitelist/index.html#network-request-whitelist" target="_blank" rel="noopener">network-request-whitelist</a></p>
<h3 id="allow-navigation"><a href="#allow-navigation" class="headerlink" title="allow-navigation"></a>allow-navigation</h3><p>控制内部的<code>WebView</code>可以加载的<code>URL</code>，只适用于顶级导航。</p>
<p>默认情况下，只允许<code>file://</code>类型的URLS访问。如果要加载其他的urls，需要配置<code>&lt;allow-navigation&gt;</code>标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 允许访问 example.com --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;http://example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许使用通配符，协议，主机，地址都可以使用 --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;*://*.example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 使用通配符，允许所有网址访问，包括HTTP and HTTPS and file</span><br><span class="line">     *不推荐使用* --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 上面的和下面这三条等价 --&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;http://*/*&quot; /&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;https://*/*&quot; /&gt;</span><br><span class="line">&lt;allow-navigation href=&quot;data:*&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>更多请查看<a href="https://cordova.apache.org/docs/en/6.x/reference/cordova-plugin-whitelist/index.html#navigation-whitelist" target="_blank" rel="noopener">cordova-plugin-whitelist</a></p>
<h3 id="allow-intent"><a href="#allow-intent" class="headerlink" title="allow-intent"></a>allow-intent</h3><p>定义app可以要求操作系统打开的链接地址，默认，任何外部请求链接都被禁止。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 允许在浏览器中打开网址 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;http://*/*&quot; /&gt;</span><br><span class="line">&lt;allow-intent href=&quot;https://*/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在浏览器中打开 example.com --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;http://example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许通配符的使用，在协议、主机、地址 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;*://*.example.com/*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在短信应用中打开sms:链接 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;sms:*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在电话应用中打开tel:链接 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;tel:*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在地图应用中打开geo:链接 --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;geo:*&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 允许在已安装的app中打开未被识别的url地址</span><br><span class="line">     *NOT RECOMMENDED* --&gt;</span><br><span class="line">&lt;allow-intent href=&quot;*&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>查看更多<a href="https://cordova.apache.org/docs/en/6.x/reference/cordova-plugin-whitelist/index.html#intent-whitelist" target="_blank" rel="noopener">cordova-plugin-whitelist</a></p>
<h3 id="engine"><a href="#engine" class="headerlink" title="engine"></a>engine</h3><p>Specifies details about what platform to restore during a prepare.</p>
<h3 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h3><p>Specifies details about what plugin to restore during a prepare. This element is automatically added to a project’s config.xml when a plugin is added using the –save flag.</p>
<h3 id="variable"><a href="#variable" class="headerlink" title="variable"></a>variable</h3><p>Persists the value of a CLI variable to be used when restoring a plugin during a prepare. This element is added to config.xml when a plugin that uses CLI variables is added using the –save flag.</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;plugin name=&quot;cordova-plugin-device&quot; spec=&quot;^1.1.0&quot;&gt;</span><br><span class="line">    &lt;variable name=&quot;MY_VARIABLE&quot; value=&quot;my_variable_value&quot; /&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<h3 id="preference"><a href="#preference" class="headerlink" title="preference"></a>preference</h3><p>Sets various options as pairs of name/value attributes. Each preference’s name is case-insensitive. Many preferences are unique to specific platforms, and will be indicated as such.</p>
<p>配置详情：<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html#preference" target="_blank" rel="noopener">https://cordova.apache.org/docs/en/6.x/config_ref/index.html#preference</a></p>
<h3 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h3><p>If you use the CLI to build applications, you use the plugin command to enable device APIs. This does not modify the top-level config.xml file, so the element does not apply to your workflow. If you work directly in an SDK and using the platform-specific config.xml file as source, you use the tag to enable device-level APIs and external plugins. They often appear with custom values in platform-specific config.xml files. See the API Reference for details on how to specify each feature</p>
<p>更多请参考：<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html#feature" target="_blank" rel="noopener">feature</a></p>
<h3 id="platform"><a href="#platform" class="headerlink" title="platform"></a>platform</h3><p>When using the CLI to build applications, it is sometimes necessary to specify preferences or other elements specific to a particular platform.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;platform name=&quot;android&quot;&gt;</span><br><span class="line">   &lt;preference name=&quot;Fullscreen&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;/platform&gt;</span><br></pre></td></tr></table></figure>
<h3 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h3><p>Represents your custom script which will be called by Cordova when certain action occurs (for example, after plugin is added or platform prepare logic is invoked). This is useful when you need to extend default Cordova functionality. </p>
<p>更多请参考：<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html#hook" target="_blank" rel="noopener">https://cordova.apache.org/docs/en/6.x/config_ref/index.html#hook</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;hook type=&quot;after_plugin_install&quot; src=&quot;scripts/afterPluginInstall.js&quot; /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>date：2017-04-26 10:37:40<br>版本有变化时，配置可能发生变化，详细信息请参考<a href="https://cordova.apache.org/docs/en/6.x/config_ref/index.html" target="_blank" rel="noopener">官方文档</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/20/Angular-iframe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/20/Angular-iframe/" itemprop="url">Angular - iframe、DomSanitizer模块、单例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-20T14:45:55+08:00">
                2017-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Angular开发中的几个小知识点"><a href="#Angular开发中的几个小知识点" class="headerlink" title="Angular开发中的几个小知识点"></a>Angular开发中的几个小知识点</h1><h2 id="Angular使用iframe加载外部网站"><a href="#Angular使用iframe加载外部网站" class="headerlink" title="Angular使用iframe加载外部网站"></a>Angular使用iframe加载外部网站</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>项目中，需要使用iframe来加载一个外部网页，但src被Angular的默认安全策略所禁止，无法加载网页。</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>在Angular中，可以使用iframe用来加载一个外部链接地址，但是src需要使用<code>@angular/platform-browser</code>中的<code>DomSanitizer模块</code>中的<code>sanitizer.bypassSecurityTrustResourceUrl(url)</code>方法来特殊处理，因为Angular中有默认的安全规则会阻止链接的加载。</p>
<p>一个例子：</p>
<p>html:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--这样无法正常加载网页，被安全策略禁止--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> [<span class="attr">src</span>]=<span class="string">"link"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--需要这样使用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">'MainIframe'</span> [<span class="attr">src</span>]=<span class="string">"trust(link)"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--或直接处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">'MainIframe'</span> [<span class="attr">src</span>]=<span class="string">"sanitizer.bypassSecurityTrustResourceUrl(link)"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ts:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//引入DomSanitizer模块</span></span><br><span class="line"><span class="keyword">import</span> &#123; DomSanitizer &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">link:<span class="built_in">string</span> = <span class="string">'http://www.baidu.com'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> sanitizer: DomSanitizer</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hello IframeFull Component'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">trust(url) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.sanitizer.bypassSecurityTrustResourceUrl(url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>测试时间：2017-04-26<br>使用Angular版本： 2.2.1</p>
</blockquote>
<h2 id="Angular单例"><a href="#Angular单例" class="headerlink" title="Angular单例"></a>Angular单例</h2><p>angular2一个单例的写法</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Injectable&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;UserInterface&#125; <span class="keyword">from</span> <span class="string">"../interface/index"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这是一个单例模式的config，用于共享全局变量</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> Config &#123;</span><br><span class="line">    <span class="keyword">public</span> mode = <span class="string">'dev'</span>;                         <span class="comment">//运行模式 dev or release</span></span><br><span class="line">    <span class="comment">//   public hostURL = 'https://cnodejs.org/api/v1';     //http请求前缀</span></span><br><span class="line">    <span class="keyword">public</span> hostURL = <span class="string">'http://ionichina.com/api/v1'</span>;         <span class="comment">//http请求前缀</span></span><br><span class="line">    <span class="comment">// public hostURL = 'http://localhost:8100/api';         //http请求前缀</span></span><br><span class="line">    <span class="keyword">public</span> isIonic = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> pageLimit = <span class="number">15</span>;                       <span class="comment">//每页多少</span></span><br><span class="line">    <span class="keyword">public</span> DRAFTS_URL = <span class="string">'/data/drafts.json'</span>;     <span class="comment">//草稿本地地址</span></span><br><span class="line">    <span class="keyword">public</span> token: <span class="built_in">string</span> = <span class="string">''</span>;                   <span class="comment">//如果已经登录，存放token，请和localstorage.get('token')同步</span></span><br><span class="line">    <span class="keyword">public</span> loginUser: UserInterface;             <span class="comment">//如果已经登录，存放登录用户信息，请和本地存储保持同步</span></span><br><span class="line">    <span class="keyword">static</span> instance: Config;</span><br><span class="line">    <span class="keyword">static</span> isCreating: <span class="built_in">Boolean</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!Config.isCreating) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"You can't call new in Config Singleton instance!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> getInstance() &#123;</span><br><span class="line">        <span class="keyword">if</span> (Config.instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            Config.isCreating = <span class="literal">true</span>;</span><br><span class="line">            Config.instance = <span class="keyword">new</span> Config();</span><br><span class="line">            Config.isCreating = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Config.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ionic2在scss中访问主题颜色"><a href="#ionic2在scss中访问主题颜色" class="headerlink" title="ionic2在scss中访问主题颜色"></a>ionic2在scss中访问主题颜色</h2><p>通过在<code>scss</code>中引用主题颜色，可以增加程序的可维护性，当程序的主题颜色更改时，引用的地方随之自动更改。</p>
<p>使用<code>background-color: map-get($colors, primary)</code>来引用在主题中定义的颜色。</p>
<p>示例：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.progress-inner</span> &#123;</span><br><span class="line">        <span class="attribute">min-width</span>: <span class="number">15%</span>;</span><br><span class="line">        <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">        <span class="attribute">overflow</span>: hidden;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">4px</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">map-get</span>($colors, primary);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/11/Cordova应用中集成Crosswalk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/11/Cordova应用中集成Crosswalk/" itemprop="url">Cordova应用中集成Crosswalk</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-11T15:06:20+08:00">
                2017-04-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在cordova应用中集成crosswalk"><a href="#在cordova应用中集成crosswalk" class="headerlink" title="在cordova应用中集成crosswalk"></a>在cordova应用中集成crosswalk</h1><p><code>Crosswalk</code>是一款开源的Web引擎，其基于 Chromium/Blink 的应用运行环境，对于混合开发的轻量级应用尤为受欢迎。</p>
<p><code>crosswalk</code>是hybrid应用的运行时环境，它用来代替系统自带的<code>webview</code>，以保证应用行为的一致性（css一致，es6支持等），兼容性（完美支持WebRTC，WebAudio，Flexbox布局等）和提高流畅性（相比老旧安卓设备，因为它们自身的webview比较老旧）。</p>
<p>参考链接：<br><a href="https://crosswalk-project.org/" target="_blank" rel="noopener">crosswalk官网</a><br><a href="https://www.npmjs.com/package/cordova-plugin-crosswalk-webview/" target="_blank" rel="noopener">官方npm插件</a><br><a href="https://crosswalk-project.org/documentation/cordova.html" target="_blank" rel="noopener">crosswalk官网 - cordova应用步骤</a></p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li><code>webview</code>不再依赖于安卓版本，因为每个Android版本WebView的表现都有差别，可以最大限度降低Android碎片化的影响，得到一致的，可预测的行为。</li>
<li>兼容性更好，使用最新的Web技术及API，保证WebRTC, WebAudio, Web Components等</li>
<li>性能更好，与旧版本系统的老webview相比</li>
</ul>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>增大内存占用率，增加大约30MB</li>
<li>增大APK包的大小，大约17MB</li>
<li>增加安装后的磁盘占用空间，大约50MB</li>
<li><code>Crosswalk WebView</code>的本地存储(IndexedDB, LocalStorage, etc)和系统webview的相互独立</li>
</ul>
<h3 id="安装crosswalk插件"><a href="#安装crosswalk插件" class="headerlink" title="安装crosswalk插件"></a>安装crosswalk插件</h3><p>ionic2或者cordova应用中安装：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cordova plugin add cordova-plugin-crosswalk-webview --save</span><br></pre></td></tr></table></figure>
<p>构建：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cordova build android</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/29/windows下mongodb的安装和配置记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/29/windows下mongodb的安装和配置记录/" itemprop="url">Windows下MongoDB的安装配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-29T16:20:13+08:00">
                2017-03-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="windows下mongodb的安装配置"><a href="#windows下mongodb的安装配置" class="headerlink" title="windows下mongodb的安装配置"></a>windows下mongodb的安装配置</h1><p>2017年3月29日，系统：win10，mongodb version v3.4.2</p>
<h2 id="下载和安装"><a href="#下载和安装" class="headerlink" title="下载和安装"></a>下载和安装</h2><ol>
<li>下载地址：<a href="https://www.mongodb.com/download-center#community" target="_blank" rel="noopener">https://www.mongodb.com/download-center#community</a></li>
<li>下载符合你系统的版本，然后安装。默认安装到<code>C:\Program Files\MongoDB</code>,你也可以自定义安装目录。</li>
</ol>
<h2 id="创建数据目录"><a href="#创建数据目录" class="headerlink" title="创建数据目录"></a>创建数据目录</h2><p>MongoDB将数据目录存储在 db 目录下。但是这个数据目录不会主动创建，我们在安装完成后需要创建它。</p>
<p>请注意，<strong>数据目录应该放在根目录下</strong>（(如： C:\ 或者 D:\ 等 )。</p>
<p>这里我们假设创建数据目录在<code>E:\data\db</code></p>
<h2 id="命令行运行mogondb服务"><a href="#命令行运行mogondb服务" class="headerlink" title="命令行运行mogondb服务"></a>命令行运行mogondb服务</h2><p>假设你的mongodb安装在<code>C:\Program Files\MongoDB</code>:</p>
<p>进入安装目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Program Files\MongoDB\Server\3.4\bin</span><br></pre></td></tr></table></figure>
<p>启动服务：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongod.exe --dbpath e:\data\db</span><br></pre></td></tr></table></figure>
<h2 id="将MongoDB服务器作为Windows服务运行"><a href="#将MongoDB服务器作为Windows服务运行" class="headerlink" title="将MongoDB服务器作为Windows服务运行"></a>将MongoDB服务器作为Windows服务运行</h2><p>在命令行中启动服务之后，执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongod.exe --logpath <span class="string">"e:\data\dbConf\mongodb.log"</span> --logappend --dbpath <span class="string">"e:/data/db"</span> --port 27017 --serviceName <span class="string">"MongoDB"</span> --install</span><br></pre></td></tr></table></figure>
<p>终止命令行中的mongodb服务，打开刚才新建的mongodb服务：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">NET START MongoDB</span><br></pre></td></tr></table></figure>
<p>如果出现服务器无法正常启动的问题，是因为mongod.lock这个文件，在服务器异常退出时，该文件会影响下一次启动mongod服务的,我们首先关闭命令行mongodb服务，然后只需要删除该文件就行了：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mongod.exe --config e:\data\db\mongod.lock --remove</span><br></pre></td></tr></table></figure>
<blockquote>
<p>windows删除服务命令： <code>sc delete MongoDB</code></p>
</blockquote>
<p>说明：</p>
<p>请注意，你必须有管理权限才能运行下面的命令。执行以下命令将MongoDB服务器作为Windows服务运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongod.exe --bind_ip yourIPadress --logpath <span class="string">"C:\data\dbConf\mongodb.log"</span> --logappend --dbpath <span class="string">"C:\data\db"</span> --port yourPortNumber --serviceName <span class="string">"YourServiceName"</span> --serviceDisplayName <span class="string">"YourServiceName"</span> --install</span><br></pre></td></tr></table></figure>
<p>下表为mongodb启动的参数说明：</p>
<p>参数    描述</p>
<p>–bind_ip    绑定服务IP，若绑定127.0.0.1，则只能本机访问，不指定默认本地所有IP</p>
<p>–logpath    定MongoDB日志文件，注意是指定文件不是目录</p>
<p>–logappend    使用追加的方式写日志</p>
<p>–dbpath    指定数据库路径</p>
<p>–port    指定服务端口号，默认端口27017</p>
<p>–serviceName    指定服务名称</p>
<p>–serviceDisplayName    指定服务名称，有多个mongodb服务时执行。</p>
<p>–install    指定作为一个Windows服务安装。</p>
<h2 id="MongoDB后台管理-Shell"><a href="#MongoDB后台管理-Shell" class="headerlink" title="MongoDB后台管理 Shell"></a>MongoDB后台管理 Shell</h2><p>进入安装目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Program Files\MongoDB\Server\3.4\bin</span><br><span class="line">mongo.exe</span><br></pre></td></tr></table></figure>
<p><code>db</code> 命令用于查看当前操作的文档（数据库）</p>
<p>插入一些简单的记录并查找它：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; db.runoob.insert(&#123;x:10&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)</span><br><span class="line">&gt; db.runoob.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5604ff74a274a611b0c990aa&quot;), &quot;x&quot; : 10 &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文章写于，2017年3月29日，测试环境：mongodb版本 v3.4.2，操作系统win10</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/22/babel-cli入门使用步骤/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/22/babel-cli入门使用步骤/" itemprop="url">babel-cli入门使用步骤</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-22T00:00:00+08:00">
                2017-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h1><h2 id="babel-cli"><a href="#babel-cli" class="headerlink" title="babel-cli"></a>babel-cli</h2><p>项目中遇到了一个es6写的文件代码，在某些老的android设备的webview运行环境中不支持es6，比如<code>class</code>，<code>扩展运算符</code>等，使用这个解决方案：用<code>babel-cli</code>和<code>babel-preset-es2015</code>插件，把代码转为es5的代码。下面是具体步骤：</p>
<h3 id="1-全局安装babel-cli"><a href="#1-全局安装babel-cli" class="headerlink" title="1.全局安装babel-cli"></a>1.全局安装babel-cli</h3><p><code>$ npm install --global babel-cli</code></p>
<p><code>babel</code>提供命令行工具，用来在命令行转码，参考：<a href="http://babeljs.cn/docs/usage/cli/" target="_blank" rel="noopener">官方文档</a></p>
<p>基本用法如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 转码结果输出到标准输出</span></span><br><span class="line">$ babel example.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转码结果写入一个文件</span></span><br><span class="line"><span class="comment"># --out-file 或 -o 参数指定输出文件</span></span><br><span class="line">$ babel example.js --out-file compiled.js</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ babel example.js -o compiled.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># 整个目录转码</span></span><br><span class="line"><span class="comment"># --out-dir 或 -d 参数指定输出目录</span></span><br><span class="line">$ babel src --out-dir lib</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ babel src -d lib</span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 参数生成source map文件</span></span><br><span class="line">$ babel src -d lib -s</span><br></pre></td></tr></table></figure>
<h3 id="2-项目中新建-babelrc-配置文件"><a href="#2-项目中新建-babelrc-配置文件" class="headerlink" title="2.项目中新建.babelrc 配置文件"></a>2.项目中新建.babelrc 配置文件</h3><p><code>.babelrc</code>它是<code>babel</code>的配置文件，存放在项目的根目录下面，用来设置转码规则和插件。基本格式如下：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [</span><br><span class="line">      <span class="string">"es2015"</span>,</span><br><span class="line">      <span class="string">"react"</span>,</span><br><span class="line">      <span class="string">"stage-2"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"plugins"</span>: []</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>presets字段设定<code>转码规则</code>，官方提供以下的规则集，你可以根据需要安装。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ES2015转码规则</span></span><br><span class="line">$ npm install --save-dev babel-preset-es2015</span><br><span class="line"></span><br><span class="line"><span class="comment"># react转码规则</span></span><br><span class="line">$ npm install --save-dev babel-preset-react</span><br><span class="line"></span><br><span class="line"><span class="comment"># ES7不同阶段语法提案的转码规则（共有4个阶段），选装一个</span></span><br><span class="line">$ npm install --save-dev babel-preset-stage-0</span><br><span class="line">$ npm install --save-dev babel-preset-stage-1</span><br><span class="line">$ npm install --save-dev babel-preset-stage-2</span><br><span class="line">$ npm install --save-dev babel-preset-stage-3</span><br></pre></td></tr></table></figure>
<h3 id="3-安装es2015插件"><a href="#3-安装es2015插件" class="headerlink" title="3.安装es2015插件"></a>3.安装es2015插件</h3><p><code>$ npm install --save-dev babel-preset-es2015</code></p>
<p>修改配置文件为：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [</span><br><span class="line">      <span class="string">"es2015"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"plugins"</span>: []</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-在命令行中使用命令转码"><a href="#4-在命令行中使用命令转码" class="headerlink" title="4.在命令行中使用命令转码"></a>4.在命令行中使用命令转码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ babel example.js -o compiled.js</span><br></pre></td></tr></table></figure>
<h2 id="关于babel-node"><a href="#关于babel-node" class="headerlink" title="关于babel-node"></a>关于babel-node</h2><p>babel-cli工具自带一个<code>babel-node</code>命令，提供一个支持ES6的REPL环境。它支持Node的REPL环境的所有功能，而且可以直接运行ES6代码。<br>它不用单独安装，而是随<code>babel-cli</code>一起安装。然后，执行babel-node就进入PEPL环境。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ babel-node</span><br><span class="line">&gt; (x =&gt; x * 2)(1)</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p>babel-node命令可以直接运行ES6脚本。将上面的代码放入脚本文件es6.js，然后直接运行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ babel-node es6.js</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p>babel-node也可以安装在项目中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install --save-dev babel-cli</span><br></pre></td></tr></table></figure>
<p>然后，改写<code>package.json</code>。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"script-name"</span>: <span class="string">"babel-node script.js"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码中，使用babel-node替代node，这样script.js本身就不用做任何转码处理。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/22/ES6中5种遍历对象属性的方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/22/ES6中5种遍历对象属性的方法/" itemprop="url">ES6中5种遍历对象属性的方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-22T00:00:00+08:00">
                2017-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ES6中5种遍历对象属性的方法"><a href="#ES6中5种遍历对象属性的方法" class="headerlink" title="ES6中5种遍历对象属性的方法"></a>ES6中5种遍历对象属性的方法</h1><h3 id="5种遍历对象属性的方法："><a href="#5种遍历对象属性的方法：" class="headerlink" title="5种遍历对象属性的方法："></a>5种遍历对象属性的方法：</h3><ul>
<li><p>for…in<br><code>for...in</code>循环遍历自身的和继承的可枚举属性（不含Symbol属性）</p>
</li>
<li><p>Object.keys(obj)<br><code>Object.keys(obj)</code>返回一个数组，包括对象自身的（不含继承）所有可枚举属性（不含Symbol属性）</p>
</li>
<li><p>Object.getOwnPropertyNames(obj)<br><code>Object.getOwnPropertyNames(obj)</code>返回一个数组，包括对象自身（不含继承）所有属性（包括不可枚举的属性，不含Symbol属性）</p>
</li>
<li><p>Object.getOwnPropertySymbols(obj)<br><code>Object.getOwnPropertySymbols(obj)</code>返回一个数组，包括对象自身所有的Symbol属性</p>
</li>
<li><p>Reflect.ownKeys(obj)<br><code>Reflect.ownKeys(obj)</code>返回一个数组，包含对象自身的所有属性，不管属性名是Symbol或字符串，也不管是否可枚举</p>
</li>
</ul>
<p>###通过比较，可以得到结论：</p>
<ol>
<li>要想获得对象自身和它所继承的属性（可枚举的），必须用<code>for...in</code>，其它只与对象自身有关。</li>
<li><code>Object.keys(obj)</code>返回自身的<strong>可枚举属性</strong>。</li>
<li><code>Object.getOwnPropertyNames(obj)</code>比<code>Object.keys(obj)</code>多包含了对象自身的不可枚举属性。</li>
<li><code>Reflect.ownKeys(obj)</code>的返回结果是<code>Object.getOwnPropertyNames(obj)</code>和<code>Object.getOwnPropertySymbols(obj)</code>的合集。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/07/RxJs常用Operator记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/07/RxJs常用Operator记录/" itemprop="url">RxJs常用Operator记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-07T00:00:00+08:00">
                2017-03-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="RxJs中的operator"><a href="#RxJs中的operator" class="headerlink" title="RxJs中的operator"></a>RxJs中的operator</h1><h2 id="创建操作符"><a href="#创建操作符" class="headerlink" title="创建操作符"></a>创建操作符</h2><p>常见的有<code>Observable.forEvent()</code>,  <code>Observable.create()</code>, <code>Observable.interval()</code>。</p>
<h3 id="create"><a href="#create" class="headerlink" title="create"></a>create</h3><p><code>Observable.create()</code>：自定义创建一个<code>observable</code></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;Observable&#125; = <span class="built_in">require</span>(<span class="string">'rxjs/Observable'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/observable/of'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/operator/map'</span>);</span><br><span class="line"><span class="comment">//create创建操作符</span></span><br><span class="line"><span class="keyword">let</span> observable = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    observer.next(<span class="number">3</span>);</span><br><span class="line">    observer.next(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">observable.subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="interval"><a href="#interval" class="headerlink" title="interval"></a>interval</h3><p><code>interval(time:number)</code>:创建一个递增序列，每隔指定时间发送一条数据</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = Rx.Observable.interval(<span class="number">1000</span>);</span><br><span class="line">numbers.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));  <span class="comment">// 0 1 2 3 4 5 6 ......</span></span><br></pre></td></tr></table></figure>
<h3 id="of"><a href="#of" class="headerlink" title="of"></a>of</h3><p><code>public static of(values: ...T, scheduler: Scheduler): Observable&lt;T&gt;</code>: 从数组创建一个序列，一次将数据发射出去，然后发射完成命令</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = Rx.Observable.of(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">var</span> letters = Rx.Observable.of(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>);</span><br><span class="line"><span class="keyword">var</span> result = numbers.concat(letters);</span><br><span class="line">result.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));  <span class="comment">//10 20 30 a b c</span></span><br></pre></td></tr></table></figure>
<h2 id="变换操作符"><a href="#变换操作符" class="headerlink" title="变换操作符"></a>变换操作符</h2><p>对每一次返回数据做一次变换操作，把原本的数据流变成需要的数据流，最常使用的变换操作是<code>observable.map()</code></p>
<p>比如，数据获取接口经常会有一些规范去包裹数据，比如</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;err_code&quot;:0,</span><br><span class="line">    &quot;data&quot;:&#123;&quot;name&quot;:&quot;Operators&quot;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们只需要data字段，就可以使用map来实现：</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">observable.map(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.data;</span><br><span class="line">&#125;).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//do sth with data</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="过滤操作符filter"><a href="#过滤操作符filter" class="headerlink" title="过滤操作符filter"></a>过滤操作符filter</h2><p>用于过滤掉数据流中一些不需要处理的数据，常用的是<code>observable.filter()</code><br>比如，前端获取数据的时候，接口可能会因为各种原因无法返回最终需要的数据，可能由于异常返回的数据为空，或者返回一个错误代码和错误描述告知前端，但是并不需要处理这些错误信息，就需要过滤掉这些错误数据。</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//过滤操作符</span></span><br><span class="line">observable.filter(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !!response.data &amp;&amp; response.status === <span class="number">200</span>;</span><br><span class="line">&#125;).map(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> response.data;</span><br><span class="line">&#125;).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//do sth with data</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="组合操作符"><a href="#组合操作符" class="headerlink" title="组合操作符"></a>组合操作符</h2><p>很多业务场景需要依赖两个甚至更多的接口数据，并且在这些接口数据都成功获取后，再进行关联合并。要满足这种场景，就需要把各个数据流汇汇合组成新的数据流，这时就要用到<code>组合操作符</code>，比如<code>Observable.forkJoin()</code>,<code>Observable.prototype.concatMap()</code></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//组合操作符 Observable.forkJoin</span></span><br><span class="line"><span class="keyword">let</span> getFirstDataObs = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    observer.next(<span class="string">'a1'</span>);</span><br><span class="line">    observer.next(<span class="string">'a2'</span>);</span><br><span class="line">    observer.complete();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> getSecondDataObs = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    observer.next(<span class="string">'b1'</span>);</span><br><span class="line">    observer.next(<span class="string">'b2'</span>);</span><br><span class="line">    observer.complete();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> joinedObservable = Observable.forkJoin(</span><br><span class="line">    getFirstDataObs, getSecondDataObs</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">joinedObservable.subscribe(<span class="function"><span class="params">datas</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//data[0] 是getFirstDataObs 的数据</span></span><br><span class="line">    <span class="comment">//data[1] 是getSecondDataObs 的数据</span></span><br><span class="line">    <span class="comment">//只有在他两个都执行complete()之后，才会返回数据，且返回最后发送的数据</span></span><br><span class="line">    <span class="built_in">console</span>.log(datas);  <span class="comment">//[ 'a2', 'b2' ]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果某次请求数据需要依赖前一次请求的结果，也就是说两次请求必须有先后顺序，这时候可以使用<code>Observalbe.prototype.concatMap()</code>,示例：</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//concatMap</span></span><br><span class="line"><span class="keyword">let</span> getFirstDataObs = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.next(<span class="number">1</span>);&#125;, <span class="number">500</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.next(<span class="number">2</span>);&#125;, <span class="number">1000</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.next(<span class="number">3</span>);&#125;, <span class="number">1500</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">res</span>=&gt;</span> &#123; observer.complete();&#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> createSecondDataObs  = <span class="function">(<span class="params">firstData</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">        observer.next(firstData*<span class="number">10</span>+<span class="number">1</span>);</span><br><span class="line">        observer.next(firstData*<span class="number">10</span>+<span class="number">2</span>);</span><br><span class="line">        observer.next(firstData*<span class="number">10</span>+<span class="number">3</span>);</span><br><span class="line">        observer.complete();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> concatedObs = getFirstDataObs.concatMap(<span class="function"><span class="params">firstData</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createSecondDataObs(firstData);</span><br><span class="line">&#125;).subscribe(<span class="function"><span class="params">secondData</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//do sth with second data</span></span><br><span class="line">    <span class="built_in">console</span>.log(secondData); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>结果输出：<code>11 12 13 21 22 23 31 32 33</code></p>
<p>通过<code>Observable.prototype.concatMap()</code>方法，<code>getSecondDataObs()</code>的数据流被紧接在<code>getFirstDataObs()</code>的数据流后，并且最终被数据流被subscribe()所捕获。</p>
<h2 id="工具操作符"><a href="#工具操作符" class="headerlink" title="工具操作符"></a>工具操作符</h2><p>在Observable.prototype中有很多有用的工具方法，统称为工具操作符，如<code>delay</code>,<code>timeout</code>,<code>debounce</code>,<code>take</code>,<code>takeUntil</code>,<code>takeLast</code>,<code>takeWhile</code>,<code>skip</code>等等</p>
<h3 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h3><p><code>timeout</code>:当observable在指定时间内数据没有完全返回时，发出一个错误</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//工具操作符timeout</span></span><br><span class="line"><span class="keyword">let</span> observable = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">   observer.next(<span class="number">3</span>);</span><br><span class="line">   setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       observer.complete();</span><br><span class="line">   &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">observable.timeout(<span class="number">2000</span>).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">   <span class="comment">//do sth with data</span></span><br><span class="line">   <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;,<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">   handleError(err);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//当observable超过2000ms没有返回全部数据流（即返回complete时），便会抛出一个err错误，被handleError捕获。</span></span><br></pre></td></tr></table></figure>
<h3 id="delay"><a href="#delay" class="headerlink" title="delay"></a>delay</h3><p><code>delay</code>: 返回一个新序列，但是每个序列数据延迟指定时间<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-delay.png" alt="delay"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//延迟1000ms</span></span><br><span class="line">observable.delay(<span class="number">1000</span>).subscribe(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="debounceTime"><a href="#debounceTime" class="headerlink" title="debounceTime"></a>debounceTime</h3><p><code>public debounceTime(time: number)</code>: 和<code>delay</code>一样，也会延迟发送数据，但仅发送这一段时间内最新的<strong>一条</strong>消息，如果原序列在这段时间内没有发送消息，就不发送。比如可以用在，前台界面搜索框延迟500ms后自动发起api请求进行查询，或后台数据返回的太过频繁。<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-debounceTime-1.png" alt="debounceTime"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Observable.fromEvent(inputSelector,<span class="string">'keyup'</span>)</span><br><span class="line">    .debounceTime(<span class="number">500</span>)</span><br><span class="line">    .switchMap(<span class="function"><span class="params">event</span>=&gt;</span>getValue(event.target.value))</span><br><span class="line">    .subscribe(callback);</span><br></pre></td></tr></table></figure>
<h3 id="debounce"><a href="#debounce" class="headerlink" title="debounce"></a>debounce</h3><p><code>public debounce(durationSelector: function(value: T): SubscribableOrPromise): Observable</code>：和<code>debounceTime</code>类似，但它的发送时机不是由延迟时间决定，而是由另一个<code>observable</code>决定,</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="built_in">document</span>, <span class="string">'click'</span>);</span><br><span class="line"><span class="keyword">var</span> result = clicks.debounce(<span class="function"><span class="params">()</span> =&gt;</span> Rx.Observable.interval(<span class="number">1000</span>));</span><br><span class="line">result.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>
<h3 id="take"><a href="#take" class="headerlink" title="take"></a>take</h3><p><code>public take(count:number)</code>: 挑选出指定的前几个数据，作为新的序列，并complete<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-take.png" alt="take"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> interval = Rx.Observable.interval(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">var</span> five = interval.take(<span class="number">5</span>);  <span class="comment">//取出前5个数据</span></span><br><span class="line">five.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x)); <span class="comment">//0 1 2 3 4</span></span><br><span class="line"><span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### takeLast</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>takeLast(count:<span class="built_in">number</span>)<span class="string">`：挑选出原序列的最后count个数据，在complete时一起发送出去</span></span><br><span class="line"><span class="string">![takeLast](http://ol1ftyec4.bkt.clouddn.com/2017-03-07-takeLast.png)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>ts</span><br><span class="line"><span class="keyword">let</span> interval = Rx.Observable.interval(<span class="number">1000</span>).take(<span class="number">5</span>);</span><br><span class="line">five.takeLast(<span class="number">2</span>).subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x)); <span class="comment">//挑选出最后2个，打印：3 4</span></span><br></pre></td></tr></table></figure>
<h3 id="takeUntil"><a href="#takeUntil" class="headerlink" title="takeUntil"></a>takeUntil</h3><p><code>public takeUntil(notifier: Observable): Observable&lt;T&gt;</code>： 筛选原序列中数据，直到notifier发射出一个数据为止.(Lets values pass until a second Observable, notifier, emits something. Then, it completes.)</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> interval = Rx.Observable.interval(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="built_in">document</span>, <span class="string">'click'</span>);</span><br><span class="line"><span class="keyword">var</span> result = interval.takeUntil(clicks);  <span class="comment">//一直从原序列中取数据，直到点击事件发生为止</span></span><br><span class="line">result.subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>
<h3 id="takeWhile"><a href="#takeWhile" class="headerlink" title="takeWhile"></a>takeWhile</h3><p><code>public takeWhile(predicate: function(value: T, index: number): boolean): Observable&lt;T&gt;</code> ：满足某个条件时不再从原序列中取数据<br><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-takeWhile.png" alt="takeWhile"></p>
<h3 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h3><p><code>public skip(count: Number): Observable</code>：跳过序列中的前<code>count</code>个数据</p>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-skip.png" alt="skip"></p>
<h3 id="switchMap"><a href="#switchMap" class="headerlink" title="switchMap"></a>switchMap</h3><p><code>public switchMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code>: 将原序列某个数据转换为另一个observable的若干个序列数据，当元序列有新数据到来时，会截断旧数据</p>
<p><a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-switchMap" target="_blank" rel="noopener">switchMap官方说明</a></p>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-08-switchMap.png" alt="switchMap"></p>
<h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/03/JavaScript响应式编程 - RxJs入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/03/JavaScript响应式编程 - RxJs入门/" itemprop="url">JavaScript响应式编程 - RxJs入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-03T16:13:48+08:00">
                2017-03-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在angular2项目的过程中，接触到了Rxjs这个东西，对它进行了一下简单的了解，对它的基本用法进行了学习和总结，介绍了：</p>
<ul>
<li>基本概念</li>
<li>如何创建一个Observerble可观察序列</li>
<li>Observer实例的生命周期</li>
<li>如何对Observer实例进行订阅？以及监听他的next、error、complete事件？</li>
<li>rxjs交互图怎么看？</li>
<li>map、filter、from等简单的操作符含义</li>
</ul>
<h2 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h2><p>官方文档：<a href="http://reactivex.io/rxjs/" target="_blank" rel="noopener">http://reactivex.io/rxjs/</a></p>
<p><code>Rx</code>（<code>ReactiveX</code>, <code>Reactive Extensions</code>）,它是微软开发和维护的基于<code>响应式编程</code>（<code>Reactive Programming</code>）范式实现的一套工具库集合，于2012年11月开源，它提供了一系列接口规范来帮助开发者方便的处理异步数据流。Rx系列结合了观察者模式、迭代器模式、函数式编程，它已成为业界响应式编程的优秀实践。</p>
<p><code>RxJs</code>就是Rx在JavaScript层面上的实现，除此之外还有RxJava、Rx.Net、RxSwift等等。</p>
<p><code>RxJs</code>全名<code>Reactive Extensions for JavaScript</code>，翻译为<code>Javascript的响应式扩展</code>, 它的思路是把随时间不断变化的数据、状态、事件等等转成可被观察的序列(<code>Observable Sequence</code>)，然后订阅序列中那些Observable对象的变化，一旦变化，就会执行事先安排好的各种转换和操作。</p>
<h2 id="几个名词"><a href="#几个名词" class="headerlink" title="几个名词"></a>几个名词</h2><p><code>Observable</code>: <code>可观察的数据序列</code>.<br><code>Observer</code>: <code>观察者实例</code>，用来决定何时观察指定数据，只有在Rx.Observable.create创建方法可以获取<br><code>Subscription</code>: 观察数据序列返回的<code>订阅实例</code>.<br><code>Operators</code>: <code>Observable的操作符</code>，包括转换数据序列，过滤等，所有的Operators方法接受的参数是上一次发送的数据变更的值，而方法返回值我们称之为发射新数据变更</p>
<p><code>Observable</code>可以发射三种类型的事件：<code>next</code>、<code>error</code>、<code>complete</code><br><code>Subscription</code>可以订阅三种类型的事件：<code>onNext</code> <code>onError</code> <code>onComplete</code><br><code>Observable</code>有四个生命周期：创建 、订阅 、 执行 、销毁。</p>
<h2 id="使用create创建一个Observable"><a href="#使用create创建一个Observable" class="headerlink" title="使用create创建一个Observable"></a>使用create创建一个Observable</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Rx = <span class="built_in">require</span>(<span class="string">'rxjs/Rx'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;Observable&#125; = <span class="built_in">require</span>(<span class="string">'rxjs/Observable'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/observable/of'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'rxjs/add/operator/map'</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//创建序列源</span></span><br><span class="line"><span class="keyword">const</span> source = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    observer.next(<span class="string">'foo'</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> observer.next(<span class="string">'bar'</span>), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//订阅</span></span><br><span class="line"><span class="keyword">const</span> subscription = source.subscribe(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data));</span><br></pre></td></tr></table></figure>
<h2 id="捕获error和complete"><a href="#捕获error和complete" class="headerlink" title="捕获error和complete"></a>捕获error和complete</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> source = Observable.create(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">    observer.next(<span class="string">'foo'</span>);                         <span class="comment">//发射数据</span></span><br><span class="line">    observer.error(<span class="string">'my error'</span>);                   <span class="comment">//发射错误</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> observer.next(<span class="string">'bar'</span>), <span class="number">1000</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>observer.complete(),<span class="number">2000</span>);     <span class="comment">//发射完成</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> source1 = source.map(<span class="function"><span class="params">e</span>=&gt;</span><span class="string">`hello <span class="subst">$&#123;e&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription = source1</span><br><span class="line">    .subscribe(</span><br><span class="line">        data=&gt;<span class="built_in">console</span>.log(data),</span><br><span class="line">        error=&gt;<span class="built_in">console</span>.log(error),</span><br><span class="line">        ()=&gt;<span class="built_in">console</span>.log(<span class="string">'complete'</span>)</span><br><span class="line">        );</span><br></pre></td></tr></table></figure>
<h2 id="rxjs交互图"><a href="#rxjs交互图" class="headerlink" title="rxjs交互图"></a>rxjs交互图</h2><ul>
<li>每条线表示一个数据序列</li>
<li>每个球表示发送的数据变更，小竖线表示complete</li>
<li>方法下面表示经过map、filter等操作符处理过后产生的新序列</li>
</ul>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-03-07-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-03%2014.23.49.png" alt="屏幕快照 2017-03-03 14.23.49"></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">//序列1</span></span><br><span class="line"><span class="keyword">let</span> source = Observable.create(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    observer.next(<span class="number">1</span>);</span><br><span class="line">    observer.next(<span class="number">2</span>);</span><br><span class="line">    observer.next(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//序列2</span></span><br><span class="line"><span class="keyword">let</span> source2 = source.map(<span class="function"><span class="params">e</span>=&gt;</span>e=e*<span class="number">10</span>);</span><br><span class="line"><span class="comment">//订阅序列1</span></span><br><span class="line">source.subscribe(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data));</span><br><span class="line"><span class="comment">//订阅序列2</span></span><br><span class="line">source2.subscribe(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data));</span><br></pre></td></tr></table></figure>
<h2 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h2><p><code>map</code>：对要发送的data作统一处理后再返回<br><code>filter</code>：满足条件时才发射出去<br><code>toPromise</code>：将observer转为promise<br><code>debounce</code>：（防抖动）取一段时间内最新的数据<br><code>throttle</code>：(防抖动) 忽略这段时间，发现新值后再发送</p>
<p>更多，如 mapTo, scan, from ,concat, concatAll, merge, mergeAll等</p>
<h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>angular2中的HTTP模块，ionic-native中的BLE模块都默认使用了<code>Observable</code></p>
<p>还需要要研究：</p>
<ul>
<li>他的使用场景？</li>
<li>与promise相比他的优势劣势是什么？</li>
<li>未来的使用趋势如何？</li>
</ul>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p>官方文档：<a href="http://reactivex.io/rxjs/" target="_blank" rel="noopener">http://reactivex.io/rxjs/</a></p>
<p><a href="https://yq.aliyun.com/articles/65027" target="_blank" rel="noopener">rxjs简单入门</a></p>
<p><a href="http://www.oschina.net/translate/rxjs-streams?lang=chs&amp;page=1#" target="_blank" rel="noopener">使用 RxJS 实现 JavaScript 的 Reactive 编程</a></p>
<p><a href="https://dzone.com/refcardz/rxjs-streams" target="_blank" rel="noopener">Reactive Programming in JavaScript With RxJS</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/27/对node事件循环机制中Macrotask和Microtask的理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/27/对node事件循环机制中Macrotask和Microtask的理解/" itemprop="url">对node事件循环机制中Macrotask和Microtask的理解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-27T10:38:23+08:00">
                2017-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="node事件循环机制中的Microtask和Macrotask"><a href="#node事件循环机制中的Microtask和Macrotask" class="headerlink" title="node事件循环机制中的Microtask和Macrotask?"></a>node事件循环机制中的<code>Microtask</code>和<code>Macrotask</code>?</h2><h3 id="他是什么？"><a href="#他是什么？" class="headerlink" title="他是什么？"></a>他是什么？</h3><p>在Nodejs事件循环机制中，有任务两个队列：<code>Macrotask队列</code>和<code>Microtask队列</code>。在一个事件循环里，这两个队列会分两步执行，第一步会固定地执行一个（且仅一个）Macrotask任务，第二步会执行整个Microtask队列中的所有任务。并且，在执行Microtask队列任务的时候，也允许加入新的Microtask任务，直到所有Microtask任务全部执行完毕，才会结束循环。</p>
<p>Macrotasks一般包括: <code>setTimeout</code>, <code>setInterval</code>, <code>setImmediate</code>, <code>I/O</code>, <code>UI rendering</code>；<br>Microtasks一般包括: <code>process.nextTick</code>, <code>Promises</code>, <code>Object.observe</code>, <code>MutationObserver</code>。</p>
<h3 id="node事件循环机制详解"><a href="#node事件循环机制详解" class="headerlink" title="node事件循环机制详解"></a>node事件循环机制详解</h3><p>从一个事件循环开始，到结束会经历以下步骤：</p>
<ol>
<li>检查Macrotask队列，选择其中最早加入（即最老的）的任务X，设置为“目前运行的任务”。如果任务X不存在，那么直接跳到步骤4。</li>
<li>运行任务X，即运行对应的回调函数。</li>
<li>设置“目前运行的任务”为null，从Macrotask队列中移除任务X。</li>
<li><p>检查Microtask队列：</p>
<ol>
<li>选择其中最老的任务a，如果任务a不存在，直接结束Microtask队列。</li>
<li>设置任务a为“目前运行的任务”，并执行。</li>
<li>设置“目前运行的任务”为null，从Microtask队列中移除任务a。</li>
<li>选择下一个最老的任务b，跳到步骤2）。</li>
<li>直到队列里没有剩余的任务，结束队列。</li>
</ol>
</li>
<li>跳回步骤1，检查下一个Macrotask任务。</li>
</ol>
<h3 id="如何选用Macrotask或Microtask呢？"><a href="#如何选用Macrotask或Microtask呢？" class="headerlink" title="如何选用Macrotask或Microtask呢？"></a>如何选用Macrotask或Microtask呢？</h3><p><strong><em>如果你想让一个任务立即执行，那么就把它设置为Microtask，除此之外都用Macrotask比较好。</em></strong></p>
<p>因为可以看出，虽然Node是异步非阻塞的，但<strong>在一个事件循环中，Microtask的执行方式基本上就是用同步的</strong>。</p>
<h3 id="有什么问题？"><a href="#有什么问题？" class="headerlink" title="有什么问题？"></a>有什么问题？</h3><p>如果<code>Microtask</code>任务列表太长，或不断加入新的<code>Microtask</code>，就会导致下一个<code>Macrotask</code>任务很久得不到执行，可能导致UI一直无法刷新或IO无法完成。</p>
<p>应该是考虑到了这一点，至少Microtask任务中的<code>process.nextTick</code>任务，是被设置了（在一个事件循环中的）最大调用次数的，叫<code>process.maxTickDepth</code>，默认是1000。一定程度上避免了上述情况。</p>
<h3 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h3><p><a href="https://segmentfault.com/a/1190000007710772" target="_blank" rel="noopener">Node.js事件循环中的：Macrotask 与 Microtask</a></p>
<p><a href="https://segmentfault.com/a/1190000002914296" target="_blank" rel="noopener">Node.js事件驱动实现概览</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/27/js面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/27/js面试题/" itemprop="url">函数闭包、IIFE、JS解释器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-27T09:53:44+08:00">
                2017-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在掘金上看到了篇文章，里面讲了几个js代码片段，觉得很有意思，其中考察了关于<code>setTimeout</code>、<code>函数闭包</code>、<code>IIFE（立即执行函数表达式）</code>、<code>promise</code>、<code>js解释器</code>等概念的理解</p>
<p>A：下面的程序输出啥？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：没有坑，别想多了。输出<code>0 1 2 3 4</code></p>
<p>A：恩，那下面这个呢？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;, <span class="number">1000</span>*i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：<code>settimeout</code>时间到后，会在下一个tick中执行程序，所以程序打印的时候，i已经变成5了，输出<code>5 5 5 5 5</code>。</p>
<p>A：不错，那我想输出的结果是<code>0 1 2 3 4</code>，应该怎么办呢？</p>
<p>我：用闭包就解决了，如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;, <span class="number">1000</span>*i);</span><br><span class="line">    &#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为函数作用域内，保存着对于变量i的引用，故函数执行的时候仍能访问到当初的i。</p>
<p>A：很好。那如果去掉参数i呢？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;, <span class="number">1000</span>*i);</span><br><span class="line">    &#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：这样的话，函数闭包内没有存储对i保持引用，所以输出结果又会变成<code>5 5 5 5 5</code></p>
<p>A： 对。那我再给你改一下程序，你看看输出啥？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//给setTimeout传递一个立即执行函数 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">     setTimeout((<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(i);</span><br><span class="line">     &#125;)(i), <span class="number">1000</span>*i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我：这里给<code>setTimeout</code>传递的是一个立即执行函数表达式，它会马上运行，执行结果是<code>undefined</code>，所以<code>setTimeout</code>输出0之后，应该会报错吧，因为参数传递不对，应该接受一个函数类型的参数。</p>
<p>上面的代码差不多等于：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//其实等价于</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">     setTimeout(<span class="literal">undefined</span>, <span class="number">1000</span>*i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A：恩！再看下面的这个程序输出什么？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> <span class="title">executor</span>(<span class="params">resolve</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10000</span>;i++)&#123;</span><br><span class="line">        i == <span class="number">9999</span> &amp;&amp; resolve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>我：思考半天…，应该输出<code>2 3 5 4 1</code>。这个题目是关于js解释器理解的。<code>setTimeout</code>中的函数会在下一个时钟周期运行，肯定比较靠后。<code>2，3</code>在立即执行函数中，所以他会立马打印。<code>4</code>在<code>then</code>中输出，它会放在当前周期的最后执行。最后<code>5</code>会立马打印。所以会这样<code>2 3 5 4 1</code>。</p>
<p>疑问：关于setTimeout和promise.then执行先后的问题，上网找了一下原因，setTimeout属于<code>Macrotask</code>，而promise属于<code>Microtask</code>，<code>Microtask</code>在当前周期队列执行，<code>Macrotask</code>在下一周期执行。</p>
<p>参考自：<a href="https://gold.xitu.io/entry/58b21e6c570c3500692805f1" target="_blank" rel="noopener">Excuse me？这个前端面试在搞事！</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/24/node版本管理 n和nvm说明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/24/node版本管理 n和nvm说明/" itemprop="url">node版本管理 n和nvm说明</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-24T10:33:54+08:00">
                2017-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>项目中我们有时需要使用不同版本 的node来调试或测试程序，最本的方法当然是手动下载不同的版本，并卸载之前的版本，这样可以达到目的，但是无疑是麻烦时间的，在node中有“node版本管理器”来实现类似的功能需要。这里介绍比较流行的两个，“<code>n</code>”和“<code>nvm</code>”.<br>先说说n。<br>n是node一个模块，可以用来管理和切换node版本，其作者是TJ Holowaychuk（出名的Express框架作者），使用非常之简单。<br>安装 方法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo npm install -g n</span><br></pre></td></tr></table></figure>
<p>常用命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$n</span> //查看已安装版本  </span><br><span class="line"><span class="variable">$n</span> latest  //安装最新版本并使用  </span><br><span class="line"><span class="variable">$n</span> latest -d   //下载最新版但不使用，-d参数表示为仅下载  </span><br><span class="line"><span class="variable">$n</span> stable  //安装最新稳定版本并使用  </span><br><span class="line"><span class="variable">$n</span> &lt;version&gt;  //安装某个版本并使用，如<span class="variable">$n</span> 6.2.2  </span><br><span class="line"><span class="variable">$n</span> rm &lt;version ...&gt; //删除某些版本  </span><br><span class="line"><span class="variable">$n</span> ls    //查看可用版本  </span><br><span class="line"><span class="variable">$n</span> --latest    //查看最新版本  </span><br><span class="line"><span class="variable">$n</span> --stable    //查看最新稳定版  </span><br><span class="line"><span class="variable">$n</span> -h    //查看帮助信息，更多命令在这里查看  </span><br><span class="line">[plain] view plain copy <span class="built_in">print</span>?在CODE上查看代码片派生到我的代码片</span><br><span class="line">$ n use 0.10.21 some.js   //&lt;span style=<span class="string">"font-family: Arial, Helvetica, sans-serif;"</span>&gt;以指定的版本来执行脚本&lt;/span&gt;</span><br></pre></td></tr></table></figure>
<p>下面说说<code>nvm</code>。<br>问题来了，既然有这么简单好用的n，那么nvm为什么还会大肆流行呢？这个问题一会回答，先说说nvm。<br>nvm全称Node Version Manager，不同于 n，nvm 不是一个 npm package，而是一个独立软件包。这意味着我们需要单独使用它的安装逻辑：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ wget -qO- https://raw.github.com/creationix/nvm/v0.4.0/install.sh | sh </span><br><span class="line">``` </span><br><span class="line">独立的安装包，因此当你机器上没有安装node时仍可以使用它。</span><br><span class="line">常用命令：</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">$ nvm install 0.10    </span><br><span class="line">$ nvm use 0.10         //使用指定的版本   </span><br><span class="line">$ nvm ls               //查看当前已经安装的版本  </span><br><span class="line">.nvm  </span><br><span class="line">-&gt;  v0.10.24  </span><br><span class="line">$ nvm current         //查看正在使用的版本  </span><br><span class="line">v0.10.24  </span><br><span class="line">$ nvm run 0.10.24 myApp.js      //以指定版本执行脚本  </span><br><span class="line">$ rm -rf ~/.nvm     //卸载nvm</span><br></pre></td></tr></table></figure>
<p>对比说明：<br>我们在使用 n 管理 node 版本前，首先需要一个 node 环境。我们或者用 Homebrew 来安装一个 node，或者从官网下载 pkg 来安装，总之我们得先自己装一个 node —— n 本身是没法给你装的。<br>然后我们可以使用 n 来安装不同版本的 node。<br>在安装的时候，n 会先将指定版本的 node 存储下来，然后将其复制到我们熟知的路径 /usr/local/bin，非常简单明了。当然由于 n 会操作到非用户目录，所以需要加 sudo 来执行命令。<br>两者区别:<br>安装简易度。nvm 安装起来显然是要麻烦不少；n 这种安装方式更符合 node 的惯性思维。见仁见智吧。<br>系统支持。注意， nvm 不支持 Windows。<br>对全局模块的管理。n 对全局模块毫无作为，因此有可能在切换了 node 版本后发生全局模块执行出错的问题；nvm 的全局模块存在于各自版本的沙箱中，切换版本后需要重新安装，不同版本间也不存在任何冲突。<br>关于 node 路径。n 是万年不变的 /usr/local/bin；nvm 需要手动指定路径。</p>
<p>参考地址：<br><a href="http://taobaofed.org/blog/2015/11/17/nvm-or-n/" target="_blank" rel="noopener">http://taobaofed.org/blog/2015/11/17/nvm-or-n/</a>     管理 node 版本，选择 nvm 还是 n？<br><a href="http://it.taocms.org/03/3079.htm" target="_blank" rel="noopener">http://it.taocms.org/03/3079.htm</a>      利用n和nvm管理Node的版本</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/22/Angular笔记 - 属性型指令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/22/Angular笔记 - 属性型指令/" itemprop="url">Angular笔记 - 属性型指令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-22T16:52:47+08:00">
                2017-02-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>属性型指令用于改变DOM元素的外观或行为。</p>
<p>在Angular中有三种类型的指令：</p>
<ol>
<li>组件 — 拥有模板的指令</li>
<li>属性型指令 — 改变元素外观或行为，例如内置的 <code>NgStyle</code> 指令可以同时修改元素的多个样式</li>
<li>结构型指令 — 通过添加和移除dom元素改变视图结构，例如，<code>NgFor</code> 和 <code>NgIf</code>。</li>
</ol>
<h2 id="一个简单的属性型指令"><a href="#一个简单的属性型指令" class="headerlink" title="一个简单的属性型指令"></a>一个简单的属性型指令</h2><p>我们这里实现了一个简单的属性型指令，说一下几个重点的内容</p>
<p>功能：当用户鼠标悬浮在元素上时，改变它的背景颜色</p>
<p>代码：</p>
<p>highlight.directive.ts</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Directive, ElementRef, HostListener, Input, Renderer &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  selector: <span class="string">'[myHighlight]'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HighlightDirective &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> el: ElementRef, <span class="keyword">private</span> renderer: Renderer</span>) &#123; &#125;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseenter'</span>) onMouseEnter() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="string">'yellow'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseleave'</span>) onMouseLeave() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> highlight(color: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.renderer.setElementStyle(<span class="keyword">this</span>.el.nativeElement, <span class="string">'backgroundColor'</span>, color);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>a.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>My First Attribute Directive<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">myHighlight</span>&gt;</span>Highlight me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li><code>@Directive</code>装饰器需要一个 CSS 选择器，以便从模板中识别出关联到这个指令的 HTML，这里指令的选择器是<code>[myHighlight]</code>，Angular 将会在模板中找到所有带<code>myHighlight属性</code>的元素。</li>
<li>需要把 Angular 的<code>ElementRef</code>和<code>Renderer</code>注入进构造函数。<code>ElementRef</code>是一个服务，它赋予我们通过它的<code>nativeElement</code>属性直接访问 DOM 元素的能力。 <code>Renderer</code>服务允许通过代码设置元素的样式。</li>
<li>需要把这个类添加到 NgModule 元数据的<code>declarations数组</code>中</li>
</ul>
<blockquote>
<p>EXCEPTION: Template parse errors:<br>  Can’t bind to ‘myHighlight’ since it isn’t a known property of ‘p’.</p>
</blockquote>
<p>  错误原因:你记着设置<code>@NgModule</code>的<code>declarations数组</code>了吗？它很容易被忘掉</p>
<ul>
<li><code>@HostListener</code>装饰器引用属性型指令的宿主元素，在这个例子中就是<code>&lt;p&gt;</code></li>
</ul>
<h2 id="高级点的属性型指令"><a href="#高级点的属性型指令" class="headerlink" title="高级点的属性型指令"></a>高级点的属性型指令</h2><p>对上面的那个指令添加功能：</p>
<ol>
<li>通过绑定从外部设定这个颜色 </li>
<li>从外部设定一个默认颜色，如果没有传入颜色，则使用这个默认颜色</li>
<li><p>这样使用这个指令</p>
 <figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span> [<span class="attr">defaultColor</span>]=<span class="string">"'violet'"</span>&gt;</span></span><br><span class="line">    Highlight me too!</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>代码：</p>
<p>highlight.directive.ts</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Directive, ElementRef, HostListener, Input, Renderer &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  selector: <span class="string">'[myHighlight]'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HighlightDirective &#123;</span><br><span class="line">  <span class="keyword">private</span> _defaultColor = <span class="string">'red'</span>;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> el: ElementRef, <span class="keyword">private</span> renderer: Renderer</span>) &#123; &#125;</span><br><span class="line">  <span class="meta">@Input</span>() <span class="keyword">set</span> defaultColor(colorName: <span class="built_in">string</span>)&#123;</span><br><span class="line">    <span class="keyword">this</span>._defaultColor = colorName || <span class="keyword">this</span>._defaultColor;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Input</span>(<span class="string">'myHighlight'</span>) highlightColor: <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseenter'</span>) onMouseEnter() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="keyword">this</span>.highlightColor || <span class="keyword">this</span>._defaultColor);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@HostListener</span>(<span class="string">'mouseleave'</span>) onMouseLeave() &#123;</span><br><span class="line">    <span class="keyword">this</span>.highlight(<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> highlight(color: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.renderer.setElementStyle(<span class="keyword">this</span>.el.nativeElement, <span class="string">'backgroundColor'</span>, color);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>a.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"colors"</span> (<span class="attr">click</span>)=<span class="string">"color='lightgreen'"</span>&gt;</span>Green</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"colors"</span> (<span class="attr">click</span>)=<span class="string">"color='yellow'"</span>&gt;</span>Yellow</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"colors"</span> (<span class="attr">click</span>)=<span class="string">"color='cyan'"</span>&gt;</span>Cyan</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span>&gt;</span>Highlight me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span> [<span class="attr">defaultColor</span>]=<span class="string">"'violet'"</span>&gt;</span></span><br><span class="line">  Highlight me too!</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li>新的<code>highlightColor</code>属性被称为输入属性，因为数据是从绑定表达式流入指令中。 注意，在定义这个属性的时候，我们调用了<code>@Input()</code>装饰器，<code>@Input</code>向类添加元数据，使<code>highlightColor</code>属性能以<code>myHighlight</code>为别名进行绑定</li>
<li>你可以通过重命名属性名到myHighlight来移除这个区别，像这样：<code>@Input() myHighlight: string;</code></li>
<li><code>defaultColor</code>属性是一个 <code>setter</code> 函数，它代替了硬编码的默认颜色 “red”,它不需要 getter 函数。这里，把字符串字面量<code>&#39;violet&#39;</code>绑定到了<code>defaultColor</code>上。</li>
</ul>
<h2 id="关于-输入属性的源和目标"><a href="#关于-输入属性的源和目标" class="headerlink" title="关于 输入属性的源和目标"></a>关于 输入属性的源和目标</h2><p>Angular 在绑定的源和目标之间的区别：</p>
<ul>
<li><p>如果属性出现在了模板表达式等号 (=) 的右侧，它就是一个<code>源</code>。</p>
</li>
<li><p>如果它出现在了方括号 ([ ]) 中，并且出现在等号 (=) 的左侧，它就是一个<code>目标</code>， 就像在绑定到HighlightDirective的myHighlight属性时所做的那样。</p>
</li>
</ul>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">myHighlight</span>]=<span class="string">"color"</span>&gt;</span>Highlight me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>[myHighlight]=&quot;color&quot;</code>中的 <code>&#39;color&#39;</code>是绑定源。 源属性不需要声明。</p>
<p><code>[myHighlight]=&quot;color&quot;</code>中的 <code>&#39;myHighlight&#39;</code> 是绑定目标。 必须把它定义为一个输入属性，否则，Angular 就会拒绝绑定，并给出一个明确的错误。</p>
<p>Angular 这样区别对待目标属性有充分的理由。 作为目标的组件或指令需要保护。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/22/TypeScript - 类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/22/TypeScript - 类/" itemprop="url">TypeScript - 类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-22T16:04:45+08:00">
                2017-02-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><p> 从ECMAScript 2015，也就是ECMAScript 6开始，JavaScript程序员将能够使用基于类的面向对象的方式。 使用TypeScript，我们允许开发者现在就使用这些特性，并且编译后的JavaScript可以在所有主流浏览器和平台上运行，而不需要等到下个JavaScript版本。</p>
<h2 id="创建一个类"><a href="#创建一个类" class="headerlink" title="创建一个类"></a>创建一个类</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Greeter &#123;</span><br><span class="line">    greeting: <span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">message: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.greeting = message;</span><br><span class="line">    &#125;</span><br><span class="line">    greet() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello, "</span> + <span class="keyword">this</span>.greeting;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> greeter = <span class="keyword">new</span> Greeter(<span class="string">"world"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><ul>
<li>使用<code>extend</code>关键字来创建子类</li>
<li>子类构造函数中使用<code>super()</code>，执行父类的构造方法</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">theName: <span class="built_in">string</span></span>) &#123; <span class="keyword">this</span>.name = theName; &#125;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span> = <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;this.name&#125;</span> moved <span class="subst">$&#123;distanceInMeters&#125;</span>m.`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Snake <span class="keyword">extends</span> Animal &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123; <span class="keyword">super</span>(name); &#125;</span><br><span class="line">    move(distanceInMeters = <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Slithering..."</span>);</span><br><span class="line">        <span class="keyword">super</span>.move(distanceInMeters);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Horse <span class="keyword">extends</span> Animal &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123; <span class="keyword">super</span>(name); &#125;</span><br><span class="line">    move(distanceInMeters = <span class="number">45</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Galloping..."</span>);</span><br><span class="line">        <span class="keyword">super</span>.move(distanceInMeters);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sam = <span class="keyword">new</span> Snake(<span class="string">"Sammy the Python"</span>);</span><br><span class="line"><span class="keyword">let</span> tom: Animal = <span class="keyword">new</span> Horse(<span class="string">"Tommy the Palomino"</span>);</span><br><span class="line"></span><br><span class="line">sam.move();</span><br><span class="line">tom.move(<span class="number">34</span>);</span><br></pre></td></tr></table></figure>
<h2 id="public、private、protected修饰符"><a href="#public、private、protected修饰符" class="headerlink" title="public、private、protected修饰符"></a>public、private、protected修饰符</h2><ul>
<li><p>在ts中，成员类型默认为<code>public</code></p>
</li>
<li><p>当成员被标记成<code>private</code>时，它就不能在声明它的类的外部访问</p>
</li>
<li><p><code>protected</code>修饰符与<code>private</code>修饰符的行为相似，但<strong><code>protected</code>成员在派生类中仍然可以访问</strong></p>
</li>
<li><p>构造函数可以被标记成<code>protected</code>，这是这个类不可以在类外进行实例化，但是能被继承并在子类中实例化。</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">   <span class="keyword">protected</span> name: <span class="built_in">string</span>;</span><br><span class="line">       <span class="keyword">protected</span> <span class="keyword">constructor</span>(<span class="params">theName: <span class="built_in">string</span></span>) &#123; <span class="keyword">this</span>.name = theName; &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// Employee can extend Person</span></span><br><span class="line">   <span class="keyword">class</span> Employee <span class="keyword">extends</span> Person &#123;</span><br><span class="line">       <span class="keyword">private</span> department: <span class="built_in">string</span>;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, department: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">           <span class="keyword">super</span>(name);</span><br><span class="line">           <span class="keyword">this</span>.department = department;</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">public</span> getElevatorPitch() &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">`Hello, my name is <span class="subst">$&#123;this.name&#125;</span> and I work in <span class="subst">$&#123;this.department&#125;</span>.`</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">let</span> howard = <span class="keyword">new</span> Employee(<span class="string">"Howard"</span>, <span class="string">"Sales"</span>);</span><br><span class="line">   <span class="keyword">let</span> john = <span class="keyword">new</span> Person(<span class="string">"John"</span>); <span class="comment">// Error: The 'Person' constructor is protected</span></span><br></pre></td></tr></table></figure>
<h2 id="readonly修饰符"><a href="#readonly修饰符" class="headerlink" title="readonly修饰符"></a>readonly修饰符</h2><ul>
<li><code>readnoly</code>修饰符，设置属性为只读的</li>
<li>只读属性必须在声明时或构造函数里被初始化</li>
</ul>
<h2 id="参数属性"><a href="#参数属性" class="headerlink" title="参数属性"></a>参数属性</h2><p>使用参数属性可以方便地在一个地方创建并初始化一个成员,可以简化代码</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> name: <span class="built_in">string</span></span>) &#123; &#125;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面仅在构造函数里使用<code>private name: string</code>参数来创建和初始化name成员,把声明和赋值合并至一处。</p>
<p>等价于</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    <span class="keyword">private</span> name:<span class="built_in">string</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">theName: <span class="built_in">string</span></span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.name=theName;</span><br><span class="line">    &#125;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="存取器-getters-setters"><a href="#存取器-getters-setters" class="headerlink" title="存取器 getters/setters"></a>存取器 getters/setters</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Person&#123;</span><br><span class="line">    <span class="keyword">private</span> _name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">get</span> name():<span class="built_in">string</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">set</span> name(name:<span class="built_in">string</span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>._name=name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.name=<span class="string">'tom'</span>;        <span class="comment">//调用set</span></span><br><span class="line"><span class="built_in">console</span>.log(p.name); <span class="comment">//调用get</span></span><br></pre></td></tr></table></figure>
<p>要注意几点：</p>
<ul>
<li>使用<code>tsc file.ts --target es5</code>编译，因为它只支持ECMAScript 5或更高</li>
<li>只带有 <code>get</code>不带有<code>set</code>的存取器自动被推断为readonly</li>
</ul>
<p>用在哪里？<br>可以用在存取时需要做一些额外操作，而不是直接赋值的地方。</p>
<h2 id="静态属性"><a href="#静态属性" class="headerlink" title="静态属性"></a>静态属性</h2><ul>
<li><code>static</code>可以创建类的静态成员，这些属性存在于类本身，而不是类的实例上</li>
<li>使用<code>类名.静态成员名</code>格式访问类的静态成员</li>
</ul>
<h2 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h2><ul>
<li>抽象类一般不会直接实例化，而是作为派生类的基类。</li>
<li>与接口不同的地方：抽象类可以包含成员的实现细节。</li>
<li><code>abstract</code>关键字是用于定义抽象类和在抽象类内部定义抽象方法。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> Animal &#123;</span><br><span class="line">    <span class="keyword">abstract</span> makeSound(): <span class="built_in">void</span>;</span><br><span class="line">    move(): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'roaming the earch...'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：<br><strong>抽象类中的抽象方法不包含具体实现</strong>，而且<strong>它必须要在派生类中实现</strong></p>
<h2 id="高级技巧"><a href="#高级技巧" class="headerlink" title="高级技巧"></a>高级技巧</h2><h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>在创建ts的一个类时，声明了几个东西：</p>
<ul>
<li>类的<code>实例类型</code></li>
<li>创建了一个叫做<code>构造函数的值</code></li>
</ul>
<p>a.ts<br><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Greeter &#123;</span><br><span class="line">    greeting: <span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">message: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.greeting = message;</span><br><span class="line">    &#125;</span><br><span class="line">    greet() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello, "</span> + <span class="keyword">this</span>.greeting;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> greeter: Greeter;</span><br><span class="line">greeter = <span class="keyword">new</span> Greeter(<span class="string">"world"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(greeter.greet());</span><br></pre></td></tr></table></figure></p>
<p>上面的代码使用<code>tsc a.ts</code> 编译后得到的js代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> Greeter = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Greeter</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.greeting = message;</span><br><span class="line">    &#125;</span><br><span class="line">    Greeter.prototype.greet = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello, "</span> + <span class="keyword">this</span>.greeting;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> Greeter;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> greeter;</span><br><span class="line">greeter = <span class="keyword">new</span> Greeter(<span class="string">"world"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(greeter.greet());</span><br></pre></td></tr></table></figure>
<h3 id="把类当做接口使用"><a href="#把类当做接口使用" class="headerlink" title="把类当做接口使用"></a>把类当做接口使用</h3><p>类定义会创建两个东西：<code>类的实例类型</code>和<code>一个构造函数</code>。 因为<strong>类可以创建出类型</strong>，所以你能够在允许使用接口的地方使用类。</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Point &#123;</span><br><span class="line">    x: <span class="built_in">number</span>;</span><br><span class="line">    y: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Point3d <span class="keyword">extends</span> Point &#123;</span><br><span class="line">    z: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> point3d: Point3d = &#123;x: <span class="number">1</span>, y: <span class="number">2</span>, z: <span class="number">3</span>&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/21/天使时代 - 刘慈欣/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/21/天使时代 - 刘慈欣/" itemprop="url">天使时代 - 刘慈欣</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-21T16:28:34+08:00">
                2017-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/小说/" itemprop="url" rel="index">
                    <span itemprop="name">小说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>天使时代</p>
<p>　　引子</p>
<p>　　对桑比亚国的攻击即将开始。</p>
<p>　　执行“第一伦理”行动的三个航空母舰战斗群到达非洲沿海已十多天了，这支舰队以林肯号航母战斗群为核心展开在海面上，如同大西洋上一盘威严的棋局。</p>
<p>　　此时天已经暗了下来，舰队的探照灯集中照亮了林肯号的飞行甲板，那里整齐地站列着上千名陆战队员和海军航空兵飞行员。站在队列最前面的是“第一伦理”行动的最高指挥官菲利克斯将军和林肯号的舰长布莱尔将军，前者身材欣长，一派学者风度，后者粗壮强悍，是一名典型的老水兵。在蒸汽弹射器的起点，面对队列站着一位身着黑色教袍的的随军牧师，他手捧《圣经》，诵起了为这次远征而作的祷词：“全能的主，我们来自文明的世界，一路上，我们看到了您是如何主宰大地、天空和海洋，以及这世界上的万物生灵，组成我们的每一个细胞都渗透着您的威严。现在，有魔鬼在这遥远的大陆上出现，企图取代您神圣的至高无上的权威，用它那肮脏的手拨动生命之弦。请赐予我们正义的利剑，扫除恶魔，以维护您的尊严与荣耀，阿门——”</p>
<p>　　他的声音在带有非洲大陆土腥味的海风中回荡，令所有的人沉浸在一种比脚下的大海更为深广的庄严与神圣感之中，在上空纷纷飞过的巡航导弹火流星般的光芒中，他们都躬下身来，用发自灵魂的虔诚和道：“阿门——”</p>
<p>　　上篇</p>
<p>　　自人类基因组测序完成以后，人们就知道飞速发展的分子生物学带来的危机迟早会出现，联合国生物安全理事会就是为了预防这种危机而成立的。生物安理会是与已有的安理会具有同等权威的机构，它审查全世界生物学的所有重大研究课题，以确定这项研究是否合法，并进而投票决定是否终止它。</p>
<p>　　今天将召开生物安理会第119次例会，接受桑比亚国的申请，审查该国提交的一项基因工程的成果。按照惯例，申请国在申请时并不提及成果的内容，只在会议开始后才公布。这就带来一个问题：许多由小国提交的成果在会议一开始就发现根本达不到审查的等级。但各成员国的代表们都不敢轻视这个非洲最贫穷的国度提交的东西，因为这项研究是由诺贝尔奖获得者，基因软件工程学的创始人依塔博士做出的。</p>
<p>　　依塔博士走了进来，这位年过五十的黑人穿着桑比亚的民族服饰，那实际上就是一大块厚实的披布，他骨瘦如柴的身躯似乎连这块布的重量都经不起，像一根老树枝似的被压弯了。他更深地躬着腰，缓缓向圆桌的各个方向鞠躬，他的眼睛始终看着地面，动作慢地令人难以忍受，使这个过程持续了很长时间。印度代表低声地问旁边的美国代表：“您觉得他像谁？”美国代表说：“一个老佣人。”印度代表摇摇头，美国代表看了看他，又看了看依塔，“你是说……像甘地？哦，是的，真像。”</p>
<p>　　本届生物安理会轮值国主席站起来宣布会议开始，他请依塔在身旁就座后说：“依塔博士是我们大家都熟悉的人，虽然近年来深居简出，但科学界仍然没有忘记他。不过按惯例，我们还是对他进行一个简单的介绍。博士是桑比亚人，在三十二年前于麻省理工学院获计算机科学博士学位，而后回到祖国从事软件研究，但在十年后，突然转向分子生物学领域，并取得了众所周知的成就。”他转向依塔问，“博士，我有个问题，纯粹是出于好奇：您离开软件科学转向分子生物学，除了预见到软件工程学与基因工程的奇妙结合外，是不是还有另一层原因：对计算机技术能够给您的祖国带来的利益感到失望？”</p>
<p>　　“计算机是穷人的假上帝。”依塔缓缓地说，这是他进来后第一次开口。</p>
<p>　　“可以理解，虽然当时桑比亚政府在首都这样的大城市极力推行信息化，但这个国家的大部分地区还没有用上电。”</p>
<p>　　当分子生物学对生物大分子的操纵和解析技术达到一定高度时，这门学科就面对着它的终极目标：通过对基因的重新组合改变生物的性状，直到创造新生物。这时，这门科学将发生深刻变化，将由操纵巨量的分子变为操纵巨量的信息，这对于与数学仍有一定距离的传统分子生物学来说是极其困难的。直接操纵四种碱基来对基因进行编码，使其产生预期的生物体，就如同用0和1直接编程产生WINDOWSXP一样不可想象。依塔最早敏锐地意识到这一点，他深刻地揭示出了基因工程和软件工程共同的本质，把基础已经相当雄厚的软件工程学应用到分子生物学中。他首先发明了用于基因编程的宏汇编语言，接着创造了面向过程的基因高级编程语言，被称为“生命BASIC”；当面向对象的基因高级语言“伊甸园++”出现时，人类真的拥有了一双上帝之手。</p>
<p>　　这时，人们惊奇地发现，创造生命实际上就是编程序，上帝原来是个程序员。与此同时，程序员也成了上帝，这些原来混迹于硅谷或什么什么技术园区的的人纷纷混进生命科学行业来，他们都是些头发蓬乱衣冠不整的毛头小子，过着睡两天醒三天的日子，其中有许多人连有机物和无机物都分不清，但都是性能良好的编程机器。有一天，项目经理把一个光盘递给一位临时召来的这样的上帝，告诉他光盘中存有两个未编译的基因程序模块，让他给这两个模块编一个接口程序。谈好价钱后上帝拿着光盘回到他那间闷热的小阁楼中，在电脑前开始他那为期一周的创世工作，他干起活来与上帝没有任何共同之处，倒很像一个奴隶。一周后，他摇晃着从电脑前站起来，从驱动器中取出另一块拷好的光盘，趟着淹没小腿的烟蒂和速溶咖啡袋走出去，到那家生命科学公司把那个光盘交给项目经理。项目经理把光盘放入基因编译器中，在一个球形透明容器的中央，肉眼看不见的分子探针精巧地拨弄着几个植物细胞的染色体。然后，这些细胞被放入一个试管的营养液中培养，直至其长成一束小小的植株，后来这个植株被放入无土栽培车间，长成树苗后再被种进一个热带种植园，最后长成了一棵香蕉树。当第一串沉重的果实从树上砍下后，你掰下一个香蕉剥开来，发现里面是一个硕大的橘瓣……</p>
<p>　　当然，以上只是一个生动的比喻，实际的基因软件开发都是庞大的工程，绝非个人的力量所能及。例如仅编制一个视网膜感光细胞的基因软件，其代码量与一个最新的视窗操作系统相当。所以完全凭借基因编程创造新的生命还只能是病毒级别，科学家们倾向于从生物的自然基因中分离出各种功能模块和函数，通过引用和组合这些模块和函数来得到具有新的特征的生物，对此，面向对象的基因编程语言“伊甸园++”是一个强有力的工具。</p>
<p>　　“依塔博士，在宣布会议议程正式开始之前，我想提醒您：您看上去很虚弱。”会议主席关切地对依塔说。</p>
<p>　　一位桑比亚官员起身说：“各位，依塔博士每天吃得很少，你们一定知道，桑比亚国内目前正面临着严重的旱灾，博士自愿同他的人民一同挨饿。”</p>
<p>　　法国代表说：“上个月，作为发展计划署考察团的一员，我到过桑比亚和相临的其它两个受灾国家，那里的旱情确实可怕，如果大量的救济不能及时到位，下半年会饿死很多人的。”</p>
<p>　　“不过，依塔博士，”美国代表说，“作为一位从事基础研究的科学家，过分的责任心会影响您的研究，结果反而不能够尽到自己的责任。”</p>
<p>　　依塔点点头，并半起身冲他微微鞠躬：“您说得很对，唉，小时侯留下来的毛病，很难改了……哦，各位想不想听听我小时侯的事情？”</p>
<p>　　这显然离题了，但出于尊敬，大家都没有出声。依塔用低缓的声音讲述起来，仿佛在回忆中自语。</p>
<p>　　“那也是一个大旱之年，大地像一个满是裂缝的火炉子，地上被渴死的蛇又被烈日烤干，脚一踏就碎成了末……当时桑比亚正在连年的内战中，就是那场由东方政治集团操纵的推翻布萨诺政权的战争。我们的村子被遗弃了，什么吃的都没有了，雅拉就去吃干草和树叶，哦，雅拉是我的小妹妹，刚懂事，大大的眼睛……她去吃干草和树叶……”依塔的声音平缓而单调，像是早期的语音软件在读一个文本文件，“她吃得浑身浮肿，肠道也堵塞了……那天晚上，她嘴里含了什么东西，碰着牙喀啦啦响，我问她含着什么？她说在吃糖……她以前只吃过一块糖，是一年前一个来村里招募游击队员的苏联顾问给的。我看到一道血从她嘴里流出来，就掰开她的嘴看，雅拉含的不是糖块，是一个箭头，一个涂着响尾蛇的毒液，用来射杀豺狗的箭头。她最后对我说：雅拉难受，雅拉不想再活了，雅拉死后哥哥把雅拉吃了吧，然后哥哥就有劲儿走到城里去，听说那里有吃的…</p>
<p>　　…我还记得那天晚上的月亮，从干旱的大地尽头升起来，昏红昏红的……我没吃小妹妹，但那年在村子里，确实发生了人吃人的事，有些老人立下遗嘱，饿死后让孩子们吃……“</p>
<p>　　全场陷入长长的沉默。</p>
<p>　　主席说：“博士，我们现在理解了你在过去十多年用基因软件技术改良农作物的努力。”</p>
<p>　　“一事无成，一事无成啊……”依塔摇头叹息，“想当初桑比亚独立之时，我们曾想在祖先的土地上建起天堂，但后来知道，在这样一块苦难深重的土地上，对生活的期望是不能太高的。我们理想的底线在不断后退，我们不要工业化了，我们不要民主了，我们甚至可能连国家和个人的尊严都不要了，但桑比亚人对生活的要求不可能再后退，我们不能不吃饭。这个国家仍然有三分之二的人在挨饿，我们必须想出办法。”</p>
<p>　　依塔的话在会场里引起了很大的反响，代表们纷纷低声议论起来。</p>
<p>　　美国代表说：“非洲确实是一个被文明进程抛下的大陆，但，博士，这是一个涉及到社会政治、历史、地理条件等诸多复杂因素的问题，不是科学家们仅凭手中的科学就能够解决的。”</p>
<p>　　依塔摇摇头说：“不，科学也许真能解决饥饿问题，关键在于我们要换一个思考方向。”</p>
<p>　　代表们茫然地互相对视着，主席首先想到了什么，说：“如果我没理解错，依塔博士已经开始了我们这次会议的议程了。”</p>
<p>　　依塔郑重地说：“是的，主席先生，如果您允许，在介绍我们的研究成果前，我想先让各位认识一个孩子，一个能吃饱饭的桑比亚孩子。”</p>
<p>　　他挥挥手，一个黑人男孩儿走进会议大厅。他赤裸着上身，肌肉饱满，皮肤光亮，浓密卷鬈发下的一双大眼睛闪闪有神，他用强健而轻快的脚步，把一股旺盛的生命力带进了会议大厅。</p>
<p>　　“哇，好一个小奥塞罗！”有人赞叹道。</p>
<p>　　依塔介绍说：“这是卡多，十二岁，一个土生土长的桑比亚孩子。当然，在平均寿命只有四十多岁的赞比亚，他这样的年纪通常已经不算是孩子了，但卡多确实是孩子，而且是个小孩子，因为他的寿命肯定要超过我们在座的各位。”</p>
<p>　　“这不奇怪，看得出来这孩子的营养状况很好。”代表中的一位医学家说。</p>
<p>　　依塔扶着卡多的双肩环视着会场说：“他肯定与各位印象中的桑比亚儿童有很大差别，那些饥饿中的孩子都是细细的脖颈撑着大大的脑袋，四肢像树干般枯瘦，肚子因积水而鼓起，脸上落着苍蝇，身上生着疮……所以大家都看到了。只要吃饱了饭，任何民族的孩子都能变得像天使般高贵。”</p>
<p>　　卡多向大家点头致意，大声说了一句谁都听不懂的话。</p>
<p>　　“他在向各位问好，”依塔说，“卡多只会讲桑比亚语。”</p>
<p>　　“您刚才说，这孩子是在桑比亚土生土长的？”主席问。</p>
<p>　　“是的，而且是在桑比亚最贫瘠的地区长大，从未离开那里。在这场旱灾中，他的家乡饿死了不少人。”</p>
<p>　　所有人都目不转睛地盯着这个健壮的黑孩子，一时谁也说不出话来。</p>
<p>　　依塔第一次露出了淡淡的微笑：“大家的下一个问题自然是：他在那里吃什么？那么下面，我就请大家看卡多吃一顿午餐。”</p>
<p>　　他说完又向门的方向挥了一下手，有三个人走进会议大厅，其中两位是参加会议的桑比亚官员，第三个人令大家大吃一惊，他竟是一名纽约警察。他腰上累赘地别着手枪、警棍、对讲机等等，手里提着一个大塑料袋，进门后犹豫地站住了。</p>
<p>　　“是我们请这位警官进入会场的。”依塔对主席说，主席示意让那名警察走上前来。</p>
<p>　　警察走到圆桌旁，两位代表给他让开了位置，他把大塑料袋中的东西都倾倒在桌面上，首先倒出的是一大捆青草，然后是一堆梧桐树叶，最后是一堆深绿色的松针。警察指指这堆青草和树叶，又指指同他一起进来的那两名赞比亚官员说：“这两位先生在庭院里的草坪上拔草，我去制止他们，他们就把我带到这里来了。”</p>
<p>　　依塔起身向警察鞠躬：“尊敬的警官先生，我对我们的粗鲁行为表示歉意，并愿意交纳相应的罚款，我们只是想请你来做个证明，证明这些青草和树叶是真实的。”</p>
<p>　　警察瞪大双眼说：“当然是真实的！是我把它们收集到袋子里一直提到这里的。”</p>
<p>　　依塔点点头：“好吧，卡多该用他的午餐了。”</p>
<p>　　这个桑比亚孩子抓起一大把青草，卷成粗绳壮的一根，像吃香肠那样咬下一大截，津津有味地嚼了起来，草茎被嚼碎时发出的吱吱声清晰可闻……他吃得很快，转眼把那粗粗的一把草吃光了，又开始大口吃树叶……</p>
<p>　　旁观者的反应分为两类：一部分人极力忍住呕吐的欲望，另一部分人则抑制不住开始咽口水，这是在看到别人享用他感觉中的美味时的一种自然条件反射，不管那美味是什么。</p>
<p>　　卡多又卷了一把草吃，然后开始吃松针，他咀嚼的声音立刻发生了变化，一道墨绿色的汁液顺着他的嘴角流下来，他含着满嘴的松针和青草，高兴地对依塔说了句什么。</p>
<p>　　“卡多说这里的草和树叶比桑比亚的味道好。”依塔解释说，“由于盲目引进高污染的工业，桑比亚已经成了西方的垃圾倾倒场，那里的环境污染比这里要严重得多。”</p>
<p>　　在众目睽睽之下，卡多吃光了桌子上所有的青草、梧桐叶和松针，他满意地抹去嘴角的绿色汁液，笑着对依塔点点头，显然是在感谢这顿美味的午餐。</p>
<p>　　用后来一位记者的描述，会议大厅陷入“地狱般的寂静”。不知过了多长时间，这寂静才被主席颤抖的声音打破。</p>
<p>　　“这么说，依塔博士，这就是您代表桑比亚国提交生物安全理事会审查的研究成果了？”</p>
<p>　　依塔镇静地点点头：“是的，这就是我刚才说过的换一个思考方向：我们既然可以用基因工程来改造农作物，为什么不能用它来改造人自身呢？比如说这个桑比亚孩子，他的消化系统经过了重新编程，使他的食物范围大大扩展。对于这样的新人类，农作物完全可以改种一些速生或抗旱的植物，那些以前让我们头疼的疯长的野草对他们来说就是万倾良田。即使是种植传统作物，他们从土地中收获的粮食也要比我们多十倍，比如对于小麦来说，麦秸秆甚至根系他们都能食用。粮食对于他们，将真的如空气和阳光一样随手可得了。”</p>
<p>　　各国代表都如石雕般站在大圆桌旁，把阴沉的目光聚焦到依塔身上，依塔坦然地承受着这些目光，平静地说：“尊敬的各位先生，我向联合国转达鲁维加总统的话：桑比亚已准备好为此承受一切。”</p>
<p>　　主席首先从呆立的状态中恢复过来，撑着桌沿小心地坐下，好像他已虚弱得站立不稳似的，他两眼平视前方说：“您刚才好像说过，这孩子十二岁？”</p>
<p>　　依塔点点头。</p>
<p>　　“这么说，你们十二年前就对人类基因重新编程了？”</p>
<p>　　“确切地说应该是十五年前，第一批编程是使用基因汇编语言进行的，半年后，编程工具改用面向过程的高级语言‘BASIC’。至于卡多，是用面向对象的‘伊甸园++’编程，这是三年以后的事了。我们从食草动物中提取了大量的消化系统的函数和子模块，去掉了反刍部分，经过优化和组合后植入人类的受精卵的基因编码中，但其中有许多程序，比如胃液的成分、胃壁的强度和肠道蠕动方式等，没有借用任何自然代码，纯粹是我们自行编制开发的。”</p>
<p>　　“依塔博士，我们最后想知道，在桑比亚，经过重新编程的人类有多少？”</p>
<p>　　“卡多这一批只有不到一百人，因为我们对面向对象的编程方式还没有十分把握。重新编程的桑比亚人只要是十五年前那两批，使用宏汇编语言和‘生命BASIC’编程的受精卵共有两万一千零四十三个，其中两万零八百一十六个成活并正常分娩。”</p>
<p>　　哗啦一声，上届诺贝尔生物学奖获得者，法国生物学家弗朗西丝女士晕倒了。她旁边的另一位诺贝尔奖获得者，德国生理学家，本届生物安理会轮值副主席施道芬格博士脸色发紫呼吸急促，正闭着眼从胸前的衣袋中摸索硝化甘油片。只有美国代表很镇静，他指着依塔，转身对那个仍然目瞪口呆的警察说：“逮捕他。”</p>
<p>　　他说得很平静，像是朝人借个火儿，看到那个警察茫然不知所措，他平静的薄纱立刻被摧毁了，如火山爆发般咆哮起来：“听到了吗？逮捕他！别管什么辖免权，那是对人的，不是对魔鬼！”</p>
<p>　　主席站起身，试图使美国代表平静下来，然后转向依塔，眼里含着悲愤的泪水说：“博士，您和您的国家可以违反联合国生物安全条约的最高禁令，对人类基因进行重新编程，但你们不该如此猖狂，竟到这个神圣的地方来向全人类的脸上泼粪！你们违反了第一伦理，你们抽掉了人类文明的基石！”</p>
<p>　　“人类文明的基石是有饭吃，桑比亚人只是想吃饱饭。”依塔向主席鞠了一躬，以他特有的缓慢语调说。</p>
<p>　　“好了，我们还是散会吧。”美国代表对主席一挥手说，这时他真的平静下来了，“其实大家早就预料到这事迟早会发生，早些比晚些好。我想各位都知道我们该去做什么了，至少美国知道，我们要赶快去做了！”说完他匆匆而去。</p>
<p>　　会议大厅中人们相继走散，最后只剩下依塔和卡多，还有那个警察。依塔搂着卡多的双肩向门口走去，警察阴沉地盯着孩子的背影，一手摸着屁股上的短管左轮低声说：“真该崩了这个小怪物。”</p>
<p>　　消息传出，举世震惊。</p>
<p>　　第二天，世界各大媒体上都出现了依塔和卡多的图像和照片。依塔用枯枝般的双臂把卡多紧紧搂在他那枯枝般的身躯上，眼睛总是看着地面，而那个黑孩子则强壮剽悍，两眼放光，与依塔形成鲜明对比。两人融为一体，形成了一个不规则的黑色构图，真是活脱脱的一对魔鬼。</p>
<p>　　在以后桑比亚代表团逗留美国的两天里，世界各国要求就地逮捕他们的呼声日益高涨，联合国大厦前每天都有人山人海的抗议游行队伍。社会上对桑比亚代表团，特别是依塔和卡多两人的人身威胁层出不穷，但美国政府表现得十分克制，只宣布将代表团驱逐出境。</p>
<p>　　这两天，依塔不分昼夜地紧紧搂着小卡多，在公共场合他的眼睛总是看着地面。但正如有记者描述，他有着“魔鬼的灵敏”，周围一有风吹草动，他立刻把孩子护到身后，并抬头凝视着异常出现的方向。他的眼窝很深，整个眼睛都隐没于黑暗中。活脱脱的魔鬼！</p>
<p>　　桑比亚政府提出用专机接代表团回国，但美国政府不准桑比亚的飞机入境，别国又不肯租给他们飞机，只好乘欧洲的一架客机。为了安全，桑比亚政府买下了一等舱的全部机票。</p>
<p>　　当桑比亚代表团登上飞机，依塔搂着卡多首先走进空荡荡的一等舱时，他长长地松了一口气，紧搂着卡多的手放松了些。在他们登机时，空中小姐表现出遇到魔鬼时理所当然的反应：满脸恐惧地避得远远的，只有一位欧洲空姐勇敢地领着他们进一等舱。这位金发碧眼的姑娘美丽动人，脸上露着真诚的微笑，温暖了桑比亚人那已凉透了的心。在走出机舱前，她双手合十，用不知从哪里学来的东方礼仪向孩子默默祝福，一时让旁边的桑比亚人的眼睛都湿润了。</p>
<p>　　然后，她掏出手枪，紧贴孩子的头部开了两枪。</p>
<p>　　与后来的传说不同，黛丽丝绝对不是美国政府或其它什么国家派来的杀手，她的谋杀完全是个人行为。事实上，在桑比亚代表团留美期间，美国政府对他们是采取了严密的保护措施的，文明世界要对付的是整个桑比亚国，这之前不想横生枝节，但这最后一击实在是防不胜防。班机上的空姐们都配有反劫机手枪，发射不会破坏机舱的橡木弹头，一般来说被击中后不会致命，但黛丽丝是贴着孩子的两眼开枪的。</p>
<p>　　“我没有杀人，哈哈，我没有杀人！哈哈哈！”黛丽丝开枪后挥着沾满鲜血的双手歇斯底里地欢呼着。</p>
<p>　　依塔抱着卡多的尸体，眼睛仍看着地面，一直等到黛丽丝安静下来。她把血淋淋的手指咬在嘴里，用疯狂的目光盯着依塔，一时间机舱里死一般寂静，只有孩子头部流出鲜血的汩汩声。</p>
<p>　　“姑娘，他是人，他是我的孙子，一个能吃饱饭的孩子。”</p>
<p>　　黛丽丝在法庭上被判无罪，很快被媒体炒成捍卫人类尊严的英雄。</p>
<p>　　桑比亚代表团回国后的第二天，联合国向桑比亚政府发出最后通牒：交出境内所有生物学家和相应的技术人员，交出所有经过重新编程的个体，销毁所有基因工程设施，该国元首到特别法庭同其他主犯和从犯一起接受审判。</p>
<p>　　现在，全世界都小心地把那些基因被重新编程的桑比亚人称为“个体”。</p>
<p>　　桑比亚国拒绝了最后通牒，于是，为了维护人类神圣的第一伦理，文明世界向非洲开始了二十一世纪的十字军东征。</p>
<p>　　下篇</p>
<p>　　“您能不能停一会儿，我看着很累，您这么来回走了有一个多小时了。”布莱尔舰长说。</p>
<p>　　菲利克斯将军仍然以军人标准的步伐来回踱着：“在西点，这是教官惩罚学生的办法之一：让他在操场的一角来回走几个小时。久而久之，我喜欢上了这种惩罚，只要在这时我才能很好地思考。”</p>
<p>　　“这么说，您在西点是个不讨人喜欢的人。我在安纳波利斯海校却很讨人喜欢，那里也有这种惩罚，我一次也没受过，倒是在高年级时，我常用它来治那些刚进校的毛毛头。”</p>
<p>　　“世界任何一所军校都不喜欢爱思考的人，安纳波利斯不喜欢，西点不喜欢，圣西尔和伏龙芝都不喜欢。”</p>
<p>　　“是的，思考，特别是像您那样思考，对我是件很累的事。不过，我不认为这场战争有很多可以思考的东西。”</p>
<p>　　对桑比亚的“外科手术”已持续了二十多天，每天有上千架次的飞机狂轰滥炸，从舰载机上的激光智能炸弹攻击到从阿森松岛飞来的大型轰炸机的地毯式轰炸，还有巡洋舰和驱逐舰上大口径舰炮日夜不停的轰击，这个非洲穷国实在剩不下什么了。他们那只有二十几架老式米格机的空军和只有几艘俄制巡逻艇的的海军，在二十天前就被首批发射的巡航导弹在半小时内毁灭，而桑比亚陆军的二百多辆老式坦克和装甲车也在随后的两三天内被来自空中的打击消灭干净。</p>
<p>　　随后，攻击转向了桑比亚境内所有的车辆、道路和桥梁，而摧毁这些也用不了多长时间。</p>
<p>　　现在，桑比亚国已被打回到石器时代。</p>
<p>　　参加攻击的三个航母战斗群已撤走了两个，只留下林肯号战斗群完成“第一伦理”行动最后的使命。除了林肯号航母外，战斗群还包括一艘贝尔纳普级巡洋舰、两艘斯普鲁恩斯级驱逐舰、一艘孔兹级驱逐舰、两艘诺克斯级护卫舰、两艘佩里级护卫舰、一艘威奇塔级补给舰，还有三艘看不见的“鲱鱼”级攻击潜艇。</p>
<p>　　菲利克斯将军突然从踱步中站住，看着布莱尔舰长，舰长很不舒服地想：这人确实像个学者，而且是神经衰弱的那种。</p>
<p>　　“我还是认为我们离海岸太近了。”菲利克斯说。</p>
<p>　　“这样我们可以向桑比亚人更有力地显示自己的存在。我不明白您担心什么。”舰长挥着雪茄说。</p>
<p>　　舰队，特别是林肯号确实能显示其存在。它是尼米兹级航母的第5艘，于1989年服役，排水量近十万吨，全长三百多米，有二十层楼高，是一座带来死亡的海上钢铁城市。</p>
<p>　　菲利克斯又接着踱起步来：“舰长，您清楚我的观点，我对现代化战争中航空母舰在海上的生存能力一直存有疑虑。在我的感觉中，航母总像是一只漂浮在海上的薄壳大鸡蛋，脆弱得很。”</p>
<p>　　“您也知道，在参联会和军备听证会上，我是一贯支持您的看法的。但现在，桑比亚军队拥有射程最远的武器可能就是55毫米的迫击炮了，如果有，它也只能藏在地窖里，拉出来十分钟内就会被摧毁……事实上，我也觉得这是一场无聊的战争，军队在精神上正在衰落，主要原因是缺少自己的英雄偶像。二十世纪后期的几场战争，都没有造就出像巴顿、麦克阿瑟、艾森豪威尔的英雄，因为敌手太弱了，这次也一样。”</p>
<p>　　这时，一名参谋递给菲利克斯一份电报，他看后喜上眉梢，这几乎是攻击开始后他第一次真正露出笑容。</p>
<p>　　“看来这一切都快结束了，桑比亚政府已接受了所有条件，他们将很快交出桑比亚境内所有生物学家和基因工程师，以及所有基因被重新编程的个体，在这一切都完成后，元首将本人将投案自首。”菲利克斯把电报递给布莱尔。</p>
<p>　　布莱尔看都没看就把电报扔到海图桌上：“我说过这是一场乏味的战争。”</p>
<p>　　两位将军透过他们所在的航母塔岛上的舰长室宽大的玻璃窗看到，一架海军陆战队的直升机从海岸方向飞来，降落到林肯号的甲板上。依塔一行几人从直升机上走下来，并在周围陆战队员的枪口下低头向塔岛走来。依塔走在最前面，他仍穿着那身民族服装，像一根披着一块大布的老树枝。</p>
<p>　　过了一会儿，这一行人走进塔岛，进入舰长室。除了依塔仍两眼朝下外，其他人都不由四下打量起来。如果只看四周，这里仿佛就是一间欧洲庄园的豪华餐厅，有着猩红色的地毯，华丽的镶木四壁上刻着浮雕，挂着反映舰长趣味的大幅现代派油画。但抬头一看，就会发现天花板是由错综复杂的管道组成的，这同周围形成了奇特的对比。高大的落地窗外，舰载飞机在不间断地呼啸着起降。</p>
<p>　　依塔博士没有抬头，向菲利克斯所在的方向微微弯了一下腰，用虚弱的声音缓缓说：“尊敬的将军，我带来了桑比亚国真诚的敬意，您率领的舰队那天神般的力量令我们胆寒，我们屈服认罪。”</p>
<p>　　菲利克斯将军说：“博士，我希望您真的明白你们在做什么。”</p>
<p>　　“我们明白，在文明世界的上帝面前我们跪下，我们认罪，但将军，人要是饿得厉害，就顾不得什么廉耻了。”依塔深深地鞠躬说。</p>
<p>　　周围一群年轻的参谋都用鄙夷的目光看着面前这根老干柴。“博士？”一直没说话的布莱尔舰长喊了一声，依塔微微抬头，被舰长呸的一口吐在脸上，他仍石雕般一动不动地立着，任白色的唾液顺着他那深纹密布的脸流到纷乱的胡子上。</p>
<p>　　菲利克斯惋惜地摇摇头：“您本来可以不挨饿的，留在文明世界，您有可能再获得一次诺贝尔奖，却去为一个连人类最起码的伦理都不顾的极权政府工作。”</p>
<p>　　“我为桑比亚人民工作。”依塔又鞠了一躬。</p>
<p>　　“你给桑比亚人民带来了灾难。”菲利克斯说。</p>
<p>　　“不管这场灾难是谁带来的，将军，鲁维加总统都殷切希望它快些结束。为表达这个和平的心愿，国王还给将军带来了一件小小的礼物。”</p>
<p>　　依塔说完，从后面的一个人手中拿过了一个鸟笼大小的木笼子，依塔把笼子放到地毯上，轻轻打开笼门，一个雪白的小动物跑了出来，舰长室中的所有军人发出一阵惊叹声。那是一匹小马！它只有小猫大小，但在地毯上奔跑起来矫健灵活，雪白的鬃毛在飘荡，明亮有神的眼睛惊奇地看着这个世界，然后发出了一声清脆悠扬的嘶鸣。更奇怪的是，小马居然长着一对雪白的翅膀！</p>
<p>　　他们仿佛看到了从童话中跑出来的精灵！</p>
<p>　　“啊，太美了！我想这是您的基因软件的杰作吧？”菲利克斯惊喜地问。</p>
<p>　　依塔又微微鞠了一下身回答：“这是马和鸽子的基因组合体。”</p>
<p>　　“它能飞吗？”</p>
<p>　　“不能，它的翅膀没那么大力量。”</p>
<p>　　菲利克斯说：“博士，我代表贝纳感谢您，哦，贝纳是我的十二岁的小孙女，她为这礼物一定会高兴得发狂的！”</p>
<p>　　“祝她幸福美丽，也祝未来的桑比亚孩子有他十分之一的幸运，十分之一就足够了，将军。”</p>
<p>　　以后三天，大批的运输直升机频繁往返于桑比亚的内陆和沿海之间，从内地运来大批桑比亚政府交出的经过基因编程的“个体”，他们都是十五岁的黑人，绝大部分是男性。这些人被装上等候在沿海的运输船和登陆艇，每艘船装满后立刻向远海驶去。</p>
<p>　　由于收到了中央情报局的一份紧急情报，菲利克斯将军决定再次召见伊塔。伊塔走进舰长室后，立刻目不转睛地看着窗外，在不远的海面上，几架体形庞大的支奴干运输直升机正悬停在一艘运输舰上方，黝黑的“个体”不停地从机舱中爬出，顺着软梯下到戒备森严的甲板上，然后在持枪士兵的推搡下进入舱里。</p>
<p>　　菲利克斯来到伊塔身边，同他一起看着海上的情景，“这是最后几船了，三天运走了两万个个体。”</p>
<p>　　“他们要被送到哪里？”伊塔问。</p>
<p>　　“博士，这不是你我需要关心的事情。”菲利克斯冷冷地说。</p>
<p>　　“我们所在的这艘大船叫林肯号是吗？”伊塔突然问，菲利克斯茫然地点点头。“怎么会叫这个名字呢？上上个世纪，非洲的黑奴就是这么被运走的，他们的基因并没有经过重新编程。”</p>
<p>　　菲利克斯笑着摇摇头：“这是两回事，博士。我可以许诺，当这些个体还在我的管辖范围内时尽可能得到人道的待遇，就是野生动物也应该受到保护的，但仅此而已，他们以后的命运与我无关，与您也没有关系了。”</p>
<p>　　看到伊塔沉默无语，菲利克斯接着说：“那么，我们谈正事吧。博士，我知道那些个体比正常人要健康得多，但他们有时也会得一些正常人不会得的病，比如前不久，在个体中传染一种皮肤病，虽不会致命，但患者十分痛苦。为了制止这种病的传染，你们研制了一种接种疫苗，委托欧洲的一家制药公司生产，据我所知，已交货的疫苗总量够四万个个体用的。”</p>
<p>　　菲利克斯注意到伊塔掩着披布的一只手难以觉察地抖动了一下，但说话的声调仍是那么沉缓：“只有两万余名个体，将军。”</p>
<p>　　菲利克斯点点头：“我愿意相信，博士，只是有一个小小的要求：能把那剩下的两万份疫苗让我们看一下吗？只是看一下，我们不带走，它们对正常人没用。”</p>
<p>　　伊塔不说话。</p>
<p>　　“您是想说，它们在轰炸中毁了吗？”</p>
<p>　　伊塔缓缓地摇摇头：“不，那些疫苗都用完了。将军，我清楚您已经什么都知道了。”</p>
<p>　　“是的博士，您撒了谎：十五年前重新编程的受精卵不是两万个个体！立刻把他们交出来。”</p>
<p>　　伊塔把枯瘦的身体转向菲利克斯，眼睛仍然看着下方，这使人觉得他像一个人盲人，他说：“将军，在我的感觉中，您是一个明白人。”</p>
<p>　　菲利克斯双眉一挑问：“哦，在哪些方面？”</p>
<p>　　“很多方面，比如，您真是以一个十字军骑士的激情来领导这场战争吗？”</p>
<p>　　菲利克斯摇摇头：“不，我是以很理性的态度来对待自己的使命的，对于国际社会在这件事情上的大惊小怪，我觉得多少是一种矫情。”</p>
<p>　　伊塔无动于衷，倒是旁边的布莱尔舰长把目光从伊塔移到菲利克斯身上，吃惊地盯着他：“将军……”</p>
<p>　　“随着本世纪头二十年基因工程突飞猛进的发展，人类社会的宗教情绪也与日俱增，表面看来这是对生命伦理的崇敬和维护，其实是人类在使其茫然的技术社会中试图找到一种精神依托的表现。”</p>
<p>　　布莱尔大叫起来：“怎么能这样说将军？您应该知道，对人类基因的重新编程等于把人类置于与他自己可以随意制造的机器一样的地位，这将摧毁现代文明的整个法制和伦理体系基础！”</p>
<p>　　“您把电视上的话背得很熟，”菲利克斯不以为然地笑笑说，“但您所说的信仰和伦理体系是以西方基督教文化为基础的，而别的文化并不一定认同这种体系。在伊塔博士的非洲文化中，创世主的概念是很模糊的，比如马萨伊曾说：”当神着手准备开创世界时，他发现那里有了一只多洛勃（狩猎的部落），一头象和一条蛇。‘就是说人类和其它生命是先在的，是一种自发的创造物。对人为干预生命的进化，并没有西方基督教文化这么多的忌讳。就以西方文化本身来说，它的法制和伦理也不会因为对人类基因的重新编程而崩溃，事实上，为了更小的理由，我们早就在违反第一伦理，比如本世纪出现的克隆人，上世纪的试管婴儿，更早一些的时候，我们那些高贵的女士为了少一些麻烦和责任，并没有太多的犹豫就去流产和堕胎了。在这些事实面前，我们的法制和伦理体系好像也很现实地适应了，并没有丝毫崩溃的迹象。至于西方世界对在非洲发生的这件事这么大惊小怪，不过是因为我们不需要以野草和树叶充饥罢了。“</p>
<p>　　布莱尔目瞪口呆了好一会儿，迷惑地摇摇头。</p>
<p>　　菲利克斯对伊塔笑笑说：“别在意，博士，布莱尔舰长显然平时很少思考这类问题。”</p>
<p>　　“我的任务不是思考。”舰长气鼓鼓地说。</p>
<p>　　“菲利克斯将军是个明白人。”伊塔真诚地说。</p>
<p>　　“我已经足够坦率，那么请问博士，您是如何一眼把我看透的呢？”</p>
<p>　　“不是一眼，我们十多年前见过面，那是在麻省理工的一次鸡尾酒会上，你当时还是一名准将，在南卡罗来纳州的新兵训练营负责新兵训练工作。您说在现在的美国青年中，可以招到像科学家的士兵，像工程师的士兵，像艺术家的士兵，但像士兵的士兵却越来越难找了。接着你就说，基因工程有可能为美国创造出合格的士兵，这是军方人士第一次在这样的生物学家会上说这种话，因此我记住了您。”</p>
<p>　　“这真是一个好主意。”布莱尔舰长赞许地点点头。</p>
<p>　　“所以，舰长，只要有需要，伦理终究是第二位的。”菲利克斯对布莱尔说，极力掩盖自己的轻蔑。</p>
<p>　　“那么，将军，您一定理解我的恳求，求你们放过那两万个桑比亚人吧。”伊塔对“第一伦理”行动的指挥官连连鞠躬，看上去真像一个老乞丐。</p>
<p>　　菲利克斯坚定地摇摇头：“博士，我是军人，在执行使命，这与我对基因工程的看法没有关系。再说一遍：把那两万个个体交出来，即使您认为他们是桑比亚的未来。”</p>
<p>　　“将军，他们是全人类的未来。”</p>
<p>　　“这没有意义，我们不但确切地知道那两万个体的存在，甚至能猜到他们的隐藏之处，如果你们拒绝交出，我们只能轰炸那些丛林。”菲利克斯把手向下一劈说。</p>
<p>　　“知道怎样轰炸吗？”布莱尔把脸凑近伊塔说，“不是用林肯号上的飞机，它们太小了，是从阿松森基地飞来的巨型轰炸机，它们装满了燃烧弹，在那些丛林地带沿X形的对角线投弹，这样不管风向如何，都能形成一片完美的火场，其中的温度可以烧化桥梁，连细菌都活不下去。”</p>
<p>　　菲利克斯接着说：“怎么样博士，即使为了那些个体着想，也应该把它们交出来。”</p>
<p>　　伊塔用当地的土语哀叹了一句什么，整个身体像失去支撑似的摇摇欲坠。“给我电话，我向政府转达你们的意思。”</p>
<p>　　“很好，还要说明，不能用上次的移交方式，从内陆用直升机运送两万人太困难，在降落地点和途中还不时遭到游击队的袭击。我们要求你们把那两万个个体运到海岸来，就在这片沿海平地上，在舰队的火力控制范围内。以上的事完全由你们来做，然后我们用登陆艇一次性接收。”</p>
<p>　　“我转达。”伊塔无力地点点头。</p>
<p>　　当伊塔随着押解的陆战队员走到舰长室门口时，他突然转过身来，美国人惊奇地发现他的腰不驼了，现在站得挺直，这才可以看到他原来是那么高大的一个人。他那双隐没于眼窝中黑影中的眼睛，自那仿佛看不见底的黑潭中射出两道冷光，令在场所有人打了个寒战。</p>
<p>　　“离开非洲。”伊塔说。</p>
<p>　　“您说什么？”布莱尔舰长问。</p>
<p>　　伊塔没有理会，转身迈着大步走出去，那步伐之强健有力也与以前判若两人。</p>
<p>　　“他说什么？”布莱尔又转身问其他人。</p>
<p>　　“他让我们离开非洲。”菲利克斯说，双眼沉思地盯着伊塔离去的方向。</p>
<p>　　“他……哈……他真幽默！”布莱尔大笑起来。</p>
<p>　　入夜，在舰长室里，菲利克斯将军入神地看着桑比亚人送他的那匹小马，它正站在宽大的海图桌上，津津有味地吃着勤务兵刚送来的卷心菜。然后，他起身来到外面的舰桥上，凝视着远方的非洲海岸，一股热风吹到脸上，风中夹着烟味，远方的陆地笼罩在一片红光之中，那是桑比亚的城市在燃烧。火光映红了半边夜空，并在海水中反射，构成了一个虚假的黎明。</p>
<p>　　“将军，看得出您很忧虑。”布莱尔舰长也悄声来到舰桥上，在菲利克斯后面问。</p>
<p>　　“我们面对的，是一个被逼到墙角的民族。”菲利克斯看着燃烧的大陆说。</p>
<p>　　“那又怎么样？在这个世界上，鸡蛋就是鸡蛋，石头就是石头，我相信一切都会很顺利的。”</p>
<p>　　“但愿如此吧。四十多年前的那一天我记得很清楚，我和几名陆战队员一起守在西贡大使馆的楼顶，直升机正在运走最后一批人。文进勇将军指挥的北越军队离那儿只有几百米了，而美国在越南的势力范围，只剩大使馆楼顶这几十平方米了。一颗炮弹飞来，一名陆战队员被齐胸炸成两半，我还记得他的名字，他是最后一个死于越南的美国军人……那一时刻铭心刻骨，从此我明白了战争是一个很深奥的东西，谁都难以真正看透它。”</p>
<p>　　当菲利克斯被一名中校参谋叫醒时，天刚蒙蒙亮。参谋告诉他，指定的海岸地段已经集结了两万多桑比亚人，好像就是桑比亚政府交出的那两万个个体。</p>
<p>　　“不可能这么快的！”菲利克斯盯着参谋喊道，“他们靠什么集结？桑比亚大部分的公路和铁路都难以通行，就是有畅通的道路和足够的车辆也不可能这么快集结两万人！”</p>
<p>　　菲利克斯起身抓起一个望远镜，冲到舰桥上，清晨的海风让他打了一个寒战，舰桥上已站满了举着望远镜观察海岸的海军军官，布莱尔舰长也在其中。</p>
<p>　　向岸上望去，望远镜中出现的是从海岸伸延出去的广阔平原，燃烧的城市升起的烟雾如同平原后面一张巨大的黑灰色幕布。菲利克斯看到平原的地平线上有几个黑点，这些黑点渐渐变成了一条条黑线，很快，这些黑线连接起来，给地平线镶上了一道黑边。菲利克斯将军立刻看出了这不是那两万个等待接收的“个体”，而是一支准备发起攻击的陆军部队。他们队形整齐地推进着，菲利克斯放下望远镜，用肉眼也能看到桑比亚军队像黑色的地毯一样渐渐覆盖了平原。</p>
<p>　　他再次举起望远镜，看到阵线在加快速度，很快整个方阵都飞奔起来，黑人士兵们高举着冲锋枪怒吼着，像潮水一样扑向大海。</p>
<p>　　“桑比亚人要投海自杀？”舰队中所有目睹这一壮观景象的人都迷惑不解。在林肯号上，菲利克斯将军首先发现了什么，脸一下变得煞白，他扔下望远镜，声嘶力竭地大叫起来。</p>
<p>　　“战斗警报！舰炮射击！所有攻击机起飞！快！”</p>
<p>　　战斗警报尖厉地响起。已冲到海边的桑比亚步兵阵线中突然出现了一大片白色的东西，那一片白色急剧抖动着，激起了高高的尘埃，舰队的人们一时无法相信自己的眼睛。</p>
<p>　　所有的桑比亚士兵都长着一对白色的翅膀，这是两万多名会飞的人！</p>
<p>　　在一片尘埃之上，飞人升到空中，飞行的阵线黑压压一片，遮住了初升的太阳，这空中军队越海向舰队扑来。</p>
<p>　　这时，舰队的宙斯盾系统已对来袭的飞人做出了反应，首批舰对空导弹从林肯号周围的巡洋舰射向飞人，约五十条白色的烟迹扎入了飞人群中。这首批导弹都击中了目标，清脆的爆炸声从空中传来，在一阵闪光后飞人群中出现了一团团黑烟，被击中的飞人血肉横飞，翅膀的白色羽毛如一片片细微的雪花在天空飘散。航母上观战的人们发出一阵欢呼声，但凭理智仔细观察攻击效果的菲利克斯将军和布莱尔舰长心凉了半截，一道简单但严酷算术题摆在他们面前。</p>
<p>　　从现在的情况看，每枚航空导弹在击中目标时，弹头爆炸的杀伤力可击落周围2到3个人飞人。舰队的舰空导弹的弹头是为击毁空中战机这样的点状目标而设计的，爆炸时只产生很少的高速弹片，因而面积杀伤力不大，而飞人受到导弹攻击后正以很快的速度散开，所以，一枚舰空导弹很快只能击落一个飞人了。具有较强面积杀伤力的舰对舰导弹和巡航导弹对这样方向和距离的目标毫无用处。</p>
<p>　　这里还有一个致命的弱点：舰队的舰空导弹中只有不到一半采用传统的红外、雷达和激光制导方式，这大多是上世纪就已准备的“海标枪”、“海麻雀”和“标枪”型舰空导弹。</p>
<p>　　近年来，被这只强大舰队真正引以为骄傲的是采用像素制导的舰空导弹，像素制导是上世纪的导弹设计师们追求已久的梦想，在这种制导方式下，导弹感受到的目标不再是传统制导方式下的点状，而是一个三维图像，通过高超的模式匹配技术对目标进行识别，正如给导弹装上了一双智慧的眼睛，这就使得导弹可以打击目标最致命的部位，因而像素制导导弹的战斗部较传统导弹大为减小。但现在在这双智慧之眼中，那些飞人怎么看也不像是需要打击的空中目标，更像是大些的飞鸟，所以这些聪明的导弹都做出了理智的选择：绕开他们。人工智能再一次变成了人工愚蠢，更换每个导弹的模式数据库是无论如何也来不及了。</p>
<p>　　整个舰队携带的舰对空导弹约为3000枚，这比正常情况已超载一倍了。这样数量的导弹在“宙斯盾”系统的引导下，足以对付一个大国的全部空军力量对舰队发动的攻击，进行这种攻击的敌机可能有两千架左右。而现在，舰队面对着十倍数量的飞人，每个飞人对舰只的攻击能力当然无法同战机相比，但要击落它，也要耗费一枚导弹。用航母上的战斗机对付飞人，道理也一样，况且战斗机可能来不及起飞。于是，两位将军，他们统率着这个星球上最强大的舰队，现在不得不承认这样的现实：对于飞人，航母战斗群的主要武器不再具有优势，质量代替不了数量。</p>
<p>　　林肯号的周围，舰空导弹一批接着一批地发射，导弹的尾迹在空中组成一团巨大的乱麻。</p>
<p>　　舰队没有人欢呼了，现在即使普通水兵也解开了那道算术题，以往他们最引以为自豪的东西现在也靠不上了。</p>
<p>　　当所有的舰空导弹全部用光后，只击中了不到两千个飞人，而现在，从海岸方向向舰队冲来的飞人阵线前锋，已掠过了战斗群外围的巡洋舰和驱逐舰，直向林肯号航母扑来。</p>
<p>　　现在，舰队只能依靠舰炮和机枪火力了，几乎所有的舰炮都全力射击。打击飞人最为有效的武器是密集阵火炮系统，它原是用于击落1500米范围内突破舰队防御系统的漏网反舰导弹的，它由6管20毫米火炮组成，具有每分钟3000发的高射速。密集阵火炮的每一次扫射，都在空中划出一条死亡的曲线，都有一排飞人被它那密集的弹流击落。但密集阵火炮无法长时间连续射击，它的高射速和快初速使炮管很快发热老化，必须频繁地更换，加上数量有限，它们最终也无法对来袭的大批飞人形成有力的阻击。其它的大口径舰炮射速太慢，同时，飞人的飞行轨迹是一条不断波动的正弦线，用普通舰炮对它们射击就像用步枪打蝴蝶一样，命中率很低。所以现在惟一能依靠的武器就是机枪了。</p>
<p>　　这时，菲利克斯的脑海中浮现出古代中国关于冷兵器战争的一句话“临敌不过三发”，意思是说在敌人的骑兵冲到阵地前这段时间里，弓箭手只能射出三支箭，这绝妙地反映了目前林肯号的处境。</p>
<p>　　现在，飞人开始对林肯号冲击了，飞人从各个高度接近航母，最高的飞人飞到上千米，最低的紧贴海面掠过。近两万名飞人使林肯号笼罩在一团死亡的阴云中，航母上的人听到从各个方向传来的飞人的呼喊声，这些声音使他们他们头皮发炸，抬头看着那密密麻麻的遮住阳光的飞人群在头顶盘旋，他们仿佛身处噩梦之中，同时也意识到一个严酷的现实：在高技术的温床中沉浸了几十年后，他们终于获得了一个成为真正战士的机会——要同敌人面对面肉搏了。</p>
<p>　　意识到这点，菲利克斯反而冷静了许多，他拿起扩音器，沉着地发出命令：“立刻向舰上人员分发所有轻武器，重点防守塔岛、升降机口、弹药库、航空油库和核反应堆。这是最高指挥官在说话，全舰人员，准备接敌近战！”</p>
<p>　　布莱尔舰长茫然地看着菲利克斯将军，好半天才理解了他的话的含义。他默默地走到海图桌面前，从一个抽屉里拿出自己的手枪，他看着枪，无言地沉思着。突然，他听到了一声悠扬的嘶鸣，是那匹小飞马发出的。舰长抬枪对着小马射出三发子弹，那个美丽的小精灵倒在血泊中。</p>
<p>　　又一个措手不及的尴尬场面出现了：在早期航母中，轻武器是由各战位分散保管的，但由于自二战以来舰上人员从未有使用轻武器的机会，所以不知从什么时候起，现代航母上的轻武器都在一个专用仓库中集中保管。林肯号上有近六千人，除了岗位不能离开的人外，有近四千人拥向位于航母中层的军火库中去领枪，一时把狭窄的通道堵塞了。军火库门口更是乱做一团，负责发放武器的军官只能把枪向人群中扔，领到枪的人也挤不出去，只能把枪向后传，看上去很像近代某个城市暴动的场面。这时林肯号广阔的飞行甲板只能由舰上数量不多的海军陆战队守卫了。</p>
<p>　　第一个飞人在林肯号的飞行甲板上着陆了，他那雪白的双翅轻盈地抖动，双脚接触到甲板时没发出一点声音。这时谁也不会认为他是魔鬼，这是希腊神话中才有的人物，是神灵的化身，它来自远古的梦幻，如同一个美丽的幻影降落到人类这粗陋的钢铁世界中。甲板上的陆战队员被他那惊人的美震撼了，很多人呆呆地站着，忘了开枪。但这个飞人战士还是很快被来自各个方向的弹雨击倒了，飞人倒在甲板上，双翅上雪白的羽毛被他自己的鲜血染红了。紧接着又有三个飞人着舰，其中一名幸存下来，躲到飞行甲板左舷的一个光学引导装置后面同陆战队员们对射起来。</p>
<p>　　又有几个飞人降落被击毙后，飞人战士们意识到这时着舰代价太大，就开始从空中向航母投掷手榴弹。航母上的人们也尝到了被轰炸的滋味，当一大群飞人呼啸着从飞行甲板上空掠过后，手榴弹如冰雹般劈哩啪啦地落下，然后在一片爆炸声中，那些仍停在甲板上的昂贵的“雄猫”和“大黄蜂”一架架被炸成碎片。</p>
<p>　　来自空中的手榴弹成功地遏制了航母上的轻武器火力，飞人的第二次强行降落取得了成功，很快就有上百名飞人战士登上了林肯号，他们依托着左右舷的下陷结构和甲板上飞机的残骸同舰上的陆战队和水兵枪战，掩护更多的飞人着舰。</p>
<p>　　现在，令林肯号的守卫者们最尴尬的局面出现了：首先，他们在人员素质上处于劣势。经过基因优化，又在非洲丛林中成长的飞人是天生的战士，在这传统的近战中，他们骁勇敏捷，所向无敌。而林肯号上的人，除了为数不多的海军陆战队员外，其他人与其说是军人还不如说是工程师和技师，受过的陆战训练不多，在这残酷的近战中根本不是飞人战士的对手。最可怜的要数那些飞行员了，这些曾令多少敌人闻风丧胆的空中杀手，航母战斗群的刀锋，现在什么都不是了。布莱尔悲哀地从舰长室的窗中看到一名中校飞行员，缩在F14的座舱中，伸出手枪乱打一气，弹夹打光了还在不停扣扳机，直到一名脸上涂着红黑相间条纹的飞人爬上飞机，用一把猎刀砍下他的脑袋为止……</p>
<p>　　更令“第一伦理”行动的执行者们无法忍受的是，他们现在在武器上也处于劣势！在这样的近战中，他们的M16步枪并不比桑比亚飞人手中古老的AK47好多少。而且，林肯号上轻武器库中的步枪只有不到两千支，这样，舰上大部分人只能用手枪作战了。林肯号上的6000官兵不过是被堵在钢铁中的一堆肉而已。</p>
<p>　　在三个足球场大小的飞行甲板上，飞人仍在以很快的速度降落，现在，他们在舰上的人数已过千人。林肯号虽然在人数上仍占优势，但大部分人都被刚才飞人从空中的手榴弹轰炸堵在舱内，飞行甲板渐渐被飞人战士控制。现在，他们重点攻击的目标有两个：一个是飞机升降机口，这是进入舰体内最宽敞的通道；另一个是塔岛，这是航母的神经中枢。</p>
<p>　　一群飞人从舰长室外掠过，可以听到手榴弹乒乒乓乓地砸在舱壁上，有一枚破窗而入，落到海图桌上。看着那个冒着青烟旋转的东西，菲利克斯将军仿佛走进了时间隧道，又闪回到他的青年时代。那是在热带暴雨中的越南丛林中，18岁的他也看到一枚手榴弹在眼前冒着青烟旋转，甚至外形也同眼前这颗一样，是前华约国制式武器，弹体和弹柄都是绿色的……对历史和现实的感触都凝缩在这生死一瞬，将军出神地盯着那个东西，多亏一名参谋把他扑倒在地。</p>
<p>　　又过了十几分钟，着舰的飞人已超过两千，他们完全控制了飞行甲板，也成功地阻击了周围的巡洋舰和驱逐舰上的增援。现在从外面看，林肯号上已全是飞人的身影，AK冲锋枪嘶哑粗放的射击声盖住了一切，M16步枪纤细的啪啪声只能零星听到。</p>
<p>　　突然，布莱尔舰长听到了一声爆炸，从升降机方向传来。同到处响起的手榴弹爆炸声相比，它很沉闷，只是隐隐约约能听到。他的心顿时沉到了底，作为一名经验丰富的军人他不会听错的，这是飞人战士在用塑性炸药炸开舰体内部的水密门，他们已进入了林肯号。菲利克斯也意识到了这点，他知道，现代巨型航空母舰的内部结构是极其复杂的，即使舰上人员，在没有地图的情况下也会迷路。但对于飞人战士，这可能不是个太大的障碍，因为他们要找的地方都是体积庞大的方位明确的。林肯号有三个致命处：弹药库、航空油库（存放着供舰上作战飞机使用的8000吨航空燃油）和为全舰提供动力的两座压水核反应堆，飞人战士找到这三样东西中的任何一样，林肯号就死定了。同时，核动力航母是一个极其复杂的系统，在内部随意的破坏也可能带来致命的后果。</p>
<p>　　那不详的爆炸声又响了起来，一声比一声更沉闷，如同一只巨兽的脚步，一步步走向林肯号的深处走去……</p>
<p>　　现在，结局只是时间问题。</p>
<p>　　着舰的飞人已过五千，甲板上的战斗基本停止了，而指挥塔岛同全舰和外界的联系几乎中断，虽然塔岛还未完全失守，林肯号已失去了大脑。</p>
<p>　　在以后的一个多小时内，林肯号几乎沉静下来，只有舰体内的爆炸声能隐约听到，而且向不同的方向扩散。飞人战士像进入林肯号这只巨兽体内的无数只蚂蚁，正在吞食着它的内脏。同时，飞人加强了对塔岛的攻击，在从下面攻打的同时，他们从空中直接跳到塔岛的上层建筑上。</p>
<p>　　突然，林肯号微微振动了一下，布莱尔冲到窗边，看到大团的白色蒸气从舰体两侧升起，并听到一阵隆隆声，那是舰体下面的海水沸腾的声音。舰长知道，飞人战士找到了林肯号三个致命处的一个：核反应堆。虽然反应堆在舰体的最下部，但它们的方位是最明确的。</p>
<p>　　飞人战士显然已炸毁了反应堆的冷却系统，布莱尔可以想像，堆中的反应物质如火山岩浆般流了出来，但它比岩浆灼热许多倍，它流到航母的舰底，就如同把烧红的火炭放到硬纸板上一样，很快就把舰底烧穿了。</p>
<p>　　又一阵冰雹般的手榴弹扔到舰长室周围，震耳欲聋的爆炸后，AK冲锋枪密集地在外面响了起来，好像是一阵突然爆发的狂笑。保卫舰长室的陆战队员们在舱门和窗口相继倒毙，一群飞人战士撞开门冲了进来，他们的翅膀合在身后，像是披着白色的斗篷。布莱尔舰长伸手去拿放在海图上的手枪，立刻同几名年轻参谋一起被眼疾手快的飞人战士乱枪打死。菲利克斯将军手里握着枪，但没举起来，飞人战士盯着他肩上的四颗星，没有再开枪，他们就这样对峙着。</p>
<p>　　飞人们突然向两边分开，伊塔博士走了进来。他们仍披着那块披布，同周围戎装的飞人战士形成鲜明的对比，一个飞人用生疏的英语让菲利克斯放下武器。</p>
<p>　　菲利克斯仍紧握着手枪，用另一只手整理了一下军服：“开枪吧，黑鬼。”</p>
<p>　　伊塔博士抬起头来，菲利克斯又一次看到了他那深邃的双眼。</p>
<p>　　“将军，我们的血也是红的。”</p>
<p>　　“你们可以击沉林肯号，但最后一个也跑不掉的！”</p>
<p>　　伊塔笑了一下，这是菲利克斯第一次看到他笑。“他们当然能跑掉，他们可以任意飞越国境，雷达系统不能把他们同飞鸟区别开来，他们到处都能得到食物，即使是现代社会，要消灭这样一批人也是不容易的。更重要的是，他们很快就会成为合法的人，将享有作为一个人的一切权利。”</p>
<p>　　“这我不明白。”</p>
<p>　　“您是个聪明人，正如您所说，即使在所谓的文明世界，只要有需要，伦理是第二位的。</p>
<p>　　那里的人们当然不需要吃野草和树叶，但他们肯定需要飞翔，这是人类最古老的梦幻，没人能抵挡它的诱惑。您将会看到，想像中的魔鬼并不存在，天使时代即将到来，在那个美好的时代里，人类在城市和原野上空飞翔，蓝天和白云是他们散步的花园，人类还将像鱼一样潜游在海底，并且以上千岁的寿命来享受这一切。将军，您已经看到了这个时代的曙光。“</p>
<p>　　伊塔博士说完，转身走了出去，同时用桑比亚语说了句什么，接着所有的飞人战士都转身走了，没有一个人再看菲利克斯一眼。</p>
<p>　　林肯号航空母舰直到黄昏时才完全沉没，当舰上的塔岛最后沉入水中时，被压出的空气发出巨大的嘶鸣，像非洲海岸凄厉的号角，菲利克斯将军站在一艘巡洋舰的舰桥上，用困惑的目光望着远方古老的土地。</p>
<p>　　在那块百万年前诞生人类的土地上，飞人群正在夕阳中盘旋。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/17/es6 扩展运算符 三个点（...）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/17/es6 扩展运算符 三个点（...）/" itemprop="url">es6 扩展运算符 三个点（...）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-17T14:46:18+08:00">
                2017-02-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="它是什么"><a href="#它是什么" class="headerlink" title="它是什么"></a>它是什么</h1><p>es6中引入扩展运算符（…），它用于把一个数组转化为用逗号分隔的参数序列，它常用在不定参数个数时的函数调用，数组合并等情形。因为typeScript是es6的超集，所以<strong>typeScript也支持扩展运算符</strong>。</p>
<h1 id="用在哪儿"><a href="#用在哪儿" class="headerlink" title="用在哪儿"></a>用在哪儿</h1><h3 id="可变参数个数的函数调用"><a href="#可变参数个数的函数调用" class="headerlink" title="可变参数个数的函数调用"></a>可变参数个数的函数调用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">array, ...items</span>) </span>&#123;  </span><br><span class="line">  array.push(...items);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">...vals</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> sum=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;vals.length;i++)&#123;</span><br><span class="line">    sum+=vals[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"><span class="keyword">let</span> sum = add(...arr);</span><br><span class="line"><span class="built_in">console</span>.log(sum);  <span class="comment">//21</span></span><br></pre></td></tr></table></figure>
<h3 id="更便捷的数组合并"><a href="#更便捷的数组合并" class="headerlink" title="更便捷的数组合并"></a>更便捷的数组合并</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = [<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"><span class="keyword">let</span> newArr = [<span class="number">20</span>];</span><br><span class="line"><span class="comment">//es5 旧写法</span></span><br><span class="line">newArr = newArr.concat(arr1).concat(arr2); <span class="comment">//[20,1,2,5,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(newArr);</span><br><span class="line"><span class="comment">//es6 使用扩展运算符</span></span><br><span class="line">newArr = [<span class="number">20</span>,...arr1,...arr2];  <span class="comment">//[20,1,2,5,6]</span></span><br><span class="line"><span class="built_in">console</span>.log(newArr);</span><br></pre></td></tr></table></figure>
<h3 id="替代es5的apply方法"><a href="#替代es5的apply方法" class="headerlink" title="替代es5的apply方法"></a>替代es5的apply方法</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES5 的写法  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y, z</span>) </span>&#123;  </span><br><span class="line"><span class="comment">// ...  </span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">var</span> args = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];  </span><br><span class="line">f.apply(<span class="literal">null</span>, args);  </span><br><span class="line"><span class="comment">// ES6 的写法  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y, z</span>) </span>&#123;  </span><br><span class="line"><span class="comment">// ...  </span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">var</span> args = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];  </span><br><span class="line">f(...args);</span><br></pre></td></tr></table></figure>
<p>求最大值Math.max()</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES5 的写法  </span></span><br><span class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, [<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])  </span><br><span class="line"><span class="comment">// ES6 的写法  </span></span><br><span class="line"><span class="built_in">Math</span>.max(...[<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])  </span><br><span class="line"><span class="comment">//  等同于  </span></span><br><span class="line"><span class="built_in">Math</span>.max(<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>);</span><br></pre></td></tr></table></figure>
<p>通过push函数，将一个数组添加到另一个数组的尾部</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES5 的写法  </span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];  </span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];  </span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2);  </span><br><span class="line"><span class="comment">// ES6 的写法  </span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];  </span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];  </span><br><span class="line">arr1.push(...arr2);</span><br></pre></td></tr></table></figure>
<p>新建Date类型</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES5  </span></span><br><span class="line"><span class="keyword">new</span> (<span class="built_in">Date</span>.bind.apply(<span class="built_in">Date</span>, [<span class="literal">null</span>, <span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>]))  </span><br><span class="line"><span class="comment">// ES6  </span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(...[<span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>]);</span><br></pre></td></tr></table></figure>
<h3 id="与解构赋值结合，生成新数组"><a href="#与解构赋值结合，生成新数组" class="headerlink" title="与解构赋值结合，生成新数组"></a>与解构赋值结合，生成新数组</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES5  </span></span><br><span class="line">a = list[<span class="number">0</span>], rest = list.slice(<span class="number">1</span>)  </span><br><span class="line"><span class="comment">// ES6  </span></span><br><span class="line">[a, ...rest] = list </span><br><span class="line">下面是另外一些例子。  </span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];  </span><br><span class="line">first <span class="comment">// 1  </span></span><br><span class="line">rest <span class="comment">// [2, 3, 4, 5]  </span></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [];  </span><br><span class="line">first <span class="comment">// undefined  </span></span><br><span class="line">rest <span class="comment">// []:  </span></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="string">"foo"</span>];  </span><br><span class="line">first <span class="comment">// "foo"  </span></span><br><span class="line">rest <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<h3 id="将字符串转为真正的数组"><a href="#将字符串转为真正的数组" class="headerlink" title="将字符串转为真正的数组"></a>将字符串转为真正的数组</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[...<span class="string">'hello'</span>]  </span><br><span class="line"><span class="comment">// [ "h", "e", "l", "l", "o" ]</span></span><br></pre></td></tr></table></figure>
<h3 id="将实现了-Iterator-接口的对象转为数组"><a href="#将实现了-Iterator-接口的对象转为数组" class="headerlink" title="将实现了 Iterator 接口的对象转为数组"></a>将实现了 Iterator 接口的对象转为数组</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> nodeList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'div'</span>);  </span><br><span class="line"><span class="keyword">var</span> array = [...nodeList];</span><br></pre></td></tr></table></figure>
<hr>
<p>end 2017-02-17 14:46:14</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/08/ionic2页面page的生命周期钩子函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/ionic2页面page的生命周期钩子函数/" itemprop="url">ionic2页面page的生命周期钩子函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-08T11:45:54+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ionic2页面page的生命周期钩子函数"><a href="#ionic2页面page的生命周期钩子函数" class="headerlink" title="ionic2页面page的生命周期钩子函数"></a>ionic2页面page的生命周期钩子函数</h1><ul>
<li><p>Page Event    Returns    Description</p>
</li>
<li><p><code>ionViewDidLoad</code>    void    Runs when the page has loaded. This event only happens once per page being created. If a page leaves but is cached, then this event will not fire again on a subsequent viewing. The ionViewDidLoad event is good place to put your setup code for the page.</p>
</li>
<li><code>ionViewWillEnter</code>    void    Runs when the page is about to enter and become the active      page.</li>
<li><code>ionViewDidEnter</code>    void    Runs when the page has fully entered and is now the active page. This event will fire, whether it was the first load or a cached page.</li>
<li><code>ionViewWillLeave</code>    void    Runs when the page is about to leave and no longer be the active page.</li>
<li><code>ionViewDidLeave</code>    void    Runs when the page has finished leaving and is no longer the active page.</li>
<li><code>ionViewWillUnload</code>    void    Runs when the page is about to be destroyed and have its elements removed.</li>
<li><code>ionViewCanEnter</code>    boolean/Promise<void>    Runs before the view can enter. This can be used as a sort of “guard” in authenticated views where you need to check permissions before the view can enter</void></li>
<li><code>ionViewCanLeave</code>    boolean/Promise<void>    Runs before the view can leave. This can be used as a sort of “guard” in authenticated views where you need to check permissions before the view can leave</void></li>
</ul>
<hr>
<p>end 2017-02-08 11:44:47</p>
<p>参考文档：<a href="http://ionicframework.com/docs/v2/api/navigation/NavController/" target="_blank" rel="noopener">http://ionicframework.com/docs/v2/api/navigation/NavController/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/08/2017-02-08-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/2017-02-08-1/" itemprop="url">ionic2使用根导航（rootNav）跳转</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-08T11:32:13+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ionic2使用根导航（rootNav）跳转"><a href="#ionic2使用根导航（rootNav）跳转" class="headerlink" title="ionic2使用根导航（rootNav）跳转"></a>ionic2使用根导航（rootNav）跳转</h1><p>在一个使用tab构建的ionic2应用程序中，如果我们直接使用<code>NavController</code>进行导航跳转，会将新的page压入当前tab的导航栈中。但login、signin、setting等page在业务上不应该属于当前tab，而应该从根组件进行导航，那么此时该如何做呢？<br>看下面的例子即可：</p>
<h2 id="在一个组件中跳转到根导航中"><a href="#在一个组件中跳转到根导航中" class="headerlink" title="在一个组件中跳转到根导航中"></a>在一个组件中跳转到根导航中</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; App, ViewController &#125; <span class="keyword">from</span> <span class="string">'ionic-angular'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;ion-content&gt;</span></span><br><span class="line"><span class="string">      &lt;h1&gt;My PopoverPage&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;button ion-button (click)="pushPage()"&gt;Call pushPage&lt;/button&gt;</span></span><br><span class="line"><span class="string">     &lt;/ion-content&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">class</span> PopoverPage &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">      <span class="keyword">public</span> viewCtrl: ViewController</span></span><br><span class="line"><span class="params">      <span class="keyword">public</span> appCtrl: App</span></span><br><span class="line"><span class="params">    </span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    pushPage() &#123;</span><br><span class="line">      <span class="keyword">this</span>.viewCtrl.dismiss();</span><br><span class="line">      <span class="keyword">this</span>.appCtrl.getRootNav().push(SecondPage);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="在主组件中跳转到一个根导航"><a href="#在主组件中跳转到一个根导航" class="headerlink" title="在主组件中跳转到一个根导航"></a>在主组件中跳转到一个根导航</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, ViewChild &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NavController &#125; <span class="keyword">from</span> <span class="string">'ionic-angular'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">   template: <span class="string">'&lt;ion-nav #myNav [root]="rootPage"&gt;&lt;/ion-nav&gt;'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> MyApp &#123;</span><br><span class="line">   <span class="meta">@ViewChild</span>(<span class="string">'myNav'</span>) nav: NavController</span><br><span class="line">   <span class="keyword">public</span> rootPage = TabsPage;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Wait for the components in MyApp's template to be initialized</span></span><br><span class="line">   <span class="comment">// In this case, we are waiting for the Nav with reference variable of "#myNav"</span></span><br><span class="line">   ngOnInit() &#123;</span><br><span class="line">      <span class="comment">// Let's navigate from TabsPage to Page1</span></span><br><span class="line">      <span class="keyword">this</span>.nav.push(Page1);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>end 2017-02-08 11:32:08<br>参考文档： <a href="http://ionicframework.com/docs/v2/api/navigation/NavController/" target="_blank" rel="noopener">http://ionicframework.com/docs/v2/api/navigation/NavController/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/08/2017-02-08/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/2017-02-08/" itemprop="url">Angular组件生命周期和钩子函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-08T10:28:36+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Angular组件生命周期和钩子函数"><a href="#Angular组件生命周期和钩子函数" class="headerlink" title="Angular组件生命周期和钩子函数"></a>Angular组件生命周期和钩子函数</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>angular2中每个组件都有其生命周期，包括创建组件、渲染组件、创建渲染子组件、绑定的属性发生变化时检查它、从dom中移除。<br>angular2提供了<strong>声明周期钩子函数</strong>，把这些关键的周期暴露给我们，以便我们做一些自定义的操作。</p>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-02-08-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-08%2010.49.03-1.png" alt="屏幕快照 2017-02-08 10.49.03"></p>
<h2 id="声明周期顺序解释"><a href="#声明周期顺序解释" class="headerlink" title="声明周期顺序解释"></a>声明周期顺序解释</h2><ul>
<li><code>ngOnChanges</code> 当angular绑定的输入属性发生变化时响应，首次调用一定会发生在ngOnInit之前</li>
<li><code>ngOnInit</code> 初始化指令/组件，在第一轮ngOnChanges完成之后调用，<strong>只调用一次</strong></li>
<li><code>ngDoCheck</code>在每个angular变更检测周期中调用，在ngOnChanges和ngOnInit之后调用</li>
<li><code>ngAfterContentInit</code> 把内容渲染到组件之后调用，第一次ngDoCheck之后调用，只适用于组件，<strong>只调用一次</strong></li>
<li><code>ngAfterContentChecked</code> 每次完成内容到组件的渲染的变更检测后调用，ngAfterContentInit和每次NgDoCheck之后调用，只适用于组件</li>
<li><code>ngAfterViewInit</code> 组件视图及其子视图初始化完成之后调用，第一次ngAfterContentChecked之后调用，<strong>只调用一次</strong>，只适合组件</li>
<li><code>ngAfterViewChecked</code> 每次做完组件视图和子视图的变更检测之后调用，ngAfterViewInit和每次ngAfterContentChecked之后调用，<br>只适合组件</li>
<li><code>ngOnDestroy</code> 在Angular销毁指令/组件之前调用。</li>
</ul>
<h2 id="钩子函数执行顺序的例子"><a href="#钩子函数执行顺序的例子" class="headerlink" title="钩子函数执行顺序的例子"></a>钩子函数执行顺序的例子</h2><p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-02-08-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-08%2011.17.24.png" alt="屏幕快照 2017-02-08 11.17.24"></p>
<blockquote>
<p>当输入属性发生变化时，就会看到<code>OnChanges</code>和至少两组<code>DoCheck</code>、<code>AfterContentChecked</code>和<code>AfterViewChecked</code>钩子执行。这四个钩子会执行很多次，应该让它们的逻辑尽可能精简，否则可能会影响用户体验。</p>
</blockquote>
<h2 id="再详细解释几个钩子函数"><a href="#再详细解释几个钩子函数" class="headerlink" title="再详细解释几个钩子函数"></a>再详细解释几个钩子函数</h2><h3 id="ngOnInit"><a href="#ngOnInit" class="headerlink" title="ngOnInit"></a>ngOnInit</h3><ul>
<li>ngOnInit是组件获取初始数据的好地方</li>
<li>在构造函数中只执行简单的局部变量初始化工作，其他什么都不要做</li>
<li>在component中，构造函数完成之前，那些绑定的输入属性还都没有值；在<code>ngOnInit</code>执行的时候，这些属性都已经被正确赋值过了</li>
</ul>
<blockquote>
<p>我们访问这些属性的第一次机会，实际上是ngOnChanges方法，Angular会在ngOnInit之前调用它。 但是在那之后，Angular还会调用ngOnChanges很多次。而ngOnInit只会被调用一次</p>
</blockquote>
<h3 id="ngDoCheck"><a href="#ngDoCheck" class="headerlink" title="ngDoCheck"></a>ngDoCheck</h3><ul>
<li>使用DoCheck钩子来检测那些Angular自身无法捕获的变更并采取行动</li>
<li>这个钩子被调用的十分频繁，应该使其实现尽可能的精简</li>
</ul>
<h3 id="AfterView"><a href="#AfterView" class="headerlink" title="AfterView"></a>AfterView</h3><p><code>AfterViewInit</code>和<code>AfterViewChecked</code>钩子，Angular会在每次创建了组件的子视图后调用它们。</p>
<h2 id="最后说明"><a href="#最后说明" class="headerlink" title="最后说明"></a>最后说明</h2><p>这是angular2组件自带的生命周期钩子函数，每个基于angular2的框架还可能会有自己的钩子函数，用以方便程序的编程。比如ionic2框架的view就有自己的生命周期钩子函数。</p>
<hr>
<p>end 2017-02-08 11:32:00</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/22/2017-01-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/22/2017-01-22/" itemprop="url">git tag 标签使用说明</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-22T15:37:22+08:00">
                2017-01-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="git-tag-标签使用说明"><a href="#git-tag-标签使用说明" class="headerlink" title="git tag 标签使用说明"></a>git tag 标签使用说明</h1><p><code>git tag</code>命令可以对某一时间点做标记，常用于版本发布。</p>
<h2 id="查看标签"><a href="#查看标签" class="headerlink" title="查看标签"></a>查看标签</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag           <span class="comment"># 查看所有标签</span></span><br><span class="line">$ git tag -l <span class="string">'v1.'</span>  <span class="comment"># 搜索符合模式的标签</span></span><br><span class="line">$ git show v1.0     <span class="comment"># 查看某个标签详情</span></span><br></pre></td></tr></table></figure>
<h2 id="添加标签"><a href="#添加标签" class="headerlink" title="添加标签"></a>添加标签</h2><h3 id="附注标签（推荐）"><a href="#附注标签（推荐）" class="headerlink" title="附注标签（推荐）"></a>附注标签（推荐）</h3><p>附注标签则是仓库中的一个独立对象,建议使用附注标签:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag -a v1.1 -m <span class="string">"1.1版本"</span></span><br></pre></td></tr></table></figure>
<p>参数a即annotated的缩写，指定标签类型，后面是标签名，参数m指定标签说明，说明信息会保存在标签对象中</p>
<h3 id="轻量级标签"><a href="#轻量级标签" class="headerlink" title="轻量级标签"></a>轻量级标签</h3><p>轻量标签是指向提交对象的引用:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag v0.1 -light</span><br></pre></td></tr></table></figure>
<h3 id="为某次commit打标签"><a href="#为某次commit打标签" class="headerlink" title="为某次commit打标签"></a>为某次commit打标签</h3><p>上面的命令默认将标签打在head上，如果需要我们也可以为之前的提交版本打标签：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --oneline        <span class="comment"># 显示版本提交历史</span></span><br><span class="line">$ git tag -a v0.1 c8cbe39  <span class="comment"># 为c8cbe39添加标签</span></span><br></pre></td></tr></table></figure>
<h2 id="切换标签"><a href="#切换标签" class="headerlink" title="切换标签"></a>切换标签</h2><p>与切换分支命令相同：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag                 <span class="comment"># 显示当前分支下的标签</span></span><br><span class="line">$ git checkout [tagname]  <span class="comment"># 此时指向标签指向的代码状态（此时处于空分支）</span></span><br><span class="line">$ cat a.txt               <span class="comment"># 查看某个文件</span></span><br><span class="line">$ git checkout master     <span class="comment"># 切换回master</span></span><br></pre></td></tr></table></figure>
<h2 id="删除标签"><a href="#删除标签" class="headerlink" title="删除标签"></a>删除标签</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag -d v0.1 <span class="comment"># 删除标签v0.1</span></span><br></pre></td></tr></table></figure>
<p>注意：误打或需要修改标签时，需要先将标签删除，再打新标签。</p>
<h2 id="标签发布"><a href="#标签发布" class="headerlink" title="标签发布"></a>标签发布</h2><p><code>git push</code>不会将标签信息提交到远程服务器，需要显示更新标签：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git push origin v0.1   <span class="comment">#将v0.1标签提交到git服务器</span></span><br><span class="line">$ git push origin –tags  <span class="comment">#将本地所有标签一次性提交到git服务器</span></span><br></pre></td></tr></table></figure>
<hr>
<p>end 2017-01-22 15:38:33</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/19/2017-01-19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan Hunt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="易天行">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/19/2017-01-19/" itemprop="url">为本地git仓库新增github远程仓库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-19T17:54:05+08:00">
                2017-01-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="为本地git仓库新增github远程仓库"><a href="#为本地git仓库新增github远程仓库" class="headerlink" title="为本地git仓库新增github远程仓库"></a>为本地git仓库新增github远程仓库</h1><p>人已新建过几个github仓库，但每次用的方法不一样，这里整理一个简单的方法流程，供以后参考。</p>
<ol>
<li>登录github，新建一个空repository</li>
<li><p>为本地项目添加远程地址</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git remote add origin git@github.com:hao5743/gittest.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>推送到远程</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure>
<p> 第一次推送的时候，需要加上<code>-u</code>参数，Git不但会把本地的<code>master</code>分支内容推送的远程新的<code>master</code>分支，还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来，以后就可以简化命令</p>
<p> 之后使用<code>git push</code>,<code>git pull</code>命令就行了</p>
</li>
</ol>
<hr>
<p>end. 2017-01-19 17:55:57</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/tx.jpeg"
                alt="Ethan Hunt" />
            
              <p class="site-author-name" itemprop="name">Ethan Hunt</p>
              <p class="site-description motion-element" itemprop="description">Make more time</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ethan Hunt</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
