<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="一阴一阳谓之道">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="一阴一阳谓之道">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一阴一阳谓之道">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>一阴一阳谓之道</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一阴一阳谓之道</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">合抱之木，生于毫末；九层之台，起于累土；千里之行，始于足下。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/08/ionic2页面page的生命周期钩子函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/ionic2页面page的生命周期钩子函数/" itemprop="url">ionic2页面page的生命周期钩子函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-08T11:45:54+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ionic2页面page的生命周期钩子函数"><a href="#ionic2页面page的生命周期钩子函数" class="headerlink" title="ionic2页面page的生命周期钩子函数"></a>ionic2页面page的生命周期钩子函数</h1><ul>
<li><p>Page Event    Returns    Description</p>
</li>
<li><p><code>ionViewDidLoad</code>    void    Runs when the page has loaded. This event only happens once per page being created. If a page leaves but is cached, then this event will not fire again on a subsequent viewing. The ionViewDidLoad event is good place to put your setup code for the page.</p>
</li>
<li><code>ionViewWillEnter</code>    void    Runs when the page is about to enter and become the active      page.</li>
<li><code>ionViewDidEnter</code>    void    Runs when the page has fully entered and is now the active page. This event will fire, whether it was the first load or a cached page.</li>
<li><code>ionViewWillLeave</code>    void    Runs when the page is about to leave and no longer be the active page.</li>
<li><code>ionViewDidLeave</code>    void    Runs when the page has finished leaving and is no longer the active page.</li>
<li><code>ionViewWillUnload</code>    void    Runs when the page is about to be destroyed and have its elements removed.</li>
<li><code>ionViewCanEnter</code>    boolean/Promise<void>    Runs before the view can enter. This can be used as a sort of “guard” in authenticated views where you need to check permissions before the view can enter</void></li>
<li><code>ionViewCanLeave</code>    boolean/Promise<void>    Runs before the view can leave. This can be used as a sort of “guard” in authenticated views where you need to check permissions before the view can leave</void></li>
</ul>
<hr>
<p>end 2017-02-08 11:44:47</p>
<p>参考文档：<a href="http://ionicframework.com/docs/v2/api/navigation/NavController/" target="_blank" rel="noopener">http://ionicframework.com/docs/v2/api/navigation/NavController/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/08/2017-02-08-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/2017-02-08-1/" itemprop="url">ionic2使用根导航（rootNav）跳转</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-08T11:32:13+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ionic2使用根导航（rootNav）跳转"><a href="#ionic2使用根导航（rootNav）跳转" class="headerlink" title="ionic2使用根导航（rootNav）跳转"></a>ionic2使用根导航（rootNav）跳转</h1><p>在一个使用tab构建的ionic2应用程序中，如果我们直接使用<code>NavController</code>进行导航跳转，会将新的page压入当前tab的导航栈中。但login、signin、setting等page在业务上不应该属于当前tab，而应该从根组件进行导航，那么此时该如何做呢？<br>看下面的例子即可：</p>
<h2 id="在一个组件中跳转到根导航中"><a href="#在一个组件中跳转到根导航中" class="headerlink" title="在一个组件中跳转到根导航中"></a>在一个组件中跳转到根导航中</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; App, ViewController &#125; <span class="keyword">from</span> <span class="string">'ionic-angular'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;ion-content&gt;</span></span><br><span class="line"><span class="string">      &lt;h1&gt;My PopoverPage&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;button ion-button (click)="pushPage()"&gt;Call pushPage&lt;/button&gt;</span></span><br><span class="line"><span class="string">     &lt;/ion-content&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">class</span> PopoverPage &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">      <span class="keyword">public</span> viewCtrl: ViewController</span></span><br><span class="line"><span class="params">      <span class="keyword">public</span> appCtrl: App</span></span><br><span class="line"><span class="params">    </span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    pushPage() &#123;</span><br><span class="line">      <span class="keyword">this</span>.viewCtrl.dismiss();</span><br><span class="line">      <span class="keyword">this</span>.appCtrl.getRootNav().push(SecondPage);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="在主组件中跳转到一个根导航"><a href="#在主组件中跳转到一个根导航" class="headerlink" title="在主组件中跳转到一个根导航"></a>在主组件中跳转到一个根导航</h2><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, ViewChild &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NavController &#125; <span class="keyword">from</span> <span class="string">'ionic-angular'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">   template: <span class="string">'&lt;ion-nav #myNav [root]="rootPage"&gt;&lt;/ion-nav&gt;'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> MyApp &#123;</span><br><span class="line">   <span class="meta">@ViewChild</span>(<span class="string">'myNav'</span>) nav: NavController</span><br><span class="line">   <span class="keyword">public</span> rootPage = TabsPage;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Wait for the components in MyApp's template to be initialized</span></span><br><span class="line">   <span class="comment">// In this case, we are waiting for the Nav with reference variable of "#myNav"</span></span><br><span class="line">   ngOnInit() &#123;</span><br><span class="line">      <span class="comment">// Let's navigate from TabsPage to Page1</span></span><br><span class="line">      <span class="keyword">this</span>.nav.push(Page1);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>end 2017-02-08 11:32:08<br>参考文档： <a href="http://ionicframework.com/docs/v2/api/navigation/NavController/" target="_blank" rel="noopener">http://ionicframework.com/docs/v2/api/navigation/NavController/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/08/2017-02-08/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/2017-02-08/" itemprop="url">Angular组件生命周期和钩子函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-08T10:28:36+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Angular组件生命周期和钩子函数"><a href="#Angular组件生命周期和钩子函数" class="headerlink" title="Angular组件生命周期和钩子函数"></a>Angular组件生命周期和钩子函数</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>angular2中每个组件都有其生命周期，包括创建组件、渲染组件、创建渲染子组件、绑定的属性发生变化时检查它、从dom中移除。<br>angular2提供了<strong>声明周期钩子函数</strong>，把这些关键的周期暴露给我们，以便我们做一些自定义的操作。</p>
<p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-02-08-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-08%2010.49.03-1.png" alt="屏幕快照 2017-02-08 10.49.03"></p>
<h2 id="声明周期顺序解释"><a href="#声明周期顺序解释" class="headerlink" title="声明周期顺序解释"></a>声明周期顺序解释</h2><ul>
<li><code>ngOnChanges</code> 当angular绑定的输入属性发生变化时响应，首次调用一定会发生在ngOnInit之前</li>
<li><code>ngOnInit</code> 初始化指令/组件，在第一轮ngOnChanges完成之后调用，<strong>只调用一次</strong></li>
<li><code>ngDoCheck</code>在每个angular变更检测周期中调用，在ngOnChanges和ngOnInit之后调用</li>
<li><code>ngAfterContentInit</code> 把内容渲染到组件之后调用，第一次ngDoCheck之后调用，只适用于组件，<strong>只调用一次</strong></li>
<li><code>ngAfterContentChecked</code> 每次完成内容到组件的渲染的变更检测后调用，ngAfterContentInit和每次NgDoCheck之后调用，只适用于组件</li>
<li><code>ngAfterViewInit</code> 组件视图及其子视图初始化完成之后调用，第一次ngAfterContentChecked之后调用，<strong>只调用一次</strong>，只适合组件</li>
<li><code>ngAfterViewChecked</code> 每次做完组件视图和子视图的变更检测之后调用，ngAfterViewInit和每次ngAfterContentChecked之后调用，<br>只适合组件</li>
<li><code>ngOnDestroy</code> 在Angular销毁指令/组件之前调用。</li>
</ul>
<h2 id="钩子函数执行顺序的例子"><a href="#钩子函数执行顺序的例子" class="headerlink" title="钩子函数执行顺序的例子"></a>钩子函数执行顺序的例子</h2><p><img src="http://ol1ftyec4.bkt.clouddn.com/2017-02-08-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-08%2011.17.24.png" alt="屏幕快照 2017-02-08 11.17.24"></p>
<blockquote>
<p>当输入属性发生变化时，就会看到<code>OnChanges</code>和至少两组<code>DoCheck</code>、<code>AfterContentChecked</code>和<code>AfterViewChecked</code>钩子执行。这四个钩子会执行很多次，应该让它们的逻辑尽可能精简，否则可能会影响用户体验。</p>
</blockquote>
<h2 id="再详细解释几个钩子函数"><a href="#再详细解释几个钩子函数" class="headerlink" title="再详细解释几个钩子函数"></a>再详细解释几个钩子函数</h2><h3 id="ngOnInit"><a href="#ngOnInit" class="headerlink" title="ngOnInit"></a>ngOnInit</h3><ul>
<li>ngOnInit是组件获取初始数据的好地方</li>
<li>在构造函数中只执行简单的局部变量初始化工作，其他什么都不要做</li>
<li>在component中，构造函数完成之前，那些绑定的输入属性还都没有值；在<code>ngOnInit</code>执行的时候，这些属性都已经被正确赋值过了</li>
</ul>
<blockquote>
<p>我们访问这些属性的第一次机会，实际上是ngOnChanges方法，Angular会在ngOnInit之前调用它。 但是在那之后，Angular还会调用ngOnChanges很多次。而ngOnInit只会被调用一次</p>
</blockquote>
<h3 id="ngDoCheck"><a href="#ngDoCheck" class="headerlink" title="ngDoCheck"></a>ngDoCheck</h3><ul>
<li>使用DoCheck钩子来检测那些Angular自身无法捕获的变更并采取行动</li>
<li>这个钩子被调用的十分频繁，应该使其实现尽可能的精简</li>
</ul>
<h3 id="AfterView"><a href="#AfterView" class="headerlink" title="AfterView"></a>AfterView</h3><p><code>AfterViewInit</code>和<code>AfterViewChecked</code>钩子，Angular会在每次创建了组件的子视图后调用它们。</p>
<h2 id="最后说明"><a href="#最后说明" class="headerlink" title="最后说明"></a>最后说明</h2><p>这是angular2组件自带的生命周期钩子函数，每个基于angular2的框架还可能会有自己的钩子函数，用以方便程序的编程。比如ionic2框架的view就有自己的生命周期钩子函数。</p>
<hr>
<p>end 2017-02-08 11:32:00</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/22/2017-01-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/22/2017-01-22/" itemprop="url">git tag 标签使用说明</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-22T15:37:22+08:00">
                2017-01-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="git-tag-标签使用说明"><a href="#git-tag-标签使用说明" class="headerlink" title="git tag 标签使用说明"></a>git tag 标签使用说明</h1><p><code>git tag</code>命令可以对某一时间点做标记，常用于版本发布。</p>
<h2 id="查看标签"><a href="#查看标签" class="headerlink" title="查看标签"></a>查看标签</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag           <span class="comment"># 查看所有标签</span></span><br><span class="line">$ git tag -l <span class="string">'v1.'</span>  <span class="comment"># 搜索符合模式的标签</span></span><br><span class="line">$ git show v1.0     <span class="comment"># 查看某个标签详情</span></span><br></pre></td></tr></table></figure>
<h2 id="添加标签"><a href="#添加标签" class="headerlink" title="添加标签"></a>添加标签</h2><h3 id="附注标签（推荐）"><a href="#附注标签（推荐）" class="headerlink" title="附注标签（推荐）"></a>附注标签（推荐）</h3><p>附注标签则是仓库中的一个独立对象,建议使用附注标签:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag -a v1.1 -m <span class="string">"1.1版本"</span></span><br></pre></td></tr></table></figure>
<p>参数a即annotated的缩写，指定标签类型，后面是标签名，参数m指定标签说明，说明信息会保存在标签对象中</p>
<h3 id="轻量级标签"><a href="#轻量级标签" class="headerlink" title="轻量级标签"></a>轻量级标签</h3><p>轻量标签是指向提交对象的引用:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag v0.1 -light</span><br></pre></td></tr></table></figure>
<h3 id="为某次commit打标签"><a href="#为某次commit打标签" class="headerlink" title="为某次commit打标签"></a>为某次commit打标签</h3><p>上面的命令默认将标签打在head上，如果需要我们也可以为之前的提交版本打标签：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --oneline        <span class="comment"># 显示版本提交历史</span></span><br><span class="line">$ git tag -a v0.1 c8cbe39  <span class="comment"># 为c8cbe39添加标签</span></span><br></pre></td></tr></table></figure>
<h2 id="切换标签"><a href="#切换标签" class="headerlink" title="切换标签"></a>切换标签</h2><p>与切换分支命令相同：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag                 <span class="comment"># 显示当前分支下的标签</span></span><br><span class="line">$ git checkout [tagname]  <span class="comment"># 此时指向标签指向的代码状态（此时处于空分支）</span></span><br><span class="line">$ cat a.txt               <span class="comment"># 查看某个文件</span></span><br><span class="line">$ git checkout master     <span class="comment"># 切换回master</span></span><br></pre></td></tr></table></figure>
<h2 id="删除标签"><a href="#删除标签" class="headerlink" title="删除标签"></a>删除标签</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git tag -d v0.1 <span class="comment"># 删除标签v0.1</span></span><br></pre></td></tr></table></figure>
<p>注意：误打或需要修改标签时，需要先将标签删除，再打新标签。</p>
<h2 id="标签发布"><a href="#标签发布" class="headerlink" title="标签发布"></a>标签发布</h2><p><code>git push</code>不会将标签信息提交到远程服务器，需要显示更新标签：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git push origin v0.1   <span class="comment">#将v0.1标签提交到git服务器</span></span><br><span class="line">$ git push origin –tags  <span class="comment">#将本地所有标签一次性提交到git服务器</span></span><br></pre></td></tr></table></figure>
<hr>
<p>end 2017-01-22 15:38:33</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/19/2017-01-19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/19/2017-01-19/" itemprop="url">为本地git仓库新增github远程仓库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-19T17:54:05+08:00">
                2017-01-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="为本地git仓库新增github远程仓库"><a href="#为本地git仓库新增github远程仓库" class="headerlink" title="为本地git仓库新增github远程仓库"></a>为本地git仓库新增github远程仓库</h1><p>人已新建过几个github仓库，但每次用的方法不一样，这里整理一个简单的方法流程，供以后参考。</p>
<ol>
<li>登录github，新建一个空repository</li>
<li><p>为本地项目添加远程地址</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git remote add origin git@github.com:hao5743/gittest.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>推送到远程</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure>
<p> 第一次推送的时候，需要加上<code>-u</code>参数，Git不但会把本地的<code>master</code>分支内容推送的远程新的<code>master</code>分支，还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来，以后就可以简化命令</p>
<p> 之后使用<code>git push</code>,<code>git pull</code>命令就行了</p>
</li>
</ol>
<hr>
<p>end. 2017-01-19 17:55:57</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/30/关于gitosis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/30/关于gitosis/" itemprop="url">关于gitosis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-30T10:29:00+08:00">
                2016-12-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关于gitosis"><a href="#关于gitosis" class="headerlink" title="关于gitosis"></a>关于gitosis</h1><p>在工作中，我们有自己的git服务器，但是随着git项目的增多和项目成员的增多，我们开始使用了<code>Gitosis</code>软件。使用它可以方便的管理与git相关的如成员公钥、权限、项目成员等问题，这里我只对我项目中用到一些简单配置做了整理和记录，并非全面的介绍gitosis。这里提供一份更为详尽介绍的<a href="https://git-scm.com/book/zh/v1/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84-Git-Gitosis" target="_blank" rel="noopener">文档</a>。</p>
<p>Git是非常著名的分布式版本控制系统。</p>
<p><strong>Gitosis则是方便通过Git与ssh架设中央服务器的软件。</strong></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>已经配置安装好，故没有从头介绍，如需要看这个<a href="https://git-scm.com/book/zh/v1/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84-Git-Gitosis" target="_blank" rel="noopener">安装步骤</a></p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>gitosis安装好之后的几个目录说明：</p>
<p><code>/home/git</code>目录: gitosis默认把这里作为存储所有 Git 仓库的根目录</p>
<p><code>/home/git/repositories</code>目录: 这里是存放需要管理的git项目（无需直接操作这个目录，要用gitosis来管理） </p>
<h3 id="管理"><a href="#管理" class="headerlink" title="管理"></a>管理</h3><p>远程克隆gitosis到本地，方便管理</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在你的本地计算机上</span></span><br><span class="line">git@gitserver:gitosis-admin.git</span><br></pre></td></tr></table></figure>
<p>如果你无法克隆，说明你没有权限，也就是<code>gitosis.conf</code>中<code>[group gitosis-admin]</code>没有存储你的公钥。你需要联系管理员给你管理权限。</p>
<h3 id="创建者或管理员新增一个管理员权限"><a href="#创建者或管理员新增一个管理员权限" class="headerlink" title="创建者或管理员新增一个管理员权限"></a>创建者或管理员新增一个管理员权限</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在创建者或管理员的机器上（如有略过）</span></span><br><span class="line">$ git <span class="built_in">clone</span> git@gitserver:gitosis-admin.git</span><br><span class="line">$ <span class="built_in">cd</span> gitosis-admin.git</span><br><span class="line"><span class="comment"># 被添加者上传自己公钥（如有略过）</span></span><br><span class="line">$ scp ~/.ssh/id_rsa.pub 用户名@主机:/tmp</span><br><span class="line"><span class="comment"># 管理员拷贝公钥到keydir,并重命名（如有略过）</span></span><br><span class="line">$ cp /tmp/id_rsa.pub keydir/tom.pub</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始配置</span></span><br><span class="line"><span class="comment"># 编辑gitosis.conf,在[group gitosis-admin]下members中添加成员tom</span></span><br><span class="line">$ vim gitosis.conf</span><br><span class="line"><span class="comment"># ...编辑操作...wq...</span></span><br><span class="line"><span class="comment"># [group gitosis-admin]</span></span><br><span class="line"><span class="comment"># members = admin tom</span></span><br><span class="line"><span class="comment"># writable = gitosis-admin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交更改（有可能需要先git add）</span></span><br><span class="line">$ git commit</span><br><span class="line">$ git push</span><br><span class="line"></span><br><span class="line"><span class="comment"># OK！tom用户现在已经有gitosis的管理权限了，</span></span><br><span class="line"><span class="comment"># 它可以克隆gitosis-admin.git它的个人电脑上，并执行管理操作</span></span><br></pre></td></tr></table></figure>
<p>目录说明：</p>
<p><code>gitosis.conf</code>文件: 此处用于项目配置，包括gitosis管理员、git项目读写权限</p>
<p><code>keydir</code>目录: 此处存放着相关用户的公钥</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/29/git status可能展示的几种情况/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/29/git status可能展示的几种情况/" itemprop="url">git status可能的情况</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-29T17:29:54+08:00">
                2016-12-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="git-status可能的情况"><a href="#git-status可能的情况" class="headerlink" title="git status可能的情况"></a>git status可能的情况</h1><p>工作中我们使用git作为版本管理工具，它的确是一个强大的工具。易于学习和使用，但是要学习的面面俱到也很难，就<code>git status</code>就可能会出现n多种的情况。本文记录了<code>git status</code>可能出现的不同状态信息、状态说明、处理办法。注意，列举的情况并不全面，只是列举了工作中遇到的一些常见情况，同时遇到新状态，还会随时增加。</p>
<p><strong>git仓库中文件的状态</strong><br>git仓库中所有文件可分为两种状态<strong>已跟踪</strong>和<strong>未跟踪</strong>。已跟踪的文件被git纳入了版本控制，git会记录它的每次更新状态。<br>状态生命周期有四种：untracked, unmodified, modified, staged</p>
<p><strong>git status可能的情况：</strong></p>
<h2 id="1-Your-branch-is-ahead-of-‘origin-master’-by-1-commit"><a href="#1-Your-branch-is-ahead-of-‘origin-master’-by-1-commit" class="headerlink" title="1. Your branch is ahead of ‘origin/master’ by 1 commit."></a>1. Your branch is ahead of ‘origin/master’ by 1 commit.</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is ahead of &apos;origin/master&apos; by 1 commit.</span><br><span class="line">  (use &quot;git push&quot; to publish your local commits)</span><br><span class="line">nothing to commit, working directory clean</span><br><span class="line">cochona@cochona:~/gitosis-admin/keydir$</span><br></pre></td></tr></table></figure>
<p>此时说明当前目录中所有的已跟踪文件，都已经和远程保持同步，并且没有修改。刚从远程克隆的git仓库，都是这个状态。</p>
<h2 id="2-nothing-added-to-commit-but-untracked-files-present"><a href="#2-nothing-added-to-commit-but-untracked-files-present" class="headerlink" title="2. nothing added to commit but untracked files present"></a>2. nothing added to commit but untracked files present</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Initial commit</span><br><span class="line">Untracked files:</span><br><span class="line">	(use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">a.text</span><br><span class="line">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</span><br></pre></td></tr></table></figure>
<p>表示此时目录下，有新添加的未被跟踪的文件，如果我们需要将此文件提交到仓库，可以执行git add</p>
<h2 id="3-Changes-to-be-committed-new-file"><a href="#3-Changes-to-be-committed-new-file" class="headerlink" title="3. Changes to be committed: new file"></a>3. Changes to be committed: new file</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">	(use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line">   new file:   README</span><br></pre></td></tr></table></figure>
<p>在“Changes to be committed”这行下面的都是已暂存的状态，此时可以执行git commit</p>
<h2 id="4-Changes-to-be-committed-modified"><a href="#4-Changes-to-be-committed-modified" class="headerlink" title="4. Changes to be committed: modified"></a>4. Changes to be committed: modified</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cochona@cochona:~/gitosis-admin$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up-to-date with &apos;origin/master&apos;.</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line">	</span><br><span class="line">	modified:   gitosis.conf</span><br></pre></td></tr></table></figure>
<p>有修改的文件，此时可以选择直接<code>git commit -m &quot;info&quot;</code>    </p>
<h2 id="5-Changes-not-staged-for-commit-modified"><a href="#5-Changes-not-staged-for-commit-modified" class="headerlink" title="5. Changes not staged for commit: modified"></a>5. Changes not staged for commit: modified</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cochona@cochona:~/gitosis-admin$ git commit -m &quot;add shaoc@pub to admin-group&quot;</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up-to-date with &apos;origin/master&apos;.</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">	modified:   gitosis.conf</span><br><span class="line">	</span><br><span class="line">no changes added to commit</span><br></pre></td></tr></table></figure>
<p>此时如果要保存修改，需要先<code>git add gitosis.conf</code>，然后<code>git commit -m &quot;&quot;</code>,然后<code>git push</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/29/ionic state命令不应该再使用了/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/29/ionic state命令不应该再使用了/" itemprop="url">ionic state命令将要废弃</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-29T11:29:00+08:00">
                2016-12-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ionic-state命令将要废弃"><a href="#ionic-state命令将要废弃" class="headerlink" title="ionic state命令将要废弃"></a>ionic state命令将要废弃</h1><p>参考自官方网站</p>
<p><a href="https://github.com/driftyco/ionic-cli/issues/904" target="_blank" rel="noopener">Discuss: Deprecate/Remove state command #904</a></p>
<p><a href="https://cordova.apache.org/docs/en/latest/platform_plugin_versioning_ref/index.html" target="_blank" rel="noopener">cordova说明</a></p>
<blockquote>
<p>The state command was created to manage Cordova plugins before it was supported in Cordova. Cordova now manages plugins and platforms in config.xml: <a href="https://cordova.apache.org/docs/en/latest/platform_plugin_versioning_ref/index.html" target="_blank" rel="noopener">https://cordova.apache.org/docs/en/latest/platform_plugin_versioning_ref/index.html</a> so there is a decent amount of confusion between the Ionic and Cordova behavior. As Cordova platforms and plugins are not an Ionic concern, let’s deprecate the state command and document the existing Cordova command workflow, ie plugin add –save.</p>
</blockquote>
<p>state命令是之前用来管理cordova插件的。现在Cordova自身已经开始通过<code>config.xml</code>来支持插件和平台管理（<a href="https://cordova.apache.org/docs/en/latest/platform_plugin_versioning_ref/index.html" target="_blank" rel="noopener">官方说明</a>），这会让我们对ionic和cordova的不同的管理方式感到困惑。因为cordova的平台和插件是ionic所不关心的，所以建议停止使用<code>state</code>命令，而使用cordova的管理方式，比如<code>plugin add --save</code></p>
<h2 id="对于插件我们应该这样管理"><a href="#对于插件我们应该这样管理" class="headerlink" title="对于插件我们应该这样管理"></a>对于插件我们应该这样管理</h2><p>重装所有插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf plugins</span><br><span class="line"><span class="comment"># 更新插件,执行时会自动安装在config.xml中的插件</span></span><br><span class="line">cordova prepare</span><br></pre></td></tr></table></figure>
<p>从工程中彻底删除一个插件，–save命令会将删除或更改影响到<code>config.xml</code>,与<code>package.json</code>无关</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cordova plugin reomve ionic-plugin-keyboard --save</span><br><span class="line">cordova plugin add ionic-plugin-keyboard --save</span><br></pre></td></tr></table></figure>
<p>platform add的时候会自动检测<code>config.xml</code>，并安装记录的插件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cordova platform add android</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/28/研究了oh-my-zsh中环境变量的配置办法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/28/研究了oh-my-zsh中环境变量的配置办法/" itemprop="url">Mac配置oh-my-zsh</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-28T00:00:00+08:00">
                2016-12-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mac配置oh-my-zsh"><a href="#Mac配置oh-my-zsh" class="headerlink" title="Mac配置oh-my-zsh"></a>Mac配置oh-my-zsh</h1><h2 id="mac环境变量保存的地方"><a href="#mac环境变量保存的地方" class="headerlink" title="mac环境变量保存的地方"></a>mac环境变量保存的地方</h2><p>没有zsh的时候，mac中的环境变量保存在:</p>
<h4 id="1-etc-profile-（建议不修改这个文件-）"><a href="#1-etc-profile-（建议不修改这个文件-）" class="headerlink" title="1./etc/profile   （建议不修改这个文件 ）"></a>1./etc/profile   （建议不修改这个文件 ）</h4><p> 全局（公有）配置，不管是哪个用户，登录时都会读取该文件。</p>
<h4 id="2-etc-bashrc-（一般在这个文件中添加系统级环境变量）"><a href="#2-etc-bashrc-（一般在这个文件中添加系统级环境变量）" class="headerlink" title="2./etc/bashrc    （一般在这个文件中添加系统级环境变量）"></a>2./etc/bashrc    （一般在这个文件中添加系统级环境变量）</h4><p> 全局（公有）配置，bash shell执行时，不管是何种方式，都会读取此文件。</p>
<h4 id="3-bash-profile-（一般在这个文件中添加用户级环境变量）"><a href="#3-bash-profile-（一般在这个文件中添加用户级环境变量）" class="headerlink" title="3.~/.bash_profile  （一般在这个文件中添加用户级环境变量）"></a>3.~/.bash_profile  （一般在这个文件中添加用户级环境变量）</h4><p> 每个用户都可使用该文件输入专用于自己使用的shell信息,当用户登录时,该文件仅仅执行</p>
<p>如果要修改环境变量，一般修改<code>~/.bash_profile</code>就行了。</p>
<h2 id="查看环境变量"><a href="#查看环境变量" class="headerlink" title="查看环境变量"></a>查看环境变量</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ printenv</span><br></pre></td></tr></table></figure>
<p>查看当前使用的shell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ echo $SHELL</span><br><span class="line">    /bin/zsh</span><br></pre></td></tr></table></figure>
<h2 id="zsh安装后"><a href="#zsh安装后" class="headerlink" title="zsh安装后"></a>zsh安装后</h2><p>安装zsh后，默认情况下就不会自动读取<code>~/.bash_profile</code>了。<br>在用户目录下应该有<code>.oh-my-zsh</code>目录，和<code>.zshrc</code>配置文件</p>
<ol>
<li><p><code>.oh-my-zsh</code>目录： 它是zsh的安装文件夹，可以自己更改</p>
</li>
<li><p><code>.zshrc</code>: 里面是zsh默认配置，可以用于设置环境变量（export），alias命令别名，设置主题等</p>
<blockquote>
<p>但是zsh不建议直接操作这个默认配置，如果用户需要自定义配置，推荐去这里<code>./oh-my-zsh/custom/custom.zsh</code>修改。注意：<code>custom</code>文件夹里的所有配置都会被zsh自动读取并配置。</p>
</blockquote>
</li>
<li><p><code>./oh-my-zsh/custom/my_custom.zsh</code>:用户设置自定义系统变量、自定义命令等等</p>
<p> 一般情况下，我们在<code>./oh-my-zsh/custom/my_custom.zsh</code>中配置一个快捷键</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alias zshconfig=&quot;subl ~/.oh-my-zsh/custom/my_custom.zsh&quot;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="综上，如果要配置环境变量的步骤"><a href="#综上，如果要配置环境变量的步骤" class="headerlink" title="综上，如果要配置环境变量的步骤"></a>综上，如果要配置环境变量的步骤</h2><ol>
<li>执行<code>zshconfig</code>,会自动使用你定义的命令，打开配置文件</li>
<li>在该文件中添加你想要添加的环境变量，比如<code>export ANDROID_HOME=/Development/android-sdk/</code></li>
<li>重启cmd，生效！OK。配置完成</li>
</ol>
<h2 id="备份一个我自己的配置文件"><a href="#备份一个我自己的配置文件" class="headerlink" title="备份一个我自己的配置文件"></a>备份一个我自己的配置文件</h2><p><code>./oh-my-zsh/custom/my_custom.zsh</code>如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alias zshconfig=&quot;subl ~/.oh-my-zsh/custom/my_custom.zsh&quot;</span><br><span class="line">alias code=\&apos;&apos;/Applications/Visual Studio Code.app/Contents/Resources/app/bin/code&apos;\&apos;</span><br><span class="line">alias subl=&quot;&apos;/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl&apos;&quot;</span><br><span class="line">alias nano=&quot;subl&quot;</span><br><span class="line">alias sl=&quot;subl&quot;</span><br><span class="line">alias py=&quot;python&quot;</span><br><span class="line">alias nw=&quot;/Applications/nwjs.app/Contents/MacOS/nwjs&quot;</span><br><span class="line">export ANDROID_HOME=/Development/android-sdk/</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/26/vscode中beautifyrc插件配置文件翻译和设置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/26/vscode中beautifyrc插件配置文件翻译和设置/" itemprop="url">vscode中beautifyrc插件配置文件翻译和设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-26T23:08:09+08:00">
                2016-12-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="vscode中beautifyrc插件配置文件翻译和设置"><a href="#vscode中beautifyrc插件配置文件翻译和设置" class="headerlink" title="vscode中beautifyrc插件配置文件翻译和设置"></a>vscode中beautifyrc插件配置文件翻译和设置</h1><p>2016-12-26 23:08:09</p>
<p>在 VisualStudio Code 中有<code>beautify</code>插件，用来格式化代码，下面是研究它的一些配置说明，一些英文缩写还是很难一眼看懂的，下面记录下来。</p>
<p>顺便给出一个英文的设置说明：<a href="https://github.com/HookyQR/VSCodeBeautify/blob/master/Settings.md" target="_blank" rel="noopener">https://github.com/HookyQR/VSCodeBeautify/blob/master/Settings.md</a>.英文好的话，直接去看就行啦。</p>
<p>配置说明：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"indent_size"</span>: <span class="number">4</span>,      <span class="comment">//缩进大小，默认4</span></span><br><span class="line">    <span class="string">"indent_char"</span>: <span class="string">" "</span>,    <span class="comment">//缩进字符，默认" "</span></span><br><span class="line">    <span class="string">"eol"</span>: <span class="string">"\n"</span>,           <span class="comment">//end of line，行结尾字符"\n"</span></span><br><span class="line">    <span class="string">"indent_level"</span>: <span class="number">0</span>,     <span class="comment">//初始缩进级别</span></span><br><span class="line">    <span class="string">"indent_with_tabs"</span>: <span class="literal">false</span>, <span class="comment">//使用tab缩进，将会覆盖“indent_size”和“indent_char”设置，默认false</span></span><br><span class="line">    <span class="string">"preserve_newlines"</span>: <span class="literal">true</span>,       <span class="comment">//保留空行，默认“true”</span></span><br><span class="line">    <span class="string">"max_preserve_newlines"</span>: <span class="number">10</span>,     <span class="comment">//一次最多保留多少行的空行，默认10</span></span><br><span class="line">    <span class="string">"jslint_happy"</span>: <span class="literal">false</span>,           <span class="comment">//开启jslint-stricter的严格模式（强制开启“space_after_anon_function”选项）,默认false</span></span><br><span class="line">    <span class="string">"space_after_anon_function"</span>: <span class="literal">false</span>, <span class="comment">//在匿名函数前自动加一个空格，比如`function ()&#123;&#125;`，默认false</span></span><br><span class="line">    <span class="string">"brace_style"</span>: <span class="string">"collapse"</span>,          <span class="comment">//括号风格，"collapse-preserve-inline", "collapse", "expand", "end-expand", or "none" ,默认“collapse”</span></span><br><span class="line">    <span class="string">"keep_array_indentation"</span>: <span class="literal">false</span>,    <span class="comment">//保持数组缩进，默认false</span></span><br><span class="line">    <span class="string">"keep_function_indentation"</span>: <span class="literal">false</span>, <span class="comment">//保持函数缩进，默认false</span></span><br><span class="line">    <span class="string">"space_before_conditional"</span>: <span class="literal">true</span>,   <span class="comment">//在条件语句之前保留一个空格，默认true</span></span><br><span class="line">    <span class="string">"break_chained_methods"</span>: <span class="literal">false</span>,     <span class="comment">//中断多行间的链式方法调用，默认true</span></span><br><span class="line">    <span class="string">"eval_code"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">"unescape_strings"</span>: <span class="literal">false</span>,      <span class="comment">//解码用xNN编码的可打印字符，默认false</span></span><br><span class="line">    <span class="string">"wrap_line_length"</span>: <span class="number">0</span>,          <span class="comment">//Wrap lines at next opportunity after N characters. (Set zero to ignore wrapping),默认0,下次在n个字符后换行</span></span><br><span class="line">    <span class="string">"wrap_attributes"</span>: <span class="string">"auto"</span>,        <span class="comment">//将html属性标签放在新行“auto”,“force”,默认auto</span></span><br><span class="line">    <span class="string">"wrap_attributes_indent_size"</span>: <span class="number">4</span>, <span class="comment">//html属性标签新行缩进字符数，默认为"indent_size"4</span></span><br><span class="line">    <span class="string">"end_with_newline"</span>: <span class="literal">false</span>         <span class="comment">//在文件结尾保证有换行，默认false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>indentation 缩进</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/17/ReactNative环境安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/17/ReactNative环境安装/" itemprop="url">ReactNative环境安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-17T13:04:53+08:00">
                2016-12-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ReactNative环境安装"><a href="#ReactNative环境安装" class="headerlink" title="ReactNative环境安装"></a>ReactNative环境安装</h2><p>2016年12月17日13:04:16</p>
<p>在安装rn，初始化rn应用，以及npm install rn工程的时候，要尽量注意做到使用<code>npm</code>，不要使用<code>cnpm</code>代替，可能会出现未知的错误。</p>
<h3 id="1-安装node、配置镜像加速"><a href="#1-安装node、配置镜像加速" class="headerlink" title="1.安装node、配置镜像加速"></a>1.安装node、配置镜像加速</h3><p>node安装过程略。</p>
<p>建议一定要设置镜像来加速，不然速度会很慢：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org --global</span><br><span class="line">npm config <span class="built_in">set</span> disturl https://npm.taobao.org/dist --global</span><br></pre></td></tr></table></figure>
<h3 id="2-安装rn和yarn"><a href="#2-安装rn和yarn" class="headerlink" title="2.安装rn和yarn"></a>2.安装rn和yarn</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g yarn react-native-cli</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Yarn是Facebook提供的替代npm的工具，可以加速node模块的下载。React Native的命令行工具用于执行创建、初始化、更新项目、运行打包服务（packager）等任务。</p>
</blockquote>
<p>如果出现错误，考虑修改权限</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo chown -R `whoami` /usr/local</span><br></pre></td></tr></table></figure>
<h3 id="3-选择安装"><a href="#3-选择安装" class="headerlink" title="3.选择安装"></a>3.选择安装</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install watchman</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Watchman是由Facebook提供的监视文件系统变更的工具，安装此工具，packager可以快速捕捉文件的变化从而实现实时刷新，提高效率。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install flow</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Flow是一个静态的JS类型检查工具,它只是Facebook自家的代码规范。新手可以选择跳过。</p>
</blockquote>
<h3 id="4-新建测试项目"><a href="#4-新建测试项目" class="headerlink" title="4.新建测试项目"></a>4.新建测试项目</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">react-native init AwesomeProject</span><br><span class="line">cd AwesomeProject</span><br><span class="line">react-native run-ios</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/08/The-Advantages-of-Progressive-Web-Apps-in-the-Modern-Mobile-Environment/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/08/The-Advantages-of-Progressive-Web-Apps-in-the-Modern-Mobile-Environment/" itemprop="url">渐进式Web应用程序在现代移动环境中的优势</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-08T19:16:19+08:00">
                2016-12-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/翻译/" itemprop="url" rel="index">
                    <span itemprop="name">翻译</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>渐进式Web应用程序在现代移动环境中的优势<br>The Advantages of Progressive Web Apps in the Modern Mobile Environment</p>
<blockquote>
<p>文章翻译自：<a href="http://blog.ionic.io/the-advantages-of-pwas/" target="_blank" rel="noopener">http://blog.ionic.io/the-advantages-of-pwas/</a><br>2016/12/1，作者：<a href="http://twitter.com/@Justinwillis96" target="_blank" rel="noopener">Justin</a>，译者：shaochong</p>
</blockquote>
<p>我们一直在谈论Progressive Web Apps（下文简称PWA）- 它是用现代化的web API如<code>service workers</code>，<code>web manifest</code>和<code>web push</code>来构建的web应用程序，让人们在浏览器中就可以体验到和本地程序一样棒的使用体验。</p>
<blockquote>
<p>我来解释几个概念（译者注）<br><code>service workers</code>是啥玩意？你可以这么理解，它运行于你当前页面主线程外的另一个线程中，用来加速你的APP，以它独特的技术来建立高效的离线体验，拦截网络请求，并且会根据当前的网络是否可用、服务器的内容是否更新来采取合适的策略。他们还允许通知推送和后台同步API。更多请参见MDN <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API" target="_blank" rel="noopener">Service Workers</a>。<br><code>web manifest</code>又是啥玩意？它提供了一个文本文件的应用程序（如名称，作者，图标和描述）的信息，其目的是安装Web应用程序到设备的主屏幕，提供更快速、更丰富的用户体验。更多参见MDN <a href="https://developer.mozilla.org/en-US/docs/Web/Manifest" target="_blank" rel="noopener">Web App Manifest</a>。<br><code>web push</code>是什么鬼？Web Push API让web应用有了可以接受来自服务端推送来的消息的能力，无论web应用是否在前台运行，甚至是否加载完成。这让开发者可以实现异步通知和更新，及时的数据更新会让用户有更好的参与感。更多请参见<a href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API" target="_blank" rel="noopener">Push API</a></p>
</blockquote>
<h3 id="全新的移动环境"><a href="#全新的移动环境" class="headerlink" title="全新的移动环境"></a>全新的移动环境</h3><p>在我们谈论PWA的优势之前，有一件很重要的事情，那就是要搞清楚现在的移动环境和我们过去的开发环境有什么不同的地方。随着发展中国家越来越多的人能够通过他们的移动设备访问互联网，我们也要准备好为他们构建app，就像为在旧金山使用iphone7的人一样。<br>一，这些用户主要是通过2G或这3G来上网，它们网速很糟糕。<br>二，他们的设备通常有1-2G的RAM，慢速四核CPU，4GB的磁盘存储空间，运行android5.0或更高。<br>三，移动数据上网费用还是很昂贵的。到2016年，印度1GB移动数据平均成本为3.81美元，而最低工资为每小时31美分。这是一个很具有挑战性的应用场合，但是通过PWA我们仍然可以构建很棒、用户体验很好的应用程序。</p>
<h3 id="为什么PWAs在现代移动环境中有着无与伦比的优势"><a href="#为什么PWAs在现代移动环境中有着无与伦比的优势" class="headerlink" title="为什么PWAs在现代移动环境中有着无与伦比的优势"></a>为什么PWAs在现代移动环境中有着无与伦比的优势</h3><p>和本地原生应用相比，PWA有三个关键的特点，让它能够构建功能更完善、用户体验更好的应用程序。</p>
<ul>
<li>高效的使用磁盘空间</li>
<li>高效的使用网络</li>
<li>不需要一次性安装大型的安装包</li>
</ul>
<p>Service workers可以帮我们完成这三个工作。<br>举个例子来说，service workers 能够让我们动态的缓存资源到本地设备，所以即使是在慢速、糟糕的网络环境中，我们仍能够提供很好的使用体验。这里的关键点是动态缓存。这意味着在慢速糟糕的网络环境中，我们可以优先缓存那些对程序来说最重要的资源，而无需去下载一个大的APK文件。比如，对于一个电商app，你可能不希望将app中的每一个产品页都缓存到本地。我们仅仅需要将那些之前浏览过的产品页和app启动所必须的资源文件缓存到本地。<br>此外，由于是网站的工作方式，用户不必一次性的下载大的app文件。他们只需要下载他们所访问的PWA页面，并且通过使用service worker的动态缓存，我们可以选择仅缓存我们PWA应用的重要页面，因此这些页面只需要下载一次即可。我们可以通过Flipkart PWA来看看实际效果。在我的Nexus6上，他占用了大约351KB的存储空间。而在同一台设备上，Twitter的应用程序占用了69.36MB。如你所见，差距很大，在那些只有4G存储空间的设备上，差距将更加明显。</p>
<h3 id="Ionic对于PWA的计划"><a href="#Ionic对于PWA的计划" class="headerlink" title="Ionic对于PWA的计划"></a>Ionic对于PWA的计划</h3><p>目前在ionic中支持对PWA的开箱即用，而且在不久的将来我们将会使它的支持更加强大。我们现在默认提供一个service worker和web manifest，让你的ionic应用具有PWA应用的能力，比如离线缓存，浏览器提示添加到主屏幕等。<br>此外，由于ionic是使用纯web技术来构建的，所以它可以很好的在浏览器中工作。展望未来，我们已经致力于通过代码拆分（code splitting），树形目录（treeshaking）和属性重命名（property renaming）来使我们的捆绑包更小，这可以让你的ionic2应用运行的更快。我们知道，在移动网络上，加载时间是很重要的，相信通过这些改变，我们可以更好的满足这一点。<br>使用Progressive Web Apps和现代化网络的强大功能，即使在低端，便宜的设备上，我们也能提供出色的用户体验。 PWA为移动应用程序提供了全新的范例，这对新的移动环境至关重要。 下次当你有一个极好的构思和想法，而且想要把它构建为移动app的时候，考虑将其构建为一个PWA应用，这可以让你的app触及到下一个十亿级的用户群体。</p>
<blockquote>
<p>译者：shaochong</p>
<p>E-mail：hao5743@163.com</p>
<p>博客：<a href="http://hao5743.github.io/" target="_blank" rel="noopener">http://hao5743.github.io/</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/05/在angular1中自定义directive时数据显示不同步问题的分析和解决/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/05/在angular1中自定义directive时数据显示不同步问题的分析和解决/" itemprop="url">在angular1中自定义directive时数据显示不同步问题的分析和解决</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-05T16:33:38+08:00">
                2016-12-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Angular/" itemprop="url" rel="index">
                    <span itemprop="name">Angular</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在angular1中自定义directive时数据显示不同步问题的分析和解决"><a href="#在angular1中自定义directive时数据显示不同步问题的分析和解决" class="headerlink" title="在angular1中自定义directive时数据显示不同步问题的分析和解决"></a>在angular1中自定义directive时数据显示不同步问题的分析和解决</h1><p>2016-12-05 16:33:38</p>
<p>在angular1项目中，有的时候我们需要写<code>自定义directive</code>来完成某些应用逻辑，但是如果你有过一些的angular1项目的开发经验，肯定会因为一些莫名其妙数据双向绑定，回调函数无法调用执行等问题，困扰过。下面是一个简单的案例。</p>
<h3 id="问题引出"><a href="#问题引出" class="headerlink" title="问题引出"></a>问题引出</h3><p>这里我们写一个简单的<code>directive</code>来说明问题。</p>
<p>directive.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">angular.module(&apos;app.directive&apos;)</span><br><span class="line">.directive(&apos;ayTest&apos;,function()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EA&apos;,</span><br><span class="line">        scope: &#123;</span><br><span class="line">            name:&apos;=&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        template:`</span><br><span class="line">            &lt;div class=&quot;padding mystyle&quot;&gt;</span><br><span class="line">                &#123;&#123;vm.name&#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        `,</span><br><span class="line">        controller:function($scope)&#123;</span><br><span class="line">            var vm = $scope.vm = &#123;&#125;;</span><br><span class="line">            vm.name = $scope.name;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>A.controller.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = $scope.vm = &#123;&#125;;</span><br><span class="line">   vm.name = <span class="string">'Tom1'</span>;</span><br><span class="line">   $timeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       vm.name = <span class="string">'Tom2'</span>;</span><br><span class="line">   &#125;,<span class="number">1000</span>);</span><br><span class="line">   $timeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       vm.name = <span class="string">'Tom3'</span>;</span><br><span class="line">   &#125;,<span class="number">2000</span>);</span><br></pre></td></tr></table></figure>
<p>A.html</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;ay-test name=&quot;vm.name&quot;&gt;&lt;/ay-test&gt;</span><br></pre></td></tr></table></figure>
<p>这个directive可以实现以我们自己的格式展示‘name’的功能，我们可以通过在template中填写自己独有的style或者嵌套div来完善name展示模块。</p>
<p>在这我们希望<code>name</code>能够实现双向绑定，即当在A页面中<code>name</code>值发生变化的时候，directive也自动获得更改。</p>
<p>但是，在这里并不能实现这个功能，当<code>name</code>显示为<code>Tom1</code>之后，就不会再变化了。</p>
<p>###为什么会这样呢？</p>
<p>我们都知道自定义directive时，有3个绑定符号，分别是</p>
<ul>
<li><code>@</code> 单向绑定属性值</li>
<li><code>=</code> 双向绑定属性</li>
<li><code>&amp;</code> 绑定用户函数</li>
</ul>
<p>这里为了实现信息的双向绑定，已经使用了<code>=</code>，为什么还无法完成双向绑定呢？对于大神们，当然能一眼看出问题的所在，但小白可能会摸索比较长的时间~~~~</p>
<p><em>问题出在<code>vm.name = $scope.name;</code>这句代码上</em>。因为name是一个基本字符串，赋值时，相当于对vm.name创建了一个新值，并赋值为<code>$scope.name</code>的值。这样，虽然controller中的<code>$scope.name</code>和页面上的<code></code>仍存在双向绑定，但是和我们的<code>vm.name</code>却无任何关系了。</p>
<p>我们应该还知道下面的这个问题：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//controller.js</span><br><span class="line">$socpe.username = &apos;Mary&apos;;</span><br><span class="line">//B.html</span><br><span class="line">&lt;input ng-model=&apos;username&apos; /&gt;</span><br></pre></td></tr></table></figure>
<p>如果你按照上面的方式来编码，十有八九会出现意外情况。</p>
<p>出现这样错误的根本原因，其实还是对JavaScript变量的值访问、引用访问，开发中的值传递、引用传递没有理解清楚。下面说一些这方面的问题。</p>
<h3 id="Js基本类型、值传递"><a href="#Js基本类型、值传递" class="headerlink" title="Js基本类型、值传递"></a>Js基本类型、值传递</h3><p>下面是笔者摘自《JavaScript高级程序设计》中的几段话，读者可以参照理解。这里并不是笔者自己懒，而书中的表达更准确，而且也很容易理解~~(如果你说不知道这本书，推荐快去读一下，如果你做Js相关开发，会让你受益匪浅，我能给你电子版，联系<code>hao5743@163.com</code> )</p>
<blockquote>
<p>5种基本数据类型：Undefined、Null、Boolean、Number和String，<strong>5种基本数据类型是按值访问</strong>的，因为可以操作保存在变量中的实际的值。</p>
<p>引用类型的值是保存在内存中的对象。于其他语言不同，JavaScript不允许直接访问内存中的位置，也就是说不能直接操作对象的内存空间。在操作对象时，实际上是在操作对象的引用而不是实际的对象。<strong>引用类型的值是按引用访问</strong>的。</p>
<p>–<em>参见《JavaScript高级程序设计》P69 4.1 基本类型和引用类型的值</em></p>
<p>如果从一个变量向另一个变量复制基本类型的值，会在变量对象上创建一个新值，然后把该值复制到为新变量分配的位置上。</p>
<p>–<em>参见《JavaScript高级程序设计》P69 4.1.2 复制变量值</em></p>
<p><strong>ECMAScript中所有函数的参数都是按值传递的</strong>。也就是说，把函数外部的值赋值给函数内部的参数，就和把值从一个变量复制到另一个变量一样。基本类型值的传递如同基本类型变量的复制一样，二引用类型值的传递，则如同引用类型变量的复制一样。有不少开发人员在这一点可能会感到困惑，因为访问变量有按值和按引用两种方式，而参数只能按值传递。</p>
<p>–<em>参见《JavaScript高级程序设计》P70 4.1.3 传递参数</em></p>
</blockquote>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>理解了上面的话，那么你就能轻易用不同的方案解决这个问题了。</p>
<h4 id="方案1-直接使用-scope-name展示数据"><a href="#方案1-直接使用-scope-name展示数据" class="headerlink" title="方案1 直接使用$scope.name展示数据"></a>方案1 直接使用<code>$scope.name</code>展示数据</h4><p>directive.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">angular.module(&apos;app.directive&apos;)</span><br><span class="line">.directive(&apos;ayTest&apos;,function()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EA&apos;,</span><br><span class="line">        scope: &#123;</span><br><span class="line">            name:&apos;=&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        //这里直接使用name，不再使用vm.name</span><br><span class="line">        template:`</span><br><span class="line">            &lt;div class=&quot;padding mystyle&quot;&gt;</span><br><span class="line">                &#123;&#123;name&#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        `,</span><br><span class="line">        controller:function($scope)&#123;</span><br><span class="line">            var vm = $scope.vm = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>不再使用vm的方式，而是直接绑定到页面，可以解决问题。</p>
<h4 id="方案2-使用引用类型打包基本类型再传递"><a href="#方案2-使用引用类型打包基本类型再传递" class="headerlink" title="方案2 使用引用类型打包基本类型再传递"></a>方案2 使用引用类型打包基本类型再传递</h4><p>如果，你在angular1开发中，一直遵循了好的实践，那么有可能<code>vm.name</code>你可能已经使用习惯了。也许你会问，如果我还想使用<code>vm.name</code>的方式，我想遵循官方给出的最佳实践，怎么解决这个问题呢？</p>
<blockquote>
<p>（什么是最佳实践？如果你是angular开发者，而还不知道的话，那么一定要去读读，原版<a href="https://github.com/johnpapa/angular-styleguide/blob/master/a1/README.md" target="_blank" rel="noopener">在这里</a>，英文差的<a href="http://www.tuicool.com/articles/JbuErq" target="_blank" rel="noopener">看这里</a>）</p>
</blockquote>
<p>当然有方法啦！看下面<br>controller.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var vm = $scope.vm = &#123;&#125;;</span><br><span class="line">vm.name = &#123;&#125;;</span><br><span class="line">//将数据封装到到内部属性data上</span><br><span class="line">vm.name.data = &apos;Tom1&apos;;</span><br><span class="line">$timeout(function()&#123;</span><br><span class="line">    vm.name.data = &apos;Tom2&apos;;</span><br><span class="line">&#125;,1000);</span><br><span class="line">$timeout(function()&#123;</span><br><span class="line">    vm.name.data = &apos;Tom3&apos;;</span><br><span class="line">&#125;,2000);</span><br></pre></td></tr></table></figure>
<p>A.html</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;ay-test name=&quot;vm.name&quot;&gt;&lt;/ay-test&gt;</span><br></pre></td></tr></table></figure>
<p>directive.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.directive(&apos;ayTest&apos;,function()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EA&apos;,</span><br><span class="line">        scope: &#123;</span><br><span class="line">            name:&apos;=&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        template:`</span><br><span class="line">            &lt;div class=&quot;padding&quot;&gt;</span><br><span class="line">                &#123;&#123;vm.name.data&#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        `,</span><br><span class="line">        controller:function($scope)&#123;</span><br><span class="line">            var vm = $scope.vm = &#123;&#125;;</span><br><span class="line">            //注意，虽然这里重新赋值了name,但是我们的vm.name.data还是同一份，所以仍能实现绑定</span><br><span class="line">            vm.name = $scope.name;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="方案3-使用-scope-watch"><a href="#方案3-使用-scope-watch" class="headerlink" title="方案3 使用$scope.$watch"></a>方案3 使用<code>$scope.$watch</code></h4><p>如果你知道<code>$scope.$watch</code>，并且了解何时使用它，那么你应该知道这里也可能使用它来解决。看代码。</p>
<p>controller.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var vm = $scope.vm = &#123;&#125;;</span><br><span class="line">//并没有进行数据封装</span><br><span class="line">vm.name = &apos;Tom1&apos;;</span><br><span class="line">$timeout(function()&#123;</span><br><span class="line">    vm.name = &apos;Tom2&apos;;</span><br><span class="line">&#125;,1000);</span><br><span class="line">$timeout(function()&#123;</span><br><span class="line">    vm.name = &apos;Tom3&apos;;</span><br><span class="line">&#125;,2000);</span><br></pre></td></tr></table></figure>
<p>A.html</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;ay-test name=&quot;vm.name&quot;&gt;&lt;/ay-test&gt;</span><br></pre></td></tr></table></figure>
<p>directive.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">angular.module(&apos;app.directive&apos;)</span><br><span class="line">.directive(&apos;ayTest&apos;,function()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EA&apos;,</span><br><span class="line">        scope: &#123;</span><br><span class="line">            name:&apos;=&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        template:`</span><br><span class="line">            &lt;div class=&quot;padding&quot;&gt;</span><br><span class="line">                &#123;&#123;vm.name&#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        `,</span><br><span class="line">        controller:function($scope)&#123;</span><br><span class="line">            var vm = $scope.vm = &#123;&#125;;</span><br><span class="line">            //添加数据监测</span><br><span class="line">            $scope.$watch(&apos;name&apos;,function(newValue,oldValue)&#123;</span><br><span class="line">                vm.name = $scope.name;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这个方法其实相当于多加了一层的监测，<code>vm.name</code>和页面上的<code></code>绑定，通过<code>$scope.$watch</code>，我们让<code>vm.name</code>和<code>$scope.name</code>两个变量的值保持一致性。</p>
<h4 id="哪个方法好呢"><a href="#哪个方法好呢" class="headerlink" title="哪个方法好呢"></a>哪个方法好呢</h4><p>个人推荐第一种方法，因为他所做的工作最少，效率相对较高（虽然高不了很多）。</p>
<h3 id="最后的话"><a href="#最后的话" class="headerlink" title="最后的话"></a>最后的话</h3><p>本文首先提出了在编写自定义directive时有时候会出现的数据无法同步的问题。随后分析了问题，并给出了几种解决方案。</p>
<p>其实，问题的根本首先在于对JavaScript变量<code>值访问</code>、<code>引用访问</code>和<code>值传递</code>等概念的理解，其次在于对angular1<code>scope层级</code>、<code>双向绑定</code>、<code>脏值检测</code>等概念的理解。</p>
<p>有时，还能需要处理其他情况，比如默认值处理，分条件展示，错误值处理、数据回显、回调函数处理等具体问题，可以参考上面3种思路来具体实现。</p>
<p>很简单一个问题，个人只是做了一下分析，有错误的地方请大神及时指出，感激不尽~~</p>
<blockquote>
<p>Author：shaochong</p>
<p>Email：hao5743@163.com</p>
<p>文章地址：<a href="https://hao5743.github.io/2016/12/05/Data-bind-problem-in-Angular-when-define-your-own-directives/" target="_blank" rel="noopener">https://hao5743.github.io/2016/12/05/Data-bind-problem-in-Angular-when-define-your-own-directives/</a></p>
<p>博客：<a href="http://hao5743.github.io/" target="_blank" rel="noopener">http://hao5743.github.io/</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/03/Handling-CORS-issues-in Ionic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ethan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一阴一阳谓之道">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/03/Handling-CORS-issues-in Ionic/" itemprop="url">彻底解决Ionic项目中的跨域问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-03T18:38:17+08:00">
                2016-12-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ionic/" itemprop="url" rel="index">
                    <span itemprop="name">ionic</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在<code>ionic</code>项目中，如果你使用<code>ionic serve</code>或者<code>ionic run</code>,并且开启了动态加载（live reload），且访问了远端服务器的API，那么你就可能会遇到 <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank" rel="noopener">跨域资源共享(CORS)</a> 问题。出现类似下面的错误提示：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">XMLHttpRequest cannot load http://api.ionic.com/endpoint.</span><br><span class="line">No &apos;Access-Control-Allow-Origin&apos; header is present on the requested resource.</span><br><span class="line">Origin &apos;http://localhost:8100&apos; is therefore not allowed access.</span><br></pre></td></tr></table></figure></p>
<p>那么，什么是CORS？ 为什么在这里会发生这个错误呢？</p>
<h2 id="什么是CORS？"><a href="#什么是CORS？" class="headerlink" title="什么是CORS？"></a>什么是CORS？</h2><p>CORS = Cross origin resource sharing <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">跨域资源共享</a><br><code>origin</code>是你当前所在页面的主机地址。<br>如果你在浏览<code>http://ionicframework.com/blog/handling-cors-issues-in-ionic</code>页面，它的<code>origin</code>就是<code>ionicframework.com</code>。在此页面上，如果你要向<code>http://cors.api.com/api</code>发送一个<a href="https://developer.mozilla.org/zh-CN/docs/AJAX/Getting_Started" target="_blank" rel="noopener">AJAX</a>请求,您的主机源将由Origin标头指定，该标头会自动包含在浏览器的CORS请求中。因为<code>ionicframework.com</code>和主机<code>api.com</code>并不匹配，我们从<code>ionicframework.com</code>的请求必须要经过服务器的批准，才能够访问该资源，以Http Options请求头的形式。</p>
<p>如果我们遇到了上面的错误，说明服务器没有给我们的地址<code>ionicframework.com</code>赋予访问该资源的权限。</p>
<p>下面来看一下，当通过<code>ionic serve</code>,<code>ionic run</code>,<code>ionic run -l</code>三种不同方式运行app时，你的<code>origin</code>分别是什么？</p>
<h3 id="在浏览器中运行时"><a href="#在浏览器中运行时" class="headerlink" title="在浏览器中运行时"></a>在浏览器中运行时</h3><p>在执行<code>ionic serve</code>时，发生了什么？</p>
<ul>
<li>启动了一个本地web服务器</li>
<li>你的浏览器自动打开了指向本地服务器地址的一个页面</li>
</ul>
<p>这时你可以看到你的app加载到了你的浏览器上，地址是<code>http://localhost:8100</code>(如果你选择了localhost)。</p>
<p>这时，你的<code>origin</code>是<code>localhost:8100</code>。</p>
<p>任何发送到主机而不是<code>localhost:8100</code>的AJAX请求，都将以<code>localhost:8100</code>作为其<code>origin</code>，因此需要经过CORS预检请求，来查看是否有权限访问该资源。</p>
<h3 id="在设备上运行时"><a href="#在设备上运行时" class="headerlink" title="在设备上运行时"></a>在设备上运行时</h3><p>当执行<code>ionic run</code>时，又发生了些什么呢？</p>
<ul>
<li>应用程序文件被复制到设备（或模拟器）。</li>
<li>app开始运行，然后启动一个设备（或模拟器）上的浏览器来打开这些文件，类似<code>file://some/path/www/index.html</code></li>
</ul>
<p>这样，你的<code>origin</code>将不存在了，因为你正在运行于一个文件（<code>file://</code>）URI。理所当然，你的任何向外请求将不需要通过CORS预检。</p>
<h3 id="在设备上通过自动加载（livereload）运行时"><a href="#在设备上通过自动加载（livereload）运行时" class="headerlink" title="在设备上通过自动加载（livereload）运行时"></a>在设备上通过自动加载（livereload）运行时</h3><p>执行<code>ionic run -l</code>时，又将发生什么呢？</p>
<ul>
<li>首先启动一个本地web服务器</li>
<li>设备（或模拟器）上app开始运行，启动一个浏览器来开地址<code>http://192.168.1.1:8100</code>（你的本地IP地址）上的文件。</li>
</ul>
<p>这时，你的<code>origin</code>是<code>192.168.1.1:8100</code>。</p>
<p>任何发送到主机而不是<code>192.168.1.1:8100</code>的AJAX请求，都将以<code>192.168.1.1:8100</code>作为其<code>origin</code>，因此需要经过CORS预检请求，来查看是否有权限访问该资源。</p>
<h2 id="在Ionic中处理CORS问题"><a href="#在Ionic中处理CORS问题" class="headerlink" title="在Ionic中处理CORS问题"></a>在Ionic中处理CORS问题</h2><p>CORS问题仅仅发生在，当我们以<code>ionic serve</code>或<code>ionic run -l</code>来运行或测试app的时候。</p>
<p>有2种方法来解决这个问题.</p>
<p>第一种，比较容易的方法，是设置远端服务器，让它可以接受所有源的请求。第二种，有时候我们没有权限去修改远端服务器，此时就需要一个不指定源的请求。</p>
<p>我们可以使用代理服务器来实现这个方案。<code>ionic cli</code>给我们提供了一个很方便的配置代理服务器的方法，下面我们看一下如何来实现。</p>
<h2 id="Ionic-CLI代理服务器"><a href="#Ionic-CLI代理服务器" class="headerlink" title="Ionic CLI代理服务器"></a>Ionic CLI代理服务器</h2><p>下面是关于代理（proxy）的一个定义：</p>
<blockquote>
<p>In computer networks, a proxy server is a server (a computer system or an application) that acts as an intermediary for requests from clients seeking resources from other servers.</p>
<p>在计算机网络中，代理服务器是一个客户端请求的中介服务器（计算机系统或应用），它用于帮助客户端寻找位于其他服务器上的资源。</p>
</blockquote>
<p>要解决我们在ionic中遇到的CORS问题，我们需要设置一个代理服务器，它接受我们的请求，并向API端点发出新的请求，然后接受响应，并将其转发回我们的应用程序。</p>
<p>由于代理服务器需要向目标发送新的请求，因此请求中将不会有<code>origin</code>(源)，也就不再需要CORS了。 需要非常注意一点是，<strong><code>origin</code>是浏览器自动帮我们添加在请求头中的</strong>。</p>
<p>Ionic CLI具有为客户端请求设置代理服务器的能力，用来帮助您解决CORS问题，下面来看一下Ionic CLI设置代理的方法。</p>
<h2 id="设置代理服务器"><a href="#设置代理服务器" class="headerlink" title="设置代理服务器"></a>设置代理服务器</h2><p>再次说明一下，仅仅在<code>ionic serve</code>或<code>ionic run -l</code>的时候需要设置代理。</p>
<p>首先，我们需要在<code>ionic.project</code>（注意，ionic2 cli新版本已经将此文件重命名为<code>ionic.config.json</code>）配置文件中设置代理。 这将告诉Ionic本地服务器监听这些路径并将这些请求转发到目标网址。</p>
<p>在app中，我们需要替换包含endpoint的URLS，并设置为我们的代理服务器地址。（In our app, we will need to replace our endpoint URLS to be set to the proxy server address for when we are running serve or run -l.）</p>
<blockquote>
<p>什么是<code>endpoint</code>？</p>
<p>在项目中 endpoint有时也写作baseUrl，比如这个<code>http://cors.api.com/api/book/2/detail</code>的endpoint是<code>http://cors.api.com/api</code>，再比如<code>http://localhost:8101/api/user/123</code>的endpoint是<code>http://localhost:8101/api</code>。</p>
<p>笔者没有想到好的中文来替代这个英文单词，所以没有进行翻译，希望小伙伴们能够理解它的意思就好啦<del>~</del></p>
</blockquote>
<p>我们可以通过设置一些<em>gulp任务</em>，用gulp中的替换模块(replace)来替换出这些URLS，来简化这一步骤。</p>
<p>比较推荐的方法是设置一个Angular Constant来同一设置的endpoint，方便统一进行修改和维护。</p>
<p>下面是操作步骤。我们需要设置一个Angular Service ApiEndpoint来获取数据。</p>
<h2 id="配置代理地址"><a href="#配置代理地址" class="headerlink" title="配置代理地址"></a>配置代理地址</h2><p>配置代理有两个需要注意的地方。</p>
<ul>
<li><code>path</code>：你在本地Ionic服务器上访问它们的路径</li>
<li><code>proxyUrl</code>：你最终希望通过API调用达到的proxyUrl</li>
</ul>
<p>修改<code>ionic.config.json</code>(旧版本Ionic CLI是<code>ionic.project</code>)：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;proxy-example&quot;,</span><br><span class="line">  &quot;app_id&quot;: &quot;&quot;,</span><br><span class="line">  &quot;proxies&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;path&quot;: &quot;/api&quot;, </span><br><span class="line">      &quot;proxyUrl&quot;: &quot;http://cors.api.com/api&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上所述，当您请求访问<code>http://localhost:8100/api</code>的ionic服务器时，它会替你代理请求到<code>http://cors.api.com/api</code>上。这样，就不需要CORS了。</p>
<h2 id="设置Angular-Constant"><a href="#设置Angular-Constant" class="headerlink" title="设置Angular Constant"></a>设置Angular Constant</h2><p>很容易将你的ApiEndpoint设置为Angular Constant。下面，我们已经将ApiEndpoint指定为我们的代理url。然后，我们就可以使用这个url作为一个常数。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">angular.module(&apos;starter&apos;, [&apos;ionic&apos;, &apos;starter.controllers&apos;, &apos;starter.services&apos;])</span><br><span class="line">.constant(&apos;ApiEndpoint&apos;, &#123;</span><br><span class="line">  url: &apos;http://localhost:8100/api&apos;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//For the real endpoint, we&apos;d use this</span><br><span class="line">// constant(&apos;ApiEndpoint&apos;, &#123;</span><br><span class="line">//  url: &apos;http://cors.api.com/api&apos;</span><br><span class="line">// &#125;)</span><br></pre></td></tr></table></figure>
<h2 id="设置Angular-Service"><a href="#设置Angular-Service" class="headerlink" title="设置Angular Service"></a>设置Angular Service</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">angular.module(&apos;starter.services&apos;, [])</span><br><span class="line"></span><br><span class="line">//NOTE: We are including the constant `ApiEndpoint` to be used here.</span><br><span class="line">.factory(&apos;Api&apos;, function($http, ApiEndpoint) &#123;</span><br><span class="line">  console.log(&apos;ApiEndpoint&apos;, ApiEndpoint)</span><br><span class="line"></span><br><span class="line">  var getApiData = function() &#123;</span><br><span class="line">    return $http.get(ApiEndpoint.url + &apos;/tasks&apos;)</span><br><span class="line">      .then(function(data) &#123;</span><br><span class="line">        console.log(&apos;Got some data: &apos;, data);</span><br><span class="line">        return data;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return &#123;</span><br><span class="line">    getApiData: getApiData</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="使用Gulp实现URL自动切换"><a href="#使用Gulp实现URL自动切换" class="headerlink" title="使用Gulp实现URL自动切换"></a>使用Gulp实现URL自动切换</h2><p>首先，需要安装<code>replace module</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save replace</span><br></pre></td></tr></table></figure>
<p>然后，我们需要修改<code>gulpfile.js</code>，并添加2个任务，来添加代理地址、移出代理地址。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// `npm install --save replace`</span><br><span class="line">var replace = require(&apos;replace&apos;);</span><br><span class="line">//注意下面的文件地址，它是包含你endpoint或baseurl的文件</span><br><span class="line">var replaceFiles = [&apos;./www/js/app.js&apos;];</span><br><span class="line"></span><br><span class="line">gulp.task(&apos;add-proxy&apos;, function() &#123;</span><br><span class="line">  return replace(&#123;</span><br><span class="line">    regex: &quot;http://cors.api.com/api&quot;,</span><br><span class="line">    replacement: &quot;http://localhost:8100/api&quot;,</span><br><span class="line">    paths: replaceFiles,</span><br><span class="line">    recursive: false,</span><br><span class="line">    silent: false,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&apos;remove-proxy&apos;, function() &#123;</span><br><span class="line">  return replace(&#123;</span><br><span class="line">    regex: &quot;http://localhost:8100/api&quot;,</span><br><span class="line">    replacement: &quot;http://cors.api.com/api&quot;,</span><br><span class="line">    paths: replaceFiles,</span><br><span class="line">    recursive: false,</span><br><span class="line">    silent: false,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>这个教程展示给你了在运行<code>ionic serve</code>或<code>ionic run -l</code>的时候，一个处理CORS问题的方法。</p>
<p>我们知道，如果按这个方法处理，当我们需要在<code>ionic serve</code>和<code>ionic run -l</code>切换的时候，将ApiEndpoint替换出来可能会比较麻烦。因此我们推荐使用gulp在程序启动时自动完成这个过程。</p>
<p>其实，最简单的处理CORS问题的方法，是要求你的api提供服务器来允许所有的<code>origin</code>。但是，有时候我们无法这么做。</p>
<p>使用Angular Constant和replace module会给我们一个愉快的解决方法来处理CORS问题。</p>
<p>如果你需要一个具体的例子，可以看一下这个<a href="https://github.com/driftyco/ionic-proxy-example" target="_blank" rel="noopener">示例工程</a>。</p>
<p>上面说的就是所有的当你访问一个API服务器时，关于处理CORS问题的全部。</p>
<p>如果你有疑问或想法，请在下面给我们评论，或者通过<a href="https://twitter.com/ionicframework" target="_blank" rel="noopener">twitter</a> or <a href="https://github.com/driftyco/ionic-cli" target="_blank" rel="noopener">github</a>.</p>
<hr>
<blockquote>
<p>文章翻译自：<a href="http://blog.ionic.io/handling-cors-issues-in-ionic/" target="_blank" rel="noopener">Handling CORS issues in Ionic，By Josh on February 24, 2015</a></p>
<p>译者：shaochong</p>
<p>说明：如果有翻译的不合适的地方，您可以联系（hao5743@163.com）我修改~</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/tx.jpeg"
                alt="Ethan" />
            
              <p class="site-author-name" itemprop="name">Ethan</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">34</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ethan</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
